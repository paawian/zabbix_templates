# Template: Linux by Zabbix agent

## Overview
This is an official Linux template. It requires Zabbix agent 7.0 or newer.

Notes on filesystem (FS) discovery:
- The ext4/3/2 filesystem reserves space for privileged usage, typically set at 5% by default.
- BTRFS allocates a default of 10% of the volume for its own needs.
- To mitigate potential disasters, FS usage triggers are based on the maximum available space.
  - Utilization formula: 'pused = 100 - 100 * (available / total - free + available)'
- The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux

Generated by official Zabbix template tool "Templator"

## Macros Used
| Name | Description | Default Value |
|------|-------------|---------------|
| {$AGENT.TIMEOUT} | Description here. | 3m |
| {$CPU.UTIL.CRIT} | Description here. | 90 |
| {$IF.ERRORS.WARN} | Description here. | 2 |
| {$IFCONTROL} | Description here. | 1 |
| {$KERNEL.MAXFILES.MIN} | Description here. | 256 |
| {$KERNEL.MAXPROC.MIN} | Description here. | 1024 |
| {$LOAD_AVG_PER_CPU.MAX.WARN} | Description here. | 1.5 |
| {$MEMORY.AVAILABLE.MIN} | Description here. | 20M |
| {$MEMORY.UTIL.MAX} | Description here. | 90 |
| {$NET.IF.IFNAME.MATCHES} | Description here. | ^.*$ |
| {$NET.IF.IFNAME.NOT_MATCHES} | Description here. | (^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9A-z]+$|docker[0-9]+|br-[a-z0-9]{12}) |
| {$SWAP.PFREE.MIN.WARN} | Description here. | 50 |
| {$SYSTEM.FUZZYTIME.MAX} | Description here. | 60 |
| {$VFS.DEV.DEVNAME.MATCHES} | Description here. | .+ |
| {$VFS.DEV.DEVNAME.NOT_MATCHES} | Description here. | ^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*) |
| {$VFS.DEV.READ.AWAIT.WARN} | Description here. | 20 |
| {$VFS.DEV.WRITE.AWAIT.WARN} | Description here. | 20 |
| {$VFS.FS.FSNAME.MATCHES} | Description here. | .+ |
| {$VFS.FS.FSNAME.NOT_MATCHES} | Description here. | ^(/dev|/sys|/run|/proc|.+/shm$) |
| {$VFS.FS.FSTYPE.MATCHES} | Description here. | ^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs)$ |
| {$VFS.FS.FSTYPE.NOT_MATCHES} | Description here. | ^\s$ |
| {$VFS.FS.INODE.PFREE.MIN.CRIT} | Description here. | 10 |
| {$VFS.FS.INODE.PFREE.MIN.WARN} | Description here. | 20 |
| {$VFS.FS.PUSED.MAX.CRIT} | Description here. | 90 |
| {$VFS.FS.PUSED.MAX.WARN} | Description here. | 80 |
| {$IF.UTIL.MAX} | Description here. | 90 |

## Template Links
No linked templates.

## Items
| Name | Description | Data Type | Key | Tags |
|------|-------------|-----------|-----|------|
| CPU guest time | Time spent on running a virtual CPU for a guest operating system. | 0 | system.cpu.util[,guest] |  |
| Free swap space in % | The free space of the swap volume/file expressed in %. | 0 | system.swap.size[,pfree] |  |
| Host name of Zabbix agent running |  | 0 | agent.hostname |  |
| Free swap space | The free space of the swap volume/file expressed in bytes. | 0 | system.swap.size[,free] |  |
| CPU system time | Time the CPU has spent running the kernel and its processes. | 0 | system.cpu.util[,system] |  |
| CPU user time | Time the CPU has spent running users' processes that are not niced. | 0 | system.cpu.util[,user] |  |
| System name | The host name of the system. | 0 | system.hostname |  |
| System local time | The local system time of the host. | 0 | system.localtime |  |
| Operating system architecture | The architecture of the operating system. | 0 | system.sw.arch |  |
| Operating system |  | 0 | system.sw.os |  |
| Number of installed packages |  | 0 | system.sw.packages.get |  |
| Zabbix agent ping | The agent always returns "1" for this item. May be used in combination with `nodata()` for the availability check. | 0 | agent.ping |  |
| Total swap space | The total space of the swap volume/file expressed in bytes. | 0 | system.swap.size[,total] |  |
| System description | The information as normally returned by `uname -a`. | 0 | system.uname |  |
| System uptime | The system uptime expressed in the following format: "N days, hh:mm:ss". | 0 | system.uptime |  |
| Number of logged in users | The number of users who are currently logged in. | 0 | system.users.num |  |
| Checksum of /etc/passwd |  | 0 | vfs.file.cksum[/etc/passwd,sha256] |  |
| Available memory | The available memory:
- in Linux = free + buffers + cache;
- on other platforms calculation may vary.

See also Appendixes in Zabbix Documentation about parameters of the `vm.memory.size` item. | 0 | vm.memory.size[available] |  |
| Available memory in % | The available memory as percentage of the total. See also Appendixes in Zabbix Documentation about parameters of the `vm.memory.size` item. | 0 | vm.memory.size[pavailable] |  |
| Total memory | Total memory expressed in bytes. | 0 | vm.memory.size[total] |  |
| CPU steal time | The amount of "stolen" CPU from this virtual machine by the hypervisor for other tasks, such as running another virtual machine. | 0 | system.cpu.util[,steal] |  |
| CPU softirq time | Time the CPU has been servicing software interrupts. | 0 | system.cpu.util[,softirq] |  |
| CPU nice time | Time the CPU has spent running users' processes that have been niced. | 0 | system.cpu.util[,nice] |  |
| Load average (1m avg) | Calculated as the system CPU load divided by the number of CPU cores. | 0 | system.cpu.load[all,avg1] |  |
| Version of Zabbix agent running |  | 0 | agent.version |  |
| Maximum number of open file descriptors | May be increased by using the `sysctl` utility or modifying the file `/etc/sysctl.conf`. | 0 | kernel.maxfiles |  |
| Maximum number of processes | May be increased by using the `sysctl` utility or modifying the file `/etc/sysctl.conf`. | 0 | kernel.maxproc |  |
| Number of processes |  | 0 | proc.num |  |
| Number of running processes |  | 0 | proc.num[,,run] |  |
| System boot time |  | 0 | system.boottime |  |
| Interrupts per second | Number of interrupts processed. | 0 | system.cpu.intr |  |
| Load average (5m avg) | Calculated as the system CPU load divided by the number of CPU cores. | 0 | system.cpu.load[all,avg5] |  |
| CPU iowait time | Time the CPU has been waiting for I/O to complete. | 0 | system.cpu.util[,iowait] |  |
| Load average (15m avg) | Calculated as the system CPU load divided by the number of CPU cores. | 0 | system.cpu.load[all,avg15] |  |
| Number of CPUs |  | 0 | system.cpu.num |  |
| Context switches per second | The combined rate at which all processors on the computer are switched from one thread to another. | 0 | system.cpu.switches |  |
| CPU guest nice time | Time spent on running a niced guest (a virtual CPU for guest operating systems under the control of the Linux kernel). | 0 | system.cpu.util[,guest_nice] |  |
| CPU idle time | Time the CPU has spent doing nothing. | 0 | system.cpu.util[,idle] |  |
| CPU interrupt time | Time the CPU has spent servicing hardware interrupts. | 0 | system.cpu.util[,interrupt] |  |
| Zabbix agent availability | Used for monitoring the availability status of the agent. | 5 | zabbix[host,agent,available] |  |
| Get filesystems | The `vfs.fs.get` key acquires raw information set about the filesystems. Later to be extracted by preprocessing in dependent items. | 0 | vfs.fs.get |  |
| CPU utilization | CPU utilization expressed in %. | 18 | system.cpu.util |  |
| Memory utilization | The percentage of used memory is calculated as `100-pavailable`. | 18 | vm.memory.utilization |  |

## Triggers
| Name | Description | Expression | Severity | Dependencies | Tags |
|------|-------------|------------|----------|--------------|------|
| Configured max number of open filedescriptors is too low | {30580}<{$KERNEL.MAXFILES.MIN} | 1 |  |  |
| Configured max number of processes is too low | {30581}<{$KERNEL.MAXPROC.MIN} | 1 |  |  |
| High CPU utilization | {30582}>{$CPU.UTIL.CRIT} | 2 |  |  |
| System name has changed | {32779} and length({32780})>0 | 1 |  |  |
| System time is out of sync | {30586}=0 | 2 |  |  |
| Operating system description has changed | {32781} and length({32782})>0 | 1 |  |  |
| {HOST.NAME} has been restarted | {30590}<10m | 2 |  |  |
| /etc/passwd has been changed | {30591}<>{30592} | 1 |  |  |
| High memory utilization | {30593}>{$MEMORY.UTIL.MAX} | 3 |  |  |
| Zabbix agent is not available | {30594}=0 | 3 |  |  |
| Getting closer to process limit | {30595}/{30596}*100>80 | 2 |  |  |
| High swap space usage | {30947}<{$SWAP.PFREE.MIN.WARN} and {30948}>0 | 2 |  |  |
| Lack of available memory | {30951}<{$MEMORY.AVAILABLE.MIN} and {30952}>0 | 3 |  |  |
| Load average is too high | {30601}/{30602}>{$LOAD_AVG_PER_CPU.MAX.WARN}
and {30603}>0
and {30604}>0 | 3 |  |  |
| Number of installed packages has been changed | {32787}<>0 | 2 |  |  |

## Discovery Rules
| Description | Type |
|-------------|------|
| The discovery of network interfaces. | 0 |

### Item Prototypes
| Name | Key | Description |
|------|-----|-------------|

### Trigger Prototypes
| Name | Expression | Severity |
|------|------------|----------|

### Host Prototypes
| Host Name |
|-----------|
|  | 0 |

### Item Prototypes
| Name | Key | Description |
|------|-----|-------------|

### Trigger Prototypes
| Name | Expression | Severity |
|------|------------|----------|

### Host Prototypes
| Host Name |
|-----------|
| The discovery of mounted filesystems with different types. | 18 |

### Item Prototypes
| Name | Key | Description |
|------|-----|-------------|

### Trigger Prototypes
| Name | Expression | Severity |
|------|------------|----------|

### Host Prototypes
| Host Name |
|-----------|
