# Oracle Cloud Compute by HTTP template description

This template monitors Oracle Cloud Infrastructure (OCI) single compute instance resources and discovers attached
virtual network interface cards (VNICs) and monitors their resources.

This template is not meant to be used independently, but together with Oracle Cloud by HTTP as a template for
LLD host prototypes.

Read the template documentation prior to using this template.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery VNIC discovery ](#discovery_vnic_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Get instance availability | The accessibility status of a virtual machine instance. A value of "1" indicates that the instance is unresponsive due to an issue with the infrastructure or the instance itself. A value of "0" indicates that an accessibility issue has not been detected. If the instance is stopped, then the metric does not have a value. | oci.compute.availability.get | SCRIPT | 5m |
| CPU utilization, in % | Activity level from the CPU. Expressed as a percentage of the total time. | oci.compute.cpu.util | DEPENDENT | 0 |
| Disk read I/O | Activity level from I/O reads. Expressed as reads per interval. | oci.compute.disk.io.read | DEPENDENT | 0 |
| Disk write I/O | Activity level from I/O writes. Expressed as writes per interval. | oci.compute.disk.io.write | DEPENDENT | 0 |
| Disk bytes read | Read throughput. Expressed as bytes read per interval. | oci.compute.disk.read | DEPENDENT | 0 |
| Disk bytes written | Write throughput. Expressed as bytes written per interval. | oci.compute.disk.written | DEPENDENT | 0 |
| Load average | Average system load calculated over a 1-minute period. Expressed as a number of processes. | oci.compute.load.avg | DEPENDENT | 0 |
| Memory allocation stalls | Number of times page reclaim was called directly. | oci.compute.mem.stalls | DEPENDENT | 0 |
| Memory utilization, in % | Space currently in use, measured in pages. Expressed as a percentage of used pages. | oci.compute.mem.util | DEPENDENT | 0 |
| Get compute metrics | Gets compute instance metrics. | oci.compute.metrics.get | SCRIPT | no delay |
| Network bytes in | Network bytes in for the compute instance. | oci.compute.network.in | DEPENDENT | 0 |
| Network bytes out | Network bytes out for the compute instance. | oci.compute.network.out | DEPENDENT | 0 |
| State | The current state of the instance. | oci.compute.state.get | SCRIPT | no delay |
| Get VNICs | Gets information about all virtual network interface cards attached to the instance. | oci.compute.vnic.get | SCRIPT | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$OCI.COMPUTE.CPU.UTIL.HIGH} | 90 |
| {$OCI.COMPUTE.CPU.UTIL.WARN} | 75 |
| {$OCI.COMPUTE.MEM.UTIL.HIGH} | 90 |
| {$OCI.COMPUTE.MEM.UTIL.WARN} | 75 |
| {$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.HIGH} | 90 |
| {$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.WARN} | 75 |
| {$OCI.COMPUTE.VNIC.DISCOVERY.NAME.MATCHES} | .* |
| {$OCI.COMPUTE.VNIC.DISCOVERY.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$OCI.COMPUTE.VNIC.DISCOVERY.STATE.MATCHES} | .* |
| {$OCI.COMPUTE.VNIC.DISCOVERY.STATE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$OCI.HTTP.PROXY} | no value |
| {$OCI.HTTP.RETURN.CODE.OK} | 200 |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Compute instance is not available | HIGH | Current instance availability. | last(/Oracle Cloud Compute by HTTP/oci.compute.availability.get) = 1 | [{"tag": "scope", "value": "availability"}] | no url |
| Current CPU utilization is high | WARNING | Current CPU utilization has exceeded `{$OCI.COMPUTE.CPU.UTIL.WARN}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.cpu.util,5m) >= {$OCI.COMPUTE.CPU.UTIL.WARN} | [{"tag": "scope", "value": "capacity"}] | no url |
| Current CPU utilization is too high | HIGH | Current CPU utilization has exceeded `{$OCI.COMPUTE.CPU.UTIL.HIGH}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.cpu.util,5m) >= {$OCI.COMPUTE.CPU.UTIL.HIGH} | [{"tag": "scope", "value": "capacity"}] | no url |
| Current memory utilization is high | WARNING | Current memory utilization has exceeded `{$OCI.COMPUTE.MEM.UTIL.WARN}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.mem.util,5m) >= {$OCI.COMPUTE.MEM.UTIL.WARN} | [{"tag": "scope", "value": "capacity"}] | no url |
| Current memory utilization is too high | HIGH | Current memory utilization has exceeded `{$OCI.COMPUTE.MEM.UTIL.HIGH}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.mem.util,5m) >= {$OCI.COMPUTE.MEM.UTIL.HIGH} | [{"tag": "scope", "value": "capacity"}] | no url |
| State has changed | INFO | Compute instance state has changed. | last(/Oracle Cloud Compute by HTTP/oci.compute.state.get,#1)<>last(/Oracle Cloud Compute by HTTP/oci.compute.state.get,#2) | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| VNIC discovery | oci.compute.vnic.discovery | Discover compute instance VNICs. | DEPENDENT | no lifetime | 0 |


<a name="discovery_vnic_discovery"></a>

## Discovery VNIC discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| VNIC [{#NAME}]: Attachment state | Current attachment state of the VNIC. | oci.compute.vnic.attachment[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Egress packets dropped by security list | Packets sent by the VNIC, destined for the network, dropped due to security rule violations. | oci.compute.vnic.egress.packets.dropped[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Smartnic buffer drops from host | Number of packets dropped in SmartNIC from the host due to buffer exhaustion. This metric is available only for Bare Metal Instances. For virtual machines, these metric values are zero. | oci.compute.vnic.host.smartnic.drops[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Ingress packets dropped by security list | Packets received from the network, destined for the VNIC, dropped due to security rule violations. | oci.compute.vnic.ingress.packets.dropped[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Get metrics | Gets virtual network interface card metrics. | oci.compute.vnic.metrics.get[{#ID}] | SCRIPT |
| VNIC [{#NAME}]: Bytes to network | Bytes sent from the VNIC to the network, before drops. | oci.compute.vnic.net.bytes.egr[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Bytes from network | Bytes received at the VNIC from the network, after drops. | oci.compute.vnic.net.bytes.ingr[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Connection tracking table full | Boolean (0/false, 1/true) that indicates the connection tracking table is full. | oci.compute.vnic.net.conntrack.full[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Connection tracking table utilization, in % | Total utilization percentage (0-100%) of the connection tracking table. | oci.compute.vnic.net.conntrack.util[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Egress packets dropped by full connection tracking table | Packets sent from the VNIC, destined for the network, dropped due to the full connection tracking table. | oci.compute.vnic.net.packets.egr.drop[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Throttled egress packets | Packets sent from the VNIC, destined for the network, dropped due to throttling. | oci.compute.vnic.net.packets.egr.throttled[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Packets to network | Packets sent from the VNIC to the network, before drops. | oci.compute.vnic.net.packets.egr[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Ingress packets dropped by full connection tracking table | Packets received from the network, destined for the VNIC, dropped due to the full connection tracking table. | oci.compute.vnic.net.packets.ingr.drop[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Throttled ingress packets | Packets received from the network, destined for the VNIC, dropped due to throttling. | oci.compute.vnic.net.packets.ingr.throttled[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Packets from network | Packets received at the VNIC from the network, after drops. | oci.compute.vnic.net.packets.ingr[{#ID}] | DEPENDENT |
| VNIC [{#NAME}]: Smartnic buffer drops from network | Number of packets dropped in SmartNIC from the network due to buffer exhaustion. This metric is available only for Bare Metal Instances. For virtual machines, these metric values are zero. | oci.compute.vnic.net.smartnic.drops[{#ID}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| VNIC [{#NAME}]: VNIC is not attached | HIGH | Virtual network interface card attachment status. | min(/Oracle Cloud Compute by HTTP/oci.compute.vnic.attachment[{#ID}],5m) >= 3 | [{"tag": "scope", "value": "availability"}] | no url |
| VNIC [{#NAME}]: Conntrack table full | HIGH | Virtual network interface card connection tracking table is full. | min(/Oracle Cloud Compute by HTTP/oci.compute.vnic.net.conntrack.full[{#ID}],5m) = 1 | [{"tag": "scope", "value": "availability"}] | no url |
| VNIC [{#NAME}]: Current conntrack table utilization is high | WARNING | Current conntrack table utilization has exceeded `{$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.WARN}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.vnic.net.conntrack.util[{#ID}],5m) >= {$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.WARN} | [{"tag": "scope", "value": "capacity"}] | no url |
| VNIC [{#NAME}]: Current conntrack table utilization is too high | HIGH | Current conntrack table utilization has exceeded `{$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.HIGH}`% of the max available value. | min(/Oracle Cloud Compute by HTTP/oci.compute.vnic.net.conntrack.util[{#ID}],5m) >= {$OCI.COMPUTE.VNIC.CONNTRACK.UTIL.HIGH} | [{"tag": "scope", "value": "capacity"}] | no url |

