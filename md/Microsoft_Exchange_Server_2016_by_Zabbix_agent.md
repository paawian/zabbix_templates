# Microsoft Exchange Server 2016 by Zabbix agent template description

The template to monitor Microsoft Exchange Server 2016 by Zabbix that works without any external scripts.
The metrics are collected by Zabbix agent.
Recommended to use it with "OS Windows by Zabbix agent" template.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/415007-discussion-thread-for-official-zabbix-template-microsoft-exchange

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [discoveries](#discoveries)
  * [Discovery Databases discovery ](#discovery_databases_discovery)
  * [Discovery LDAP discovery ](#discovery_ldap_discovery)
  * [Discovery Web services discovery ](#discovery_web_services_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Databases total mounted | Shows the number of active database copies on the server. | perf_counter_en["\MSExchange Active Manager(_total)\Database Mounted"] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| ActiveSync: ping command pending | Shows the number of ping commands currently pending in the queue. | perf_counter_en["\MSExchange ActiveSync\Ping Commands Pending", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| ActiveSync: requests per second | Shows the number of HTTP requests received from the client via ASP.NET per second. Determines the current Exchange ActiveSync request rate. Used only to determine current user load. | perf_counter_en["\MSExchange ActiveSync\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| ActiveSync: sync commands per second | Shows the number of sync commands processed per second. Clients use this command to synchronize items within a folder. | perf_counter_en["\MSExchange ActiveSync\Sync Commands/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| Autodiscover: requests per second | Shows the number of Autodiscover service requests processed each second. Determines current user load. | perf_counter_en["\MSExchangeAutodiscover\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| Availability Service: availability requests per second | Shows the number of requests serviced per second. The request can be only for free/ busy information or include suggestions. One request may contain multiple mailboxes. Determines the rate at which Availability service requests are occurring. | perf_counter_en["\MSExchange Availability Service\Availability Requests (sec)", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| Outlook Web App: current unique users | Shows the number of unique users currently logged on to Outlook Web App. This value monitors the number of unique active user sessions, so that users are only removed from this counter after they log off or their session times out. Determines current user load. | perf_counter_en["\MSExchange OWA\Current Unique Users", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| Outlook Web App: requests per second | Shows the number of requests handled by Outlook Web App per second. Determines current user load. | perf_counter_en["\MSExchange OWA\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |
| MSExchangeWS: requests per second | Shows the number of requests processed each second. Determines current user load. | perf_counter_en["\MSExchangeWS\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type | {$MS.EXCHANGE.PERF.INTERVAL} |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$MS.EXCHANGE.DB.ACTIVE.READ.TIME} | 5m |
| {$MS.EXCHANGE.DB.ACTIVE.READ.WARN} | 0.02 |
| {$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME} | 10m |
| {$MS.EXCHANGE.DB.ACTIVE.WRITE.WARN} | 0.05 |
| {$MS.EXCHANGE.DB.FAULTS.TIME} | 5m |
| {$MS.EXCHANGE.DB.FAULTS.WARN} | 0 |
| {$MS.EXCHANGE.DB.PASSIVE.READ.TIME} | 5m |
| {$MS.EXCHANGE.DB.PASSIVE.READ.WARN} | 0.2 |
| {$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME} | 10m |
| {$MS.EXCHANGE.LDAP.TIME} | 5m |
| {$MS.EXCHANGE.LDAP.WARN} | 0.05 |
| {$MS.EXCHANGE.LOG.STALLS.TIME} | 10m |
| {$MS.EXCHANGE.LOG.STALLS.WARN} | 100 |
| {$MS.EXCHANGE.PERF.INTERVAL} | 60 |
| {$MS.EXCHANGE.RPC.COUNT.TIME} | 5m |
| {$MS.EXCHANGE.RPC.COUNT.WARN} | 70 |
| {$MS.EXCHANGE.RPC.TIME} | 10m |
| {$MS.EXCHANGE.RPC.WARN} | 0.05 |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Databases discovery | perf_instance.discovery["MSExchange Active Manager"] | Discovery of Exchange databases. | no type | no lifetime | 1h |
| LDAP discovery | perf_instance_en.discovery["MSExchange ADAccess Domain Controllers"] | Discovery of domain controller. | no type | no lifetime | 1h |
| Web services discovery | perf_instance_en.discovery["Web Service"] | Discovery of Exchange web services. | no type | no lifetime | 1h |


<a name="discovery_databases_discovery" />

## Discovery Databases discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Active Manager [{#INSTANCE}]: Database copy role | Database copy active or passive role. | perf_counter_en["\MSExchange Active Manager({#INSTANCE})\Database Copy Role Active"] | no type |
| Information Store [{#INSTANCE}]: Page faults per second | Indicates the rate of page faults that can't be serviced because there are no pages available for allocation from the database cache. If this counter is above 0, it's an indication that the MSExchange Database\I/O Database Writes (Attached) Average Latency is too high. | perf_counter_en["\MSExchange Database({#INF.STORE})\Database Page Fault Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Information Store [{#INSTANCE}]: Log records stalled | Indicates the number of log records that can't be added to the log buffers per second because the log buffers are full. The average value should be below 10 per second. Spikes (maximum values) shouldn't be higher than 100 per second. | perf_counter_en["\MSExchange Database({#INF.STORE})\Log Record Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Information Store [{#INSTANCE}]: Log threads waiting | Indicates the number of threads waiting to complete an update of the database by writing their data to the log. | perf_counter_en["\MSExchange Database({#INF.STORE})\Log Threads Waiting", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Active database read operations per second | Shows the number of database read operations. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Active database read operations latency | Shows the average length of time per database read operation. Should be less than 20 ms on average. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Passive database read operations latency | Shows the average length of time per passive database read operation. Should be less than 200ms on average. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Active database write operations per second | Shows the number of database write operations per second for each attached database instance. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Active database write operations latency | Shows the average length of time per database write operation. Should be less than 50ms on average. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Database Counters [{#INSTANCE}]: Passive database write operations latency | Shows the average length of time, in ms, per passive database write operation. Should be less than the read latency for the same instance, as measured by the MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency counter. | perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Information Store [{#INSTANCE}]: Active mailboxes count | Number of active mailboxes in this database. | perf_counter_en["\MSExchangeIS Store({#INSTANCE})\Active mailboxes"] | no type |
| Information Store [{#INSTANCE}]: Database state | Database state. Possible values:<br>0: Database without any copy and dismounted.<br>1: Database is a primary database and mounted.<br>2: Database is a passive copy and the state is healthy. | perf_counter_en["\MSExchangeIS Store({#INSTANCE})\Database State"] | no type |
| Information Store [{#INSTANCE}]: RPC requests latency | RPC Latency average is the average latency of RPC requests per database. Average is calculated over all RPCs since exrpc32 was loaded. Should be less than 50ms at all times, with spikes less than 100ms. | perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Information Store [{#INSTANCE}]: RPC requests per second | Shows the number of RPC operations per second for each database instance. | perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Operations/sec", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Information Store [{#INSTANCE}]: RPC requests total | Indicates the overall RPC requests currently executing within the information store process. Should be below 70 at all times. | perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC requests", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Information Store [{#INSTANCE}]: Page faults is too high | AVERAGE | Too much page faults stalls for database "{#INSTANCE}". This counter should be 0 on production servers. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database({#INF.STORE})\Database Page Fault Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.FAULTS.TIME})>{$MS.EXCHANGE.DB.FAULTS.WARN} | [{"tag": "scope", "value": "notice"}] | no url |
| Information Store [{#INSTANCE}]: Log records stalls is too high | AVERAGE | Stalled log records too high. The average value should be less than 10 threads waiting. | avg(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database({#INF.STORE})\Log Record Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LOG.STALLS.TIME})>{$MS.EXCHANGE.LOG.STALLS.WARN} | [{"tag": "scope", "value": "notice"}] | no url |
| Database Counters [{#INSTANCE}]: Average read time latency is too high | WARNING | Should be less than 20ms on average. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.ACTIVE.READ.TIME})>{$MS.EXCHANGE.DB.ACTIVE.READ.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Database Counters [{#INSTANCE}]: Average read time latency is too high | WARNING | Should be less than 200ms on average. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.READ.TIME})>{$MS.EXCHANGE.DB.PASSIVE.READ.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Database Counters [{#INSTANCE}]: Average write time latency is too high for {$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME} | WARNING | Should be less than 50ms on average. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME})>{$MS.EXCHANGE.DB.ACTIVE.WRITE.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Information Store [{#INSTANCE}]: RPC Requests latency is too high | WARNING | Should be less than 50ms at all times, with spikes less than 100ms. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.RPC.TIME})>{$MS.EXCHANGE.RPC.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Information Store [{#INSTANCE}]: RPC Requests total count is too high | WARNING | Should be below 70 at all times. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC requests", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.RPC.COUNT.TIME})>{$MS.EXCHANGE.RPC.COUNT.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Database Counters [{#INSTANCE}]: Average write time latency is higher than read time latency for {$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME} | WARNING | Should be less than the read latency for the same instance, as measured by the MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency counter. | avg(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME})>avg(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME}) | [{"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_ldap_discovery" />

## Discovery LDAP discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Domain Controller [{#INSTANCE}]: Read time | Time that it takes to send an LDAP read request to the domain controller in question and get a response. Should ideally be below 50 ms; spikes below 100 ms are acceptable. | perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Read Time", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |
| Domain Controller [{#INSTANCE}]: Search time | Time that it takes to send an LDAP search request and get a response. Should ideally be below 50 ms; spikes below 100 ms are acceptable. | perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Search Time", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Domain Controller [{#INSTANCE}]: LDAP read time is too high | AVERAGE | Should be less than 50ms at all times, with spikes less than 100ms. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Read Time", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LDAP.TIME})>{$MS.EXCHANGE.LDAP.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| Domain Controller [{#INSTANCE}]: LDAP search time is too high | AVERAGE | Should be less than 50ms at all times, with spikes less than 100ms. | min(/Microsoft Exchange Server 2016 by Zabbix agent/perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Search Time", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LDAP.TIME})>{$MS.EXCHANGE.LDAP.WARN} | [{"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_web_services_discovery" />

## Discovery Web services discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Web Service [{#INSTANCE}]: Current connections | Shows the current number of connections established to the each Web Service. | perf_counter_en["\Web Service({#INSTANCE})\Current Connections", {$MS.EXCHANGE.PERF.INTERVAL}] | no type |

