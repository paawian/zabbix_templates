# Azure Virtual Machine by HTTP template description

This template is designed to monitor Microsoft Azure virtual machines (VMs) by HTTP.
It works without any external scripts and uses the script item.

Setup:
  1. Create an Azure service principal via the Azure command-line interface (Azure CLI) for your subscription.
    `az ad sp create-for-rbac --name zabbix --role reader --scope /subscriptions/<subscription_id>`
    See https://docs.microsoft.com/en-us/cli/azure/create-an-azure-service-principal-azure-cli for more details.
  2. Link the template to a host.
  3. Configure the macros: {$AZURE.APP.ID}, {$AZURE.PASSWORD}, {$AZURE.TENANT.ID}, {$AZURE.SUBSCRIPTION.ID}, and {$AZURE.RESOURCE.ID}.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Availability status detailed | The summary description of availability status. | azure.vm.availability.details | DEPENDENT | 0 |
| Availability state | The availability status of the resource. | azure.vm.availability.state | DEPENDENT | 0 |
| VM cached bandwidth consumed percentage | The percentage of the cached disk bandwidth consumed by the VM. | azure.vm.cached.bandwidth.consumed.percentage | DEPENDENT | 0 |
| VM cached IOPS consumed percentage | The percentage of the cached disk IOPS consumed by the VM. | azure.vm.cached.iops.consumed.percentage | DEPENDENT | 0 |
| CPU credits consumed | The total number of credits consumed by the virtual machine. Only available on B-series burstable VMs. | azure.vm.cpu.credits.consumed | DEPENDENT | 0 |
| CPU credits remaining | The total number of credits available to burst. Available only on B-series burstable VMs. | azure.vm.cpu.credits.remaining | DEPENDENT | 0 |
| Percentage CPU | The percentage of allocated computing units that are currently in use by VMs. | azure.vm.cpu.percentage | DEPENDENT | 0 |
| Data disk bandwidth consumed percentage | The percentage of the data disk bandwidth consumed per minute. | azure.vm.data.disk.bandwidth.consumed.percentage | DEPENDENT | 0 |
| Data disk IOPS consumed percentage | The percentage of the data disk input/output (I/O) consumed per minute. | azure.vm.data.disk.iops.consumed.percentage | DEPENDENT | 0 |
| Data disk max burst bandwidth | The maximum bytes per second throughput that the data disk can achieve with bursting. | azure.vm.data.disk.max.bandwidth | DEPENDENT | 0 |
| Data disk max burst IOPS | The maximum IOPS that the data disk can achieve with bursting. | azure.vm.data.disk.max.iops | DEPENDENT | 0 |
| Data disk queue depth | The number of outstanding IO requests that are waiting to be performed on a disk. | azure.vm.data.disk.queue.depth | DEPENDENT | 0 |
| Data disk read rate | Bytes per second read from a single disk during the monitoring period. | azure.vm.data.disk.read.bps | DEPENDENT | 0 |
| Data disk read operations/sec | The read IOPS from a single disk during the monitoring period. | azure.vm.data.disk.read.ops | DEPENDENT | 0 |
| Data disk target bandwidth | Baseline bytes per second throughput that the data disk can achieve without bursting. | azure.vm.data.disk.target.bandwidth | DEPENDENT | 0 |
| Data disk target IOPS | The baseline IOPS that the data disk can achieve without bursting. | azure.vm.data.disk.target.iops | DEPENDENT | 0 |
| Data disk used burst BPS credits percentage | The percentage of the data disk burst bandwidth credits used so far. | azure.vm.data.disk.used.burst.bandwidth | DEPENDENT | 0 |
| Data disk used burst IO credits percentage | The percentage of the data disk burst I/O credits used so far. | azure.vm.data.disk.used.burst.iops | DEPENDENT | 0 |
| Data disk write rate | Bytes per second written to a single disk during the monitoring period. | azure.vm.data.disk.write.bps | DEPENDENT | 0 |
| Data disk write operations/sec | The write IOPS from a single disk during the monitoring period. | azure.vm.data.disk.write.ops | DEPENDENT | 0 |
| Get errors | A list of errors from API requests. | azure.vm.data.errors | DEPENDENT | 0 |
| Get data | The result of API requests is expressed in the JSON. | azure.vm.data.get | SCRIPT | no delay |
| Disk read rate | Bytes read from the disk during the monitoring period (1 minute). | azure.vm.disk.read.bytes | DEPENDENT | 0 |
| Disk read operations/sec | The count of read operations from the disk per second. | azure.vm.disk.read.ops | DEPENDENT | 0 |
| Disk write rate | Bytes written to the disk during the monitoring period (1 minute). | azure.vm.disk.write.bytes | DEPENDENT | 0 |
| Disk write operations/sec | The count of write operations to the disk per second. | azure.vm.disk.write.ops | DEPENDENT | 0 |
| Inbound flows | The number of current flows in the inbound direction (the traffic going into the VM). | azure.vm.flows.inbound | DEPENDENT | 0 |
| Inbound flows max creation rate | The maximum creation rate of the inbound flows (the traffic going into the VM). | azure.vm.flows.inbound.max | DEPENDENT | 0 |
| Outbound flows | The number of current flows in the outbound direction (the traffic going out of the VM). | azure.vm.flows.outbound | DEPENDENT | 0 |
| Outbound flows max creation rate | The maximum creation rate of the outbound flows (the traffic going out of the VM). | azure.vm.flows.outbound.max | DEPENDENT | 0 |
| Available memory | The amount of physical memory (in bytes) immediately available for the allocation to a process or for a system use in the VM. | azure.vm.memory.available | DEPENDENT | 0 |
| Network in total | The number of bytes received by the VMs via all network interfaces (incoming traffic). | azure.vm.network.in.total | DEPENDENT | 0 |
| Network out total | The number of bytes sent by the VMs via all network interfaces (outgoing traffic). | azure.vm.network.out.total | DEPENDENT | 0 |
| OS disk bandwidth consumed percentage | The percentage of the operating system's disk bandwidth consumed per minute. | azure.vm.os.disk.bandwidth.consumed.percentage | DEPENDENT | 0 |
| OS disk IOPS consumed percentage | The percentage of the operating system's disk I/Os consumed per minute. | azure.vm.os.disk.iops.consumed.percentage | DEPENDENT | 0 |
| OS disk max burst bandwidth | Maximum bytes per second throughput that the OS disk can achieve with bursting. | azure.vm.os.disk.max.bandwidth | DEPENDENT | 0 |
| OS disk max burst IOPS | Maximum IOPS that the OS disk can achieve with bursting. | azure.vm.os.disk.max.iops | DEPENDENT | 0 |
| OS disk queue depth | The OS disk queue depth (or queue length). | azure.vm.os.disk.queue.depth | DEPENDENT | 0 |
| OS disk read rate | Bytes per second read from a single disk during the monitoring period for OS disk. | azure.vm.os.disk.read.bps | DEPENDENT | 0 |
| OS disk read operations/sec | The read IOPS from a single disk during the monitoring period for OS disk. | azure.vm.os.disk.read.ops | DEPENDENT | 0 |
| OS disk target bandwidth | Baseline bytes per second throughput that the OS disk can achieve without bursting. | azure.vm.os.disk.target.bandwidth | DEPENDENT | 0 |
| OS disk target IOPS | Baseline IOPS that the OS disk can achieve without bursting. | azure.vm.os.disk.target.iops | DEPENDENT | 0 |
| OS disk used burst BPS credits percentage | The percentage of the OS disk burst bandwidth credits used so far. | azure.vm.os.disk.used.burst.bandwidth | DEPENDENT | 0 |
| OS disk used burst IO credits percentage | The percentage of the OS disk burst I/O credits used so far. | azure.vm.os.disk.used.burst.iops | DEPENDENT | 0 |
| OS disk write rate | Bytes per second written to a single disk during the monitoring period for OS disk. | azure.vm.os.disk.write.bps | DEPENDENT | 0 |
| OS disk write operations/sec | The write IOPS from a single disk during the monitoring period for OS disk. | azure.vm.os.disk.write.ops | DEPENDENT | 0 |
| Premium data disk cache read hit | Premium data disk cache read hit. | azure.vm.premium.data.disk.cache.read.hit | DEPENDENT | 0 |
| Premium data disk cache read miss | Premium data disk cache read miss. | azure.vm.premium.data.disk.cache.read.miss | DEPENDENT | 0 |
| Premium OS disk cache read hit | Premium OS disk cache read hit. | azure.vm.premium.os.disk.cache.read.hit | DEPENDENT | 0 |
| Premium OS disk cache read miss | Premium OS disk cache read miss. | azure.vm.premium.os.disk.cache.read.miss | DEPENDENT | 0 |
| VM uncached bandwidth consumed percentage | The percentage of the uncached disk bandwidth consumed by the VM. | azure.vm.uncached.bandwidth.consumed.percentage | DEPENDENT | 0 |
| VM uncached IOPS consumed percentage | The percentage of the uncached disk IOPS consumed by the VM. | azure.vm.uncached.iops.consumed.percentage | DEPENDENT | 0 |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$AZURE.APP.ID} | no value |
| {$AZURE.DATA.TIMEOUT} | 15s |
| {$AZURE.PASSWORD} | no value |
| {$AZURE.PROXY} | no value |
| {$AZURE.RESOURCE.ID} | no value |
| {$AZURE.SUBSCRIPTION.ID} | no value |
| {$AZURE.TENANT.ID} | no value |
| {$AZURE.VM.CPU.UTIL.CRIT} | 90 |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Virtual machine is degraded | AVERAGE | The resource is in degraded state. | last(/Azure Virtual Machine by HTTP/azure.vm.availability.state)=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Virtual machine is in unknown state | WARNING | The resource state is unknown. | last(/Azure Virtual Machine by HTTP/azure.vm.availability.state)=3 | [{"tag": "scope", "value": "availability"}] | no url |
| Virtual machine is unavailable | HIGH | The resource state is unavailable. | last(/Azure Virtual Machine by HTTP/azure.vm.availability.state)=2 | [{"tag": "scope", "value": "availability"}] | no url |
| High CPU utilization | HIGH | The CPU utilization is too high. The system might be slow to respond. | min(/Azure Virtual Machine by HTTP/azure.vm.cpu.percentage,5m)>{$AZURE.VM.CPU.UTIL.CRIT} | [{"tag": "scope", "value": "performance"}] | no url |
| There are errors in requests to API | AVERAGE | Zabbix has received errors in response to API requests. | length(last(/Azure Virtual Machine by HTTP/azure.vm.data.errors))>0 | [{"tag": "scope", "value": "availability"}] | no url |

