# Apache Tomcat by JMX template description

The template to monitor Apache Tomcat by Zabbix that work without any external scripts.
The metrics are collected by JMX.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/411862-discussion-thread-for-official-zabbix-template-tomcat

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery Protocol handlers discovery ](#discovery_protocol_handlers_discovery)
  * [Discovery Global request processors discovery ](#discovery_global_request_processors_discovery)
  * [Discovery Contexts discovery ](#discovery_contexts_discovery)
  * [Discovery Thread pools discovery ](#discovery_thread_pools_discovery)

<a name="items" />

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Version | The version of the Tomcat. | jmx["Catalina:type=Server",serverInfo] | JMX | no delay |


<a name="macros" />

## Macros
| macro | value |
| ------------- |------------- |
| {$TOMCAT.LLD.FILTER.MANAGER.MATCHES} | .* |
| {$TOMCAT.LLD.FILTER.MANAGER.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$TOMCAT.LLD.FILTER.REQUEST_PROCESSOR.MATCHES} | .* |
| {$TOMCAT.LLD.FILTER.REQUEST_PROCESSOR.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$TOMCAT.LLD.FILTER.THREAD_POOL.MATCHES} | .* |
| {$TOMCAT.LLD.FILTER.THREAD_POOL.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$TOMCAT.PASSWORD} | no value |
| {$TOMCAT.THREADS.MAX.PCT} | 75 |
| {$TOMCAT.THREADS.MAX.TIME} | 5m |
| {$TOMCAT.USER} | no value |


<a name="triggers" />

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Version has been changed | INFO | The Tomcat version has changed. Acknowledge to close the problem manually. | last(/Apache Tomcat by JMX/jmx["Catalina:type=Server",serverInfo],#1)<>last(/Apache Tomcat by JMX/jmx["Catalina:type=Server",serverInfo],#2) and length(last(/Apache Tomcat by JMX/jmx["Catalina:type=Server",serverInfo]))>0 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discoveries" />

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Protocol handlers discovery | jmx.discovery[attributes,"Catalina:type=ProtocolHandler,port=*"] | Discovery for ProtocolHandler | JMX | no lifetime | 1h |
| Global request processors discovery | jmx.discovery[beans,"Catalina:type=GlobalRequestProcessor,name=*"] | Discovery for GlobalRequestProcessor | JMX | no lifetime | 1h |
| Contexts discovery | jmx.discovery[beans,"Catalina:type=Manager,host=*,context=*"] | Discovery for contexts | JMX | no lifetime | 1h |
| Thread pools discovery | jmx.discovery[beans,"Catalina:type=ThreadPool,name=*"] | Discovery for ThreadPool | JMX | no lifetime | 1h |


<a name="discovery_protocol_handlers_discovery" />

## Discovery Protocol handlers discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#JMXVALUE}: Gzip compression status | Gzip compression status on {#JMXNAME}. Enabling gzip compression may save server bandwidth. | jmx[{#JMXOBJ},compression] | JMX |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| {#JMXVALUE}: Gzip compression is disabled | INFO | gzip compression is disabled for connector {#JMXVALUE}. | find(/Apache Tomcat by JMX/jmx[{#JMXOBJ},compression],,"like","off") = 1 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discovery_global_request_processors_discovery" />

## Discovery Global request processors discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#JMXNAME}: Bytes received per second | Bytes received rate by processor {#JMXNAME} | jmx[{#JMXOBJ},bytesReceived] | JMX |
| {#JMXNAME}: Bytes sent per second | Bytes sent rate by processor {#JMXNAME} | jmx[{#JMXOBJ},bytesSent] | JMX |
| {#JMXNAME}: Errors per second | Error rate of request processor {#JMXNAME} | jmx[{#JMXOBJ},errorCount] | JMX |
| {#JMXNAME}: Requests processing time | The total time to process all incoming requests of request processor<br>{#JMXNAME} | jmx[{#JMXOBJ},processingTime] | JMX |
| {#JMXNAME}: Requests per second | Rate of requests served by request processor {#JMXNAME} | jmx[{#JMXOBJ},requestCount] | JMX |


<a name="discovery_contexts_discovery" />

## Discovery Contexts discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#JMXHOST}{#JMXCONTEXT}: Sessions active | Active sessions of the application. | jmx[{#JMXOBJ},activeSessions] | JMX |
| {#JMXHOST}{#JMXCONTEXT}: Sessions allowed maximum | The maximum number of active Sessions allowed, or -1 for no limit. | jmx[{#JMXOBJ},maxActiveSessions] | JMX |
| {#JMXHOST}{#JMXCONTEXT}: Sessions active maximum so far | Maximum number of active sessions so far. | jmx[{#JMXOBJ},maxActive] | JMX |
| {#JMXHOST}{#JMXCONTEXT}: Sessions rejected per second | Rate of sessions we rejected due to maxActive being reached. | jmx[{#JMXOBJ},rejectedSessions] | JMX |
| {#JMXHOST}{#JMXCONTEXT}: Sessions created per second | Rate of sessions created by this application per second. | jmx[{#JMXOBJ},sessionCounter] | JMX |


<a name="discovery_thread_pools_discovery" />

## Discovery Thread pools discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#JMXNAME}: Threads count | Amount of threads the thread pool has right now, both busy and free. | jmx[{#JMXOBJ},currentThreadCount] | JMX |
| {#JMXNAME}: Threads busy | Number of the requests that are being currently handled. | jmx[{#JMXOBJ},currentThreadsBusy] | JMX |
| {#JMXNAME}: Threads limit | Limit of the threads count. When currentThreadsBusy counter reaches the maxThreads limit, no more requests could be handled, and the application chokes. | jmx[{#JMXOBJ},maxThreads] | JMX |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| {#JMXNAME}: Busy worker threads count is high | HIGH | When current threads busy counter reaches the limit, no more requests could be handled, and the application chokes. | min(/Apache Tomcat by JMX/jmx[{#JMXOBJ},currentThreadsBusy],{$TOMCAT.THREADS.MAX.TIME:"{#JMXNAME}"})>last(/Apache Tomcat by JMX/jmx[{#JMXOBJ},maxThreads])*{$TOMCAT.THREADS.MAX.PCT:"{#JMXNAME}"}/100 | [{"tag": "scope", "value": "notice"}] | no url |

