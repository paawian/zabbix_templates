# Acronis Cyber Protect Cloud MSP by HTTP template description

Discovers and monitors alerts, clients, devices using HTTP agent items.

This template receives API token and datacenter URL from parent host, therefore no additional configuration is necessary.

Read the template documentation prior to using this template.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [discoveries](#discoveries)
  * [Discovery Acronis CPC: Alerts discovery ](#discovery_acronis_cpc:_alerts_discovery)
  * [Discovery Acronis CPC: Customer discovery ](#discovery_acronis_cpc:_customer_discovery)
  * [Discovery Acronis CPC: Device discovery ](#discovery_acronis_cpc:_device_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Get alerts | Fetches all alerts. | acronis.cpc.alerts.get | HTTP_AGENT | 5m |
| Alerts with "critical" severity | Gets count of alerts with "critical" severity. | acronis.cpc.alerts.severity.crit | DEPENDENT | 0 |
| Alerts with "error" severity | Gets count of alerts with "error" severity. | acronis.cpc.alerts.severity.err | DEPENDENT | 0 |
| Alerts with "information" severity | Gets count of alerts with "information" severity. | acronis.cpc.alerts.severity.info | DEPENDENT | 0 |
| Alerts with "ok" severity | Gets count of alerts with "ok" severity. | acronis.cpc.alerts.severity.ok | DEPENDENT | 0 |
| Alerts with "warning" severity | Gets count of alerts with "warning" severity. | acronis.cpc.alerts.severity.warn | DEPENDENT | 0 |
| Get customers | Fetches all customers. | acronis.cpc.customers.get | HTTP_AGENT | 5m |
| Get devices | Fetches all devices. | acronis.cpc.devices.get | HTTP_AGENT | no delay |
| Register integration | Registers integration on Acronis services. | acronis.cpc.register.integration | SCRIPT | 24h |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$ACRONIS.CPC.ACCESS_TOKEN} | no value |
| {$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.MATCHES} | .* |
| {$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.MATCHES} | .* |
| {$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.MATCHES} | .* |
| {$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ACRONIS.CPC.CUSTOMER.DISCOVERY.KIND.MATCHES} | customer |
| {$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.MATCHES} | .* |
| {$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ACRONIS.CPC.CYBERFIT.HIGH} | 579 |
| {$ACRONIS.CPC.CYBERFIT.WARN} | 669 |
| {$ACRONIS.CPC.DATACENTER.URL} | no value |
| {$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.MATCHES} | .* |
| {$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ACRONIS.CPC.DEVICE.RESOURCE.TYPE} | resource.machine |
| {$ACRONIS.CPC.HTTP.PROXY} | no value |
| {$ACRONIS.CPC.MSP.TENANT.UUID} | no value |
| {$ACRONIS.CPC.OFFSET.SCHEDULED.ANTIMALWARE} | -180 |
| {$ACRONIS.CPC.OFFSET.SCHEDULED.BACKUP} | -180 |
| {$ACRONIS.CPC.OFFSET.SCHEDULED.PATCH} | -180 |
| {$ACRONIS.CPC.OFFSET.SCHEDULED.VULNERABILITY} | -180 |
| {$ACRONIS.CPC.PATH.ACCOUNT.MANAGEMENT} | /api/2 |
| {$ACRONIS.CPC.PATH.AGENTS} | /api/agent_manager/v2 |
| {$ACRONIS.CPC.PATH.ALERTS} | /api/alert_manager/v1 |
| {$ACRONIS.CPC.PATH.RESOURCE.MANAGEMENT} | /api/resource_management/v4 |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Acronis CPC: Alerts discovery | acronis.cpc.alerts.discovery | Discovers alerts. | DEPENDENT | 0 | 0 |
| Acronis CPC: Customer discovery | acronis.cpc.customer.discovery | Discovers customers. | DEPENDENT | no lifetime | 0 |
| Acronis CPC: Device discovery | acronis.cpc.device.discovery | Discovers devices. | DEPENDENT | no lifetime | 0 |


<a name="discovery_acronis_cpc:_alerts_discovery"></a>

## Discovery Acronis CPC: Alerts discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Alert [{#TYPE}]:[{#ALERT_ID}]: Alert severity | Severity for the alert. | acronis.cpc.alert.severity[{#ALERT_ID}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has "critical" severity | HIGH | Alert has "critical" severity. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=3 | [{"tag": "scope", "value": "notice"}] | no url |
| Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has "error" severity | AVERAGE | Alert has "error" severity. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has "warning" severity | WARNING | Alert has "warning" severity. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=1 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discovery_acronis_cpc:_customer_discovery"></a>

## Discovery Acronis CPC: Customer discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Customer [{#NAME}]: Enabled status | Enabled status for customer (true or false). | acronis.cpc.customer.status[{#NAME}] | DEPENDENT |


<a name="discovery_acronis_cpc:_device_discovery"></a>

## Discovery Acronis CPC: Device discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Device [{#NAME}]:[{#ID}]: Agent enabled | Agent status (enabled or disabled) for the device. | acronis.cpc.device.agent.enabled[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Agent online | Agent reachability for the device. | acronis.cpc.device.agent.online[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Agent version | Agent version for the device. | acronis.cpc.device.agent.version[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Next machine backup run | Next scheduled machine backup run for device. | acronis.cpc.device.backup.next[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous successful machine backup run | Previous successful machine backup run for device. | acronis.cpc.device.backup.prev.ok[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous machine backup run | Previous machine backup run for device. | acronis.cpc.device.backup.prev[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: CyberFit score | Acronis "CyberFit" score for the device. Value of "-1" is assigned if "CyberFit" could not be found for device. | acronis.cpc.device.cyberfit[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Next patch management run | Next scheduled patch management run for device. | acronis.cpc.device.patch.next[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous successful patch management run | Previous successful patch management run for device. | acronis.cpc.device.patch.prev.ok[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous patch management run | Previous patch management run for device. | acronis.cpc.device.patch.prev[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Protection plan name | Protection plan name for device. | acronis.cpc.device.protection.name[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Next antimalware protection scan | Next scheduled antimalware protection scan for device. | acronis.cpc.device.protection.scan.next[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous successful antimalware protection scan | Previous successful antimalware protection scan for device. | acronis.cpc.device.protection.scan.prev.ok[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous antimalware protection scan | Previous antimalware protection scan for device. | acronis.cpc.device.protection.scan.prev[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Protection status | Protection status for device. | acronis.cpc.device.protection.status[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Raw data resources status | Gets statuses for device resources. | acronis.cpc.device.res.status.raw[{#NAME}] | HTTP_AGENT |
| Device [{#NAME}]:[{#ID}]: Next vulnerability assessment | Next scheduled vulnerability assessment for device. | acronis.cpc.device.vuln.next[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous successful vulnerability assessment | Previous successful vulnerability assessment for device. | acronis.cpc.device.vuln.prev.ok[{#NAME}] | DEPENDENT |
| Device [{#NAME}]:[{#ID}]: Previous vulnerability assessment | Previous vulnerability assessment for device. | acronis.cpc.device.vuln.prev[{#NAME}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Device [{#NAME}]:[{#ID}]: Agent disabled | INFO | Agent for this device is disabled for at least 3 minutes. | max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.agent.enabled[{#NAME}],3m) < 1 | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Scheduled machine backup failed to run | WARNING | Scheduled machine backup failed to run. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.next[{#NAME}]) < (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.BACKUP}) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: CyberFit score critical | HIGH | CyberFit score for this device is critical for at least 3 minutes. | min(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) < {$ACRONIS.CPC.CYBERFIT.HIGH}<br>and<br>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) <> -1 | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: CyberFit score low | WARNING | CyberFit score for this device is low for at least 3 minutes. | min(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) < {$ACRONIS.CPC.CYBERFIT.WARN}<br>and<br>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) <> -1 | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Scheduled patch management failed to run | WARNING | Scheduled patch management failed to run. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.next[{#NAME}]) < (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.PATCH}) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Scheduled antimalware scan failed to run | WARNING | Scheduled antimalware scan failed to run. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.next[{#NAME}]) < (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.ANTIMALWARE}) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Protection status "error" | AVERAGE | Device has "error" protection status. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.status[{#NAME}])="error" | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Protection status "warning" | WARNING | Device has "warning" protection status. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.status[{#NAME}])="warning" | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Scheduled vulnerability assessment failed to run | WARNING | Scheduled vulnerability assessment failed to run. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.next[{#NAME}]) < (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.VULNERABILITY}) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Previous machine backup run not successful | AVERAGE | Previous machine backup did not run successfully. | max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.prev.ok[{#NAME}],1m)<>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.prev[{#NAME}],1m) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Previous patch management run not successful | AVERAGE | Previous patch management run did not run successfully. | max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.prev.ok[{#NAME}],1m)<>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.prev[{#NAME}],1m) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Previous protection scan not successful | AVERAGE | Device has "error" protection status. | last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.prev.ok[{#NAME}])<>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.prev[{#NAME}]) | [{"tag": "scope", "value": "notice"}] | no url |
| Device [{#NAME}]:[{#ID}]: Previous vulnerability assessment not successful | AVERAGE | Previous vulnerability assessment did not run successfully. | max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.prev.ok[{#NAME}],1m)<>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.prev[{#NAME}],1m) | [{"tag": "scope", "value": "notice"}] | no url |

