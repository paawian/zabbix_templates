# Template: Etcd by HTTP

## Template ID
10324

## Description
This template is designed to monitor 'etcd' by Zabbix that works without any external scripts.
Most of the metrics are collected in one go, thanks to Zabbix bulk data collection.

The template 'Etcd by HTTP' â€” collects metrics by help of the HTTP agent from '/metrics' endpoint.

Refer to the vendor documentation:
https://etcd.io/docs/v3.5/op-guide/monitoring/#metrics-endpoint

For the users of 'etcd version <= 3.4':

In 'etcd v3.5' some metrics have been deprecated. See more details on 'Upgrade etcd from 3.4 to 3.5':
https://etcd.io/docs/v3.4/upgrades/upgrade_3_5/
Please upgrade your 'etcd' instance, or use older 'Etcd by HTTP' template version.

Setup:

1. Make sure that 'etcd' allows the collection of metrics. You can test it by running:
curl -L http://localhost:2379/metrics

2. Check if 'etcd' is accessible from Zabbix proxy or Zabbix server depending on where you are planning to do the monitoring. To verify it, run:
curl -L  http://<etcd_node_address>:2379/metrics

3. Add the template to the 'etcd' node. Set the hostname or IP address of the 'etcd' host in the '{$ETCD.HOST}' macro. By default, the template uses a client's port.
You can configure metrics endpoint location by adding '--listen-metrics-urls' flag.

For more details, see the etcd documentation:
https://etcd.io/docs/v3.5/op-guide/configuration/#profiling-and-monitoring

Additional points to consider:

- If you have specified a non-standard port for 'etcd', don't forget to change macros: '{$ETCD.SCHEME}' and '{$ETCD.PORT}'.
- You can set '{$ETCD.USERNAME}' and '{$ETCD.PASSWORD}' macros in the template to use on a host level if necessary.
- To test availability, run : 'zabbix_get -s etcd-host -k etcd.health'.

Generated by official Zabbix template tool "Templator"

## Linked Hosts
None

## Items

### Item: Cluster version
- **Description**: The version of the `etcd cluster`.
- **Interval**: 0
- **Data Type**: 1

### Item: CPU
- **Description**: The total user and system CPU time spent in seconds.
- **Interval**: 0
- **Data Type**: 0

### Item: DB size
- **Description**: The total size of the underlying database.
- **Interval**: 0
- **Data Type**: 0

### Item: Deletes per second
- **Description**: The number of deletes seen by this member per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Pending events
- **Description**: The total number of pending events to be sent.
- **Interval**: 0
- **Data Type**: 3

### Item: Get node metrics
- **Description**: 
- **Interval**: 1m
- **Data Type**: 4

### Item: Get version
- **Description**: 
- **Interval**: 1m
- **Data Type**: 4

### Item: RPCs received per second
- **Description**: The number of RPC stream messages received on the server.
- **Interval**: 0
- **Data Type**: 0

### Item: RPCs sent per second
- **Description**: The number of gRPC stream messages sent by the server.
- **Interval**: 0
- **Data Type**: 0

### Item: RPCs started per second
- **Description**: The number of RPCs started on the server.
- **Interval**: 0
- **Data Type**: 0

### Item: Server has a leader
- **Description**: It defines - whether or not a leader exists:
1 - it exists;
0 - it does not.
- **Interval**: 0
- **Data Type**: 3

### Item: Node health
- **Description**: 
- **Interval**: 1m
- **Data Type**: 3

### Item: HTTP 4XX
- **Description**: The number of handled failures of requests (non-watches), by the method (`GET/PUT` etc.), and the code `4XX`.
- **Interval**: 0
- **Data Type**: 0

### Item: HTTP 5XX
- **Description**: The number of handled failures of requests (non-watches), by the method (`GET/PUT` etc.), and the code `5XX`.
- **Interval**: 0
- **Data Type**: 0

### Item: HTTP requests received
- **Description**: The number of requests received into the system (successfully parsed and `authd`).
- **Interval**: 0
- **Data Type**: 0

### Item: Server is a leader
- **Description**: It defines - whether or not this member is a leader:
1 - it is;
0 - otherwise.
- **Interval**: 0
- **Data Type**: 3

### Item: Keys compacted per second
- **Description**: The number of DB keys compacted per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Keys expired per second
- **Description**: The number of expired keys per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Keys total
- **Description**: The total number of keys.
- **Interval**: 0
- **Data Type**: 3

### Item: Leader changes
- **Description**: The number of leader changes the member has seen since its start.
- **Interval**: 0
- **Data Type**: 3

### Item: Maximum open file descriptors
- **Description**: The Maximum number of open file descriptors.
- **Interval**: 0
- **Data Type**: 0

### Item: Client gRPC received bytes per second
- **Description**: The number of bytes received from gRPC clients per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Client gRPC sent bytes per second
- **Description**: The number of bytes sent from gRPC clients per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Open file descriptors
- **Description**: The number of open file descriptors.
- **Interval**: 0
- **Data Type**: 0

### Item: Proposals applied per second
- **Description**: The number of consensus proposals applied.
- **Interval**: 0
- **Data Type**: 0

### Item: Proposals committed per second
- **Description**: The number of consensus proposals committed.
- **Interval**: 0
- **Data Type**: 0

### Item: Proposals failed per second
- **Description**: The number of failed proposals seen.
- **Interval**: 0
- **Data Type**: 0

### Item: Proposals pending
- **Description**: The current number of pending proposals to commit.
- **Interval**: 0
- **Data Type**: 3

### Item: PUT per second
- **Description**: The number of puts seen by this member per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Range per second
- **Description**: The number of ranges seen by this member per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Reads per second
- **Description**: The number of read actions by `get/getRecursive`, local to this member.
- **Interval**: 0
- **Data Type**: 0

### Item: Resident memory
- **Description**: The size of resident memory expressed in bytes.
- **Interval**: 0
- **Data Type**: 0

### Item: Server version
- **Description**: The version of the `etcd server`.
- **Interval**: 0
- **Data Type**: 1

### Item: Transaction per second
- **Description**: The number of transactions seen by this member per second.
- **Interval**: 0
- **Data Type**: 0

### Item: Uptime
- **Description**: `Etcd` server uptime.
- **Interval**: 0
- **Data Type**: 0

### Item: Virtual memory
- **Description**: The size of virtual memory expressed in bytes.
- **Interval**: 0
- **Data Type**: 0

### Item: Writes per second
- **Description**: The number of writes (e.g., `set/compareAndDelete`) seen by this member.
- **Interval**: 0
- **Data Type**: 0

### Item: Service's TCP port state
- **Description**: 
- **Interval**: 1m
- **Data Type**: 3

