# Hikvision camera by HTTP template description

This template is designed for the effortless deployment of Hikvision cameras monitoring by Zabbix via HTTP and doesn't require any external scripts.

Sample device overview page:
https://www.hikvision.com/en/products/IP-Products/Network-Cameras/

Setup:

1. Set the hostname or IP address of the Hikvision ISAPI host in the '{$HIKVISION_ISAPI_HOST}' macro.

2. Set the user name and password in the '{$PASSWORD}' and '{$USER}' macros.

3. Change other macros according to your camera configuration if necessary.

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery PTZ discovery ](#discovery_ptz_discovery)
  * [Discovery Streaming channels discovery ](#discovery_streaming_channels_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Boot loader released date | no description | hikvision_cam.boot_released_date | DEPENDENT | 0 |
| Boot loader version | no description | hikvision_cam.boot_version | DEPENDENT | 0 |
| CPU utilization | CPU utilization in % | hikvision_cam.cpu.util | DEPENDENT | 0 |
| Current device time | no description | hikvision_cam.current_device_time | DEPENDENT | 0 |
| Device description | no description | hikvision_cam.device_description | DEPENDENT | 0 |
| Device ID | no description | hikvision_cam.device_id | DEPENDENT | 0 |
| Device location | no description | hikvision_cam.device_location | DEPENDENT | 0 |
| Device name | no description | hikvision_cam.device_name | DEPENDENT | 0 |
| Device type | no description | hikvision_cam.device_type | DEPENDENT | 0 |
| Encoder released date | no description | hikvision_cam.encoder_released_date | DEPENDENT | 0 |
| Encoder version | no description | hikvision_cam.encoder_version | DEPENDENT | 0 |
| Firmware released date | no description | hikvision_cam.firmware_released_date | DEPENDENT | 0 |
| Firmware version | no description | hikvision_cam.firmware_version | DEPENDENT | 0 |
| Get device info | Used to get the device information | hikvision_cam.get_info | HTTP_AGENT | no delay |
| Get device info: Login status | no description | hikvision_cam.get_info.login_status | DEPENDENT | 0 |
| Get system status | It is used to get the status information of the device | hikvision_cam.get_status | HTTP_AGENT | no delay |
| Get system status: Login status | no description | hikvision_cam.get_status.login_status | DEPENDENT | 0 |
| Get streaming channels | Used to get the properties of streaming channels for the device | hikvision_cam.get_streaming | HTTP_AGENT | no delay |
| Get streaming channels: Login status | no description | hikvision_cam.get_streaming.login_status | DEPENDENT | 0 |
| Hardware version | no description | hikvision_cam.hardware_version | DEPENDENT | 0 |
| MACaddress | no description | hikvision_cam.mac_address | DEPENDENT | 0 |
| Memory utilization | Memory utilization in % | hikvision_cam.memory.usage | DEPENDENT | 0 |
| Model | no description | hikvision_cam.model | DEPENDENT | 0 |
| Serial number | no description | hikvision_cam.serial_number | DEPENDENT | 0 |
| Supported beep | no description | hikvision_cam.support_beep | DEPENDENT | 0 |
| Supported video loss | no description | hikvision_cam.support_video_loss | DEPENDENT | 0 |
| System contact | no description | hikvision_cam.system_contact | DEPENDENT | 0 |
| Telecontrol ID | no description | hikvision_cam.telecontrol_id | DEPENDENT | 0 |
| Uptime | The system uptime expressed in the following format: "N days, hh:mm:ss". | hikvision_cam.uptime | DEPENDENT | 0 |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$CPU.UTIL.CRIT} | 90 |
| {$HIKVISION_ISAPI_HOST} | <SET ISAPI HOST> |
| {$HIKVISION_ISAPI_PORT} | 80 |
| {$HIKVISION_MAIN_CHANNEL_ID} | 101 |
| {$HIKVISION_STREAM_HEIGHT} | 1080 |
| {$HIKVISION_STREAM_WIDTH} | 1920 |
| {$MEMORY.UTIL.MAX} | 95 |
| {$PASSWORD} | no value |
| {$USER} | admin |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| High CPU utilization | WARNING | The CPU utilization is too high. The system might be slow to respond. | min(/Hikvision camera by HTTP/hikvision_cam.cpu.util,5m)>{$CPU.UTIL.CRIT} | [{"tag": "scope", "value": "performance"}] | no url |
| Version has changed | INFO | Hikvision camera version has changed. Acknowledge to close the problem manually. | last(/Hikvision camera by HTTP/hikvision_cam.firmware_version,#1)<>last(/Hikvision camera by HTTP/hikvision_cam.firmware_version,#2) and length(last(/Hikvision camera by HTTP/hikvision_cam.firmware_version))>0 | [{"tag": "scope", "value": "notice"}] | no url |
| High memory utilization | AVERAGE | The system is running out of free memory. | min(/Hikvision camera by HTTP/hikvision_cam.memory.usage,5m)>{$MEMORY.UTIL.MAX} | [{"tag": "scope", "value": "performance"}] | no url |
| Camera has been replaced | INFO | Camera serial number has changed. Acknowledge to close the problem manually. | last(/Hikvision camera by HTTP/hikvision_cam.serial_number,#1)<>last(/Hikvision camera by HTTP/hikvision_cam.serial_number,#2) and length(last(/Hikvision camera by HTTP/hikvision_cam.serial_number))>0 | [{"tag": "scope", "value": "notice"}] | no url |
| Camera has been restarted | INFO | Uptime is less than 10 minutes. | last(/Hikvision camera by HTTP/hikvision_cam.uptime)<10m | [{"tag": "scope", "value": "notice"}] | no url |
| Authorisation error | WARNING | Check the correctness of the authorization data | last(/Hikvision camera by HTTP/hikvision_cam.get_info.login_status)=1 or<br>last(/Hikvision camera by HTTP/hikvision_cam.get_streaming.login_status)=1 or<br>last(/Hikvision camera by HTTP/hikvision_cam.get_status.login_status)=1 | [{"tag": "scope", "value": "notice"}] | no url |
| Error receiving data | WARNING | Check the availability of the HTTP port | last(/Hikvision camera by HTTP/hikvision_cam.get_info.login_status)=2 or<br>last(/Hikvision camera by HTTP/hikvision_cam.get_streaming.login_status)=2 or<br>last(/Hikvision camera by HTTP/hikvision_cam.get_status.login_status)=2 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| PTZ discovery | hikvision_cam.ptz.discovery | no description | HTTP_AGENT | no lifetime | 1d |
| Streaming channels discovery | hikvision_cam.streaming.discovery | no description | HTTP_AGENT | no lifetime | 1d |


<a name="discovery_ptz_discovery"></a>

## Discovery PTZ discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Channel "{#PTZ_CHANNEL_ID}": Get PTZ info: Channel "{#PTZ_CHANNEL_ID}": Login status | no description | hikvision_cam.get_ptz.login_status[{#PTZ_CHANNEL_ID}] | DEPENDENT |
| Channel "{#PTZ_CHANNEL_ID}": Get PTZ info | High precision positioning which is accurate to a bit after the decimal point | hikvision_cam.get_ptz[{#PTZ_CHANNEL_ID}] | HTTP_AGENT |
| Channel "{#PTZ_CHANNEL_ID}": Absolute zoom | no description | hikvision_cam.ptz.absolute_zoom[{#PTZ_CHANNEL_ID}] | DEPENDENT |
| Channel "{#PTZ_CHANNEL_ID}": Azimuth | no description | hikvision_cam.ptz.azimuth[{#PTZ_CHANNEL_ID}] | DEPENDENT |
| Channel "{#PTZ_CHANNEL_ID}": Elevation | no description | hikvision_cam.ptz.elevation[{#PTZ_CHANNEL_ID}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Channel "{#PTZ_CHANNEL_ID}": Authorisation error | WARNING | Check the correctness of the authorization data | last(/Hikvision camera by HTTP/hikvision_cam.get_ptz.login_status[{#PTZ_CHANNEL_ID}])=1 | [{"tag": "scope", "value": "notice"}] | no url |
| Channel "{#PTZ_CHANNEL_ID}": Error receiving data | WARNING | Check the availability of the HTTP port | last(/Hikvision camera by HTTP/hikvision_cam.get_ptz.login_status[{#PTZ_CHANNEL_ID}])=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Channel "{#PTZ_CHANNEL_ID}": PTZ position changed | INFO | The direction of the camera has changed | last(/Hikvision camera by HTTP/hikvision_cam.ptz.absolute_zoom[{#PTZ_CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.ptz.absolute_zoom[{#PTZ_CHANNEL_ID}],#2) or <br>last(/Hikvision camera by HTTP/hikvision_cam.ptz.azimuth[{#PTZ_CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.ptz.azimuth[{#PTZ_CHANNEL_ID}],#2) or <br>last(/Hikvision camera by HTTP/hikvision_cam.ptz.elevation[{#PTZ_CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.ptz.elevation[{#PTZ_CHANNEL_ID}],#2) | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discovery_streaming_channels_discovery"></a>

## Discovery Streaming channels discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Channel "{#CHANNEL_ID}": Constant bitRate | no description | hikvision_cam.constant_bit_rate[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Fixed quality | no description | hikvision_cam.fixed_quality[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": GovLength | no description | hikvision_cam.gov_length[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": H264Profile | no description | hikvision_cam.h264Profile[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Key frame interval | no description | hikvision_cam.key_frame_interval[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Frame rate (max) | no description | hikvision_cam.max_frame_rate[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Smoothing | no description | hikvision_cam.smoothing[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Snapshot image type | no description | hikvision_cam.snap_shot_image_type[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": VBR lower | no description | hikvision_cam.vbr_lower_cap[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": VBR upper | no description | hikvision_cam.vbr_upper_cap[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Video codec type | no description | hikvision_cam.video_codec_type[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Video quality control type | no description | hikvision_cam.video_quality_control_type[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Resolution height | no description | hikvision_cam.video_resolution_height[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Resolution width | no description | hikvision_cam.video_resolution_width[{#CHANNEL_ID}] | DEPENDENT |
| Channel "{#CHANNEL_ID}": Video scan type | no description | hikvision_cam.video_scan_type[{#CHANNEL_ID}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Channel "{#CHANNEL_ID}": Invalid video stream resolution parameters | WARNING | expected: {$HIKVISION_STREAM_WIDTH} px x {$HIKVISION_STREAM_HEIGHT} px<br>received: {ITEM.LASTVALUE2} x {ITEM.LASTVALUE1} | last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_height[{#CHANNEL_ID}])<>{$HIKVISION_STREAM_HEIGHT} or<br>last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_width[{#CHANNEL_ID}])<>{$HIKVISION_STREAM_WIDTH} | [{"tag": "scope", "value": "notice"}] | no url |
| Channel "{#CHANNEL_ID}": Parameters of video stream are changed | INFO | no description | last(/Hikvision camera by HTTP/hikvision_cam.fixed_quality[{#CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.fixed_quality[{#CHANNEL_ID}],#2) or<br>last(/Hikvision camera by HTTP/hikvision_cam.constant_bit_rate[{#CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.constant_bit_rate[{#CHANNEL_ID}],#2) or<br>last(/Hikvision camera by HTTP/hikvision_cam.video_quality_control_type[{#CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.video_quality_control_type[{#CHANNEL_ID}],#2) or<br>last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_width[{#CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_width[{#CHANNEL_ID}],#2) or<br>last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_height[{#CHANNEL_ID}],#1)<>last(/Hikvision camera by HTTP/hikvision_cam.video_resolution_height[{#CHANNEL_ID}],#2) | [{"tag": "scope", "value": "notice"}] | no url |

