# Veeam Backup Enterprise Manager by HTTP template description

This template is designed to monitor Veeam Backup Enterprise Manager.

NOTE: The REST API may not be available for some editions, see (https://www.veeam.com/licensing-pricing.html) for more details.

Setup:
  1. Create a user to monitor the service, or use an existing read-only account.
     Similarly to the user authentication in the Veeam Backup Enterprise Manager Web UI, 
     the client authentication in the REST API dictates which operations a client is allowed to perform when working with the REST API.
     That is, if the client is authenticated using an account that does not have enough permissions to perform some actions, it will not be able to execute them.
     You can also obtain the collected jobs if you are logged in under an account having only `Portal Administrator` role.
  See (https://helpcenter.veeam.com/docs/backup/em_rest/http_authentication.html?ver=110) for more details.
  2. Link the template to a host.
  3. Configure the following macros: {$VEEAM.MANAGER.API.URL}, {$VEEAM.MANAGER.USER}, {$VEEAM.MANAGER.PASSWORD}.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery Backup Files discovery ](#discovery_backup_files_discovery)

<a name="items" />

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Failed Job Runs | Informs about the failed job runs. | veeam.manager.failed.jobs | DEPENDENT | 0 |
| Get errors | The errors from API requests. | veeam.manager.get.errors | DEPENDENT | 0 |
| Get metrics | The result of API requests is expressed in the JSON. | veeam.manager.get.metrics | SCRIPT | 5m |
| Running Jobs | Informs about the running jobs. | veeam.manager.running.jobs | DEPENDENT | 0 |
| Scheduled Backup Jobs | Informs about the scheduled backup jobs. | veeam.manager.scheduled.backup.jobs | DEPENDENT | 0 |
| Scheduled Jobs | Informs about the scheduled jobs. | veeam.manager.scheduled.jobs | DEPENDENT | 0 |
| Scheduled Replica Jobs | Informs about the scheduled replica jobs. | veeam.manager.scheduled.replica.jobs | DEPENDENT | 0 |
| Total Job Runs | Informs about the total job runs. | veeam.manager.scheduled.total.jobs | DEPENDENT | 0 |
| Warnings Job Runs | Informs about the warning job runs. | veeam.manager.warning.jobs | DEPENDENT | 0 |


<a name="macros" />

## Macros
| macro | value |
| ------------- |------------- |
| {$BACKUP.NAME.MATCHES} | .* |
| {$BACKUP.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$BACKUP.TYPE.MATCHES} | .* |
| {$BACKUP.TYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$VEEAM.MANAGER.API.URL} | https://localhost:9398 |
| {$VEEAM.MANAGER.DATA.TIMEOUT} | 10 |
| {$VEEAM.MANAGER.HTTP.PROXY} | no value |
| {$VEEAM.MANAGER.JOB.MAX.FAIL} | 5 |
| {$VEEAM.MANAGER.JOB.MAX.WARN} | 10 |
| {$VEEAM.MANAGER.PASSWORD} | no value |
| {$VEEAM.MANAGER.USER} | no value |


<a name="triggers" />

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Failed job runs is too high | AVERAGE | no description | last(/Veeam Backup Enterprise Manager by HTTP/veeam.manager.failed.jobs)>{$VEEAM.MANAGER.JOB.MAX.FAIL} | [{"tag": "scope", "value": "availability"}] | no url |
| There are errors in requests to API | AVERAGE | Zabbix has received errors in response to API requests. | length(last(/Veeam Backup Enterprise Manager by HTTP/veeam.manager.get.errors))>0 | [{"tag": "scope", "value": "availability"}] | no url |
| Warning job runs is too high | WARNING | no description | last(/Veeam Backup Enterprise Manager by HTTP/veeam.manager.warning.jobs)>{$VEEAM.MANAGER.JOB.MAX.WARN} | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discoveries" />

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Backup Files discovery | veeam.backup.files.discovery | Discovery of all backup files created on, or imported to the backup servers that are connected to Veeam Backup Enterprise Manager. | DEPENDENT | no lifetime | 0 |


<a name="discovery_backup_files_discovery" />

## Discovery Backup Files discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Compression ratio [{#NAME}] | Gets the data compression ratio with the name `[{#NAME}]`. | veeam.backup.compress.ratio[{#NAME}] | DEPENDENT |
| Data Size [{#NAME}] | Gets the data size with the name `[{#NAME}]`. | veeam.backup.data.size[{#NAME}] | DEPENDENT |
| Deduplication Ratio [{#NAME}] | Gets the data deduplication ratio with the name `[{#NAME}]`. | veeam.backup.deduplication.ratio[{#NAME}] | DEPENDENT |
| Backup Size [{#NAME}] | Gets the backup size with the name `[{#NAME}]`. | veeam.backup.file.size[{#NAME}] | DEPENDENT |

