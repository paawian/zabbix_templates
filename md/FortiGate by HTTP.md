# FortiGate by HTTP template description

The template for monitoring FortiGate Next Generation Firewall by HTTP.

1. On the FortiGate GUI, select System > Admin Profiles > Create New.
2. Enter a profile name (ex. zabbix_ro) and enable all the Read permissions. Please note the profile name, it will be used a bit later.
3. Go to System > Administrators > Create New > REST API Admin.
4. Enter the API-user's name and select the profile name you created in step 2.
5. The trusted host can be specified to ensure that only Zabbix server can reach the FortiGate.
6. Click OK and an API token will be generated. Make a note of the API token as it's only shown once and cannot be retrieved.
7. Put the API token into {$FGATE.API.TOKEN} macro.
8. Set your FortiGate GUI IP/FQDN as {$FGATE.API.FQDN} macro value.
9. If FortiGate GUI uses HTTPS, put "https" value into {$FGATE.SCHEME} macro and "443" into {$FGATE.API.PORT} macro.
10. If FortiGate GUI port differs from the standard one, specify it in {$FGATE.API.PORT} macro.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback.

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery Firewall policies discovery ](#discovery_firewall_policies_discovery)
  * [Discovery Network interfaces discovery ](#discovery_network_interfaces_discovery)
  * [Discovery SD-WAN health-checks discovery ](#discovery_sd-wan_health-checks_discovery)
  * [Discovery SD-WAN members discovery ](#discovery_sd-wan_members_discovery)
  * [Discovery Service discovery ](#discovery_service_discovery)

<a name="items" />

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| API availability status | Checking API availability by response. | fgate.api.status | DEPENDENT | 0 |
| Number of CPUs | Number of processors according to the current license. | fgate.cpu.num | DEPENDENT | 0 |
| CPU utilization | CPU utilization, expressed in %. | fgate.cpu.util | DEPENDENT | 0 |
| Device firmware version | Current version of the device firmware. | fgate.device.firmware | DEPENDENT | 0 |
| Available firmware versions | Number of available firmware versions to download. | fgate.device.firmwares_avail | DEPENDENT | 0 |
| Device model name | The model name of the device. | fgate.device.model | DEPENDENT | 0 |
| Device serial number | The device serial number. | fgate.device.serialnumber | DEPENDENT | 0 |
| Current VDOM | Name of the current Virtual Domain. | fgate.device.vdom | DEPENDENT | 0 |
| Device firmware info item errors | Item for gathering errors of the device firmware info. | fgate.firmware.data_errors | DEPENDENT | 0 |
| Get firmware info | Item for gathering device firmware info from FortiGate API. | fgate.firmware.get_data | HTTP_AGENT | no delay |
| Free disk space | The free space of the current disk, in bytes. | fgate.fs.free | DEPENDENT | 0 |
| Total disk space | The total space of the current disk, in bytes. | fgate.fs.total | DEPENDENT | 0 |
| Used disk space | The used space of the current disk, in bytes. | fgate.fs.used | DEPENDENT | 0 |
| Disk utilization | Disk utilization, expressed in %. | fgate.fs.util | DEPENDENT | 0 |
| Firewall data item errors | Item for gathering errors of firewall policies. | fgate.fwp.data_errors | DEPENDENT | 0 |
| Get firewall data | Item for gathering firewall policies info from FortiGate API. | fgate.fwp.get_data | SCRIPT | no delay |
| Total memory | Total memory, expressed in bytes. | fgate.memory.total | DEPENDENT | 0 |
| Memory utilization | Memory utilization, expressed in %. | fgate.memory.util | DEPENDENT | 0 |
| System name | The system host name. | fgate.name | DEPENDENT | 0 |
| Device interfaces item errors | Item for gathering errors of network interfaces. | fgate.netif.data_errors | DEPENDENT | 0 |
| Get interfaces data | Item for gathering network interfaces info from FortiGate API. | fgate.netif.get_data | SCRIPT | no delay |
| Device resources item errors | Item for gathering errors of the device resources. | fgate.resources.data_errors | DEPENDENT | 0 |
| Get resources data | Item for gathering device resource data from FortiGate API. | fgate.resources.get_data | SCRIPT | no delay |
| Get SD-WAN item errors | Item for gathering errors of SD-WAN. | fgate.sdwan.data_errors | DEPENDENT | 0 |
| Get SD-WAN data | Item for gathering SD-WAN information from FortiGate API. | fgate.sdwan.get_data | SCRIPT | no delay |
| Service licenses item errors | Item for gathering errors of the service licenses data. | fgate.service.data_errors | DEPENDENT | 0 |
| Get service licenses | Item for gathering information about service licenses from FortiGate API. | fgate.service.get_data | SCRIPT | no delay |
| Device system info item errors | Item for gathering errors of the device system info. | fgate.system.data_errors | DEPENDENT | 0 |
| Get system info | Item for gathering device system info from FortiGate API. | fgate.system.get_data | HTTP_AGENT | no delay |
| System uptime | The system uptime is calculated on the basis of boot time. | fgate.uptime | DEPENDENT | 0 |
| Check port availability | no description | net.tcp.service["{$FGATE.SCHEME}","{$FGATE.API.FQDN}","{$FGATE.API.PORT}"] | SIMPLE | no delay |


<a name="macros" />

## Macros
| macro | value |
| ------------- |------------- |
| {$CPU.UTIL.CRIT} | 95 |
| {$CPU.UTIL.WARN} | 85 |
| {$DISK.FREE.CRIT} | 10 |
| {$DISK.FREE.WARN} | 20 |
| {$FGATE.API.FQDN} | no value |
| {$FGATE.API.PORT} | 80 |
| {$FGATE.API.TOKEN} | no value |
| {$FGATE.DATA.TIMEOUT} | 15s |
| {$FGATE.HTTP.PROXY} | no value |
| {$FGATE.SCHEME} | http |
| {$FIRMWARE.UPDATES.CONTROL} | 1 |
| {$FWP.FWACTION.MATCHES} | .* |
| {$FWP.FWACTION.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$FWP.FWNAME.MATCHES} | .* |
| {$FWP.FWNAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$FWP.FWTYPE.MATCHES} | .* |
| {$FWP.FWTYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$MEMORY.UTIL.CRIT} | 90 |
| {$MEMORY.UTIL.WARN} | 80 |
| {$NET.IF.CONTROL} | 1 |
| {$NET.IF.ERRORS.WARN} | 2 |
| {$NET.IF.IFALIAS.MATCHES} | .* |
| {$NET.IF.IFALIAS.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFDESCR.MATCHES} | .* |
| {$NET.IF.IFDESCR.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFNAME.MATCHES} | .* |
| {$NET.IF.IFNAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFSTATUS.MATCHES} | .* |
| {$NET.IF.IFSTATUS.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFTYPE.MATCHES} | .* |
| {$NET.IF.IFTYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.UTIL.MAX} | 95 |
| {$SDWAN.HEALTH.ID.MATCHES} | .* |
| {$SDWAN.HEALTH.ID.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.HEALTH.IF.CONTROL} | 1 |
| {$SDWAN.HEALTH.IF.LOSS.WARN} | 20 |
| {$SDWAN.HEALTH.IFNAME.MATCHES} | .* |
| {$SDWAN.HEALTH.IFNAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.HEALTH.NAME.MATCHES} | .* |
| {$SDWAN.HEALTH.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.HEALTH.STATUS.MATCHES} | .* |
| {$SDWAN.HEALTH.STATUS.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.MEMBER.ID.MATCHES} | .* |
| {$SDWAN.MEMBER.ID.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.MEMBER.IF.CONTROL} | 1 |
| {$SDWAN.MEMBER.NAME.MATCHES} | .* |
| {$SDWAN.MEMBER.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.MEMBER.STATUS.MATCHES} | .* |
| {$SDWAN.MEMBER.STATUS.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.MEMBER.ZONE.MATCHES} | .* |
| {$SDWAN.MEMBER.ZONE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SERVICE.EXPIRY.WARN} | 7 |
| {$SERVICE.KEY.MATCHES} | .* |
| {$SERVICE.KEY.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SERVICE.LICENSE.CONTROL} | 1 |
| {$SERVICE.STATUS.MATCHES} | .* |
| {$SERVICE.STATUS.NOT_MATCHES} | (no_support\|no_license) |
| {$SERVICE.TYPE.MATCHES} | .* |
| {$SERVICE.TYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |


<a name="triggers" />

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Unexpected response from API | AVERAGE | Received an unexpected response from API. It may be unavailable. | last(/FortiGate by HTTP/fgate.api.status)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| CPU utilization is high | WARNING | The CPU utilization is high. | min(/FortiGate by HTTP/fgate.cpu.util,5m)>{$CPU.UTIL.WARN} | [{"tag": "scope", "value": "performance"}] | no url |
| CPU utilization is too high | HIGH | The CPU utilization is too high. The system might be slow to respond. | min(/FortiGate by HTTP/fgate.cpu.util,5m)>{$CPU.UTIL.CRIT} | [{"tag": "scope", "value": "performance"}] | no url |
| New available firmware found | INFO | New available firmware versions found to download.<br><br>This trigger expression works as follows:<br>1. It can be triggered if there are one or more available firmware versions.<br>2. `{$FIRMWARE.UPDATES.CONTROL}=1` - a user can redefine context macro to value - 0. That marks this notification as not important. No new trigger will be fired if new firmware is found. | {$FIRMWARE.UPDATES.CONTROL}=1 and last(/FortiGate by HTTP/fgate.device.firmwares_avail)>0 | [{"tag": "scope", "value": "notice"}] | no url |
| Device has been replaced | INFO | Device serial number has changed. Acknowledge to close the problem manually. | last(/FortiGate by HTTP/fgate.device.serialnumber,#1)<>last(/FortiGate by HTTP/fgate.device.serialnumber,#2) and<br>length(last(/FortiGate by HTTP/fgate.device.serialnumber))>0 | [{"tag": "scope", "value": "notice"}] | no url |
| There are errors in the 'Get firmware info' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.firmware.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.firmware.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.firmware.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| Free disk space is low | WARNING | Left disk space is not enough. | (100-last(/FortiGate by HTTP/fgate.fs.util))<{$DISK.FREE.WARN} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| Free disk space is too low | HIGH | Left disk space is too low. | (100-last(/FortiGate by HTTP/fgate.fs.util))<{$DISK.FREE.CRIT} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| There are errors in the 'Get firewall policies data' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.fwp.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.fwp.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.fwp.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| Memory utilization is high | AVERAGE | The system is running out of free memory. | min(/FortiGate by HTTP/fgate.memory.util,5m)>{$MEMORY.UTIL.WARN} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| Memory utilization is too high | HIGH | Free memory size is too low. | min(/FortiGate by HTTP/fgate.memory.util,5m)>{$MEMORY.UTIL.CRIT} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| System name has changed | INFO | The name of the system has changed. Acknowledge to close the problem manually. | last(/FortiGate by HTTP/fgate.name,#1)<>last(/FortiGate by HTTP/fgate.name,#2) and length(last(/FortiGate by HTTP/fgate.name))>0 | [{"tag": "scope", "value": "notice"}, {"tag": "scope", "value": "security"}] | no url |
| There are errors in the 'Get interfaces data' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.netif.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.netif.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.netif.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| There are errors in the 'Get resources data' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.resources.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.resources.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.resources.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| There are errors in the 'Get SD-WAN data' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.sdwan.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.sdwan.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.sdwan.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| There are errors in the 'Get service licenses' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.service.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.service.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.service.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| There are errors in the 'Get system info' metric | WARNING | no description | length(last(/FortiGate by HTTP/fgate.system.data_errors))>0 and length(last(/FortiGate by HTTP/fgate.system.data_errors,#1:now-1m))>0 and nodata(/FortiGate by HTTP/fgate.system.data_errors,2m)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| Device has been restarted | INFO | Uptime is less than 10 minutes. | last(/FortiGate by HTTP/fgate.uptime)<10m | [{"tag": "scope", "value": "notice"}] | no url |
| Port {$FGATE.API.PORT} is unavailable | AVERAGE | no description | last(/FortiGate by HTTP/net.tcp.service["{$FGATE.SCHEME}","{$FGATE.API.FQDN}","{$FGATE.API.PORT}"])=0 | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discoveries" />

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Firewall policies discovery | fgate.fwp.discovery | Discovery for FortiGate firewall policies. | DEPENDENT | no lifetime | 0 |
| Network interfaces discovery | fgate.netif.discovery | Discovery for FortiGate network interfaces. | DEPENDENT | no lifetime | 0 |
| SD-WAN health-checks discovery | fgate.sdwan_health.discovery | Discovery for FortiGate SD-WAN health-checks. | DEPENDENT | no lifetime | 0 |
| SD-WAN members discovery | fgate.sdwan_member.discovery | Discovery for FortiGate SD-WAN members. | DEPENDENT | no lifetime | 0 |
| Service discovery | fgate.service.discovery | Discovery for FortiGate services. | DEPENDENT | no lifetime | 0 |


<a name="discovery_firewall_policies_discovery" />

## Discovery Firewall policies discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| FW Policy [{#FWNAME}]: Action | The firewall policy action (accept / deny / ipsec). | fgate.fwp.action[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Total bytes processed | Number of bytes processed by both the software and hardware (ASIC) firewall. | fgate.fwp.bytes[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Get data | Item for gathering data for the {#FWNAME} firewall policy. | fgate.fwp.get_data[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Hits into the policy | Number of packets hit into the firewall policy per second. | fgate.fwp.hits[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Hardware processed bytes | Number of bytes processed only by the hardware (ASIC) firewall. | fgate.fwp.hw_bytes[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Last using time | The time at which the firewall policy was used the last time. | fgate.fwp.last_used[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Active sessions | Number of active sessions covered by this rule. | fgate.fwp.sessions[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Status | The firewall policy status. | fgate.fwp.status[{#FWUUID}] | DEPENDENT |
| FW Policy [{#FWNAME}]: Software processed bytes | Number of bytes processed only by the software firewall. | fgate.fwp.sw_bytes[{#FWUUID}] | DEPENDENT |


<a name="discovery_network_interfaces_discovery" />

## Discovery Network interfaces discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Interface [{#IFNAME}({#IFALIAS})]: Get data | Item for gathering data for the {#IFKEY} interface. | fgate.netif.get_data[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Bits received | The total number of octets received on the interface per second. | fgate.netif.in[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Inbound packets with errors | The total number of errors received. | fgate.netif.in_errors[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Inbound packets | The total number of packets received on the interface per second. | fgate.netif.in_packets[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Bits sent | The total number of octets transmitted out of the interface. | fgate.netif.out[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Outbound packets with errors | The total number of errors transmitted. | fgate.netif.out_errors[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Outbound packets | The total number of packets transmitted out of the interface per second. | fgate.netif.out_packets[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Speed | Speed of the interface. | fgate.netif.speed[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Link status | Current link status of the interface. | fgate.netif.status[{#IFKEY}] | DEPENDENT |
| Interface [{#IFNAME}({#IFALIAS})]: Interface type | Type of the interface. | fgate.netif.type[{#IFKEY}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Interface [{#IFNAME}({#IFALIAS})]: High error rate | WARNING | It recovers when it is below 80% of the `{$NET.IF.ERRORS.WARN:"{#IFKEY}"}` threshold. | min(/FortiGate by HTTP/fgate.netif.in_errors[{#IFKEY}],5m)>{$NET.IF.ERRORS.WARN:"{#IFKEY}"} or min(/FortiGate by HTTP/fgate.netif.in_errors[{#IFKEY}],5m)>{$NET.IF.ERRORS.WARN:"{#IFKEY}"} | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "performance"}] | no url |
| Interface [{#IFNAME}({#IFALIAS})]: Link down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the interface link status is down.<br>2. `{$NET.IF.CONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface link is down.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the interface link status was up to (1) sometime before.<br><br>WARNING: If closed manually, it will not fire again on the next poll because of .diff. | {$NET.IF.CONTROL:"{#IFNAME}"}=1 and last(/FortiGate by HTTP/fgate.netif.status[{#IFKEY}])=1 and (last(/FortiGate by HTTP/fgate.netif.status[{#IFKEY}],#1)<>last(/FortiGate by HTTP/fgate.netif.status[{#IFKEY}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |
| Interface [{#IFNAME}({#IFALIAS})]: Ethernet has changed to lower speed than it was before | INFO | This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually. | change(/FortiGate by HTTP/fgate.netif.speed[{#IFKEY}])<0 and last(/FortiGate by HTTP/fgate.netif.speed[{#IFKEY}])>0 <br>and last(/FortiGate by HTTP/fgate.netif.status[{#IFKEY}])<>0 | [{"tag": "scope", "value": "performance"}] | no url |
| Interface [{#IFNAME}({#IFALIAS})]: High bandwidth usage | WARNING | The utilization of the network interface is close to its estimated maximum bandwidth. | (avg(/FortiGate by HTTP/fgate.netif.in[{#IFKEY}],15m)>({$NET.IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/FortiGate by HTTP/fgate.netif.speed[{#IFKEY}]) or <br>avg(/FortiGate by HTTP/fgate.netif.out[{#IFKEY}],15m)>({$NET.IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/FortiGate by HTTP/fgate.netif.speed[{#IFKEY}])) <br>and last(/FortiGate by HTTP/fgate.netif.speed[{#IFKEY}])>0 | [{"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_sd-wan_health-checks_discovery" />

## Discovery SD-WAN health-checks discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Get data | Item for gathering data about the {#IFNAME} interface in the {#NAME} health-check. | fgate.sdwan_health.get_data["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Jitter | Current jitter value for the {#IFNAME} interface in the {#NAME} health-check. | fgate.sdwan_health.jitter["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Latency | Current latency value for the {#IFNAME} interface in the {#NAME} health-check. | fgate.sdwan_health.latency["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Packets loss | Percent of lost packets for the {#IFNAME} interface in the {#NAME} health-check. | fgate.sdwan_health.loss["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Packets received per second | Number of packets received from the {#IFNAME} interface in the {#NAME} health-check per second. | fgate.sdwan_health.received["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Packets sent per second | Number of packets sent through the {#IFNAME} interface in the {#NAME} health-check per second. | fgate.sdwan_health.sent["{#HID}.{#MID}"] | DEPENDENT |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Interface status | Current status of the {#IFNAME} interface in the {#NAME} health-check. | fgate.sdwan_health.status["{#HID}.{#MID}"] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| SD-WAN [{#NAME}]:[{#IFNAME}]: High packets loss | WARNING | High level of packets loss detected. | min(/FortiGate by HTTP/fgate.sdwan_health.loss["{#HID}.{#MID}"],5m)>{$SDWAN.HEALTH.IF.LOSS.WARN:"{#IFNAME}"} | [{"tag": "scope", "value": "performance"}] | no url |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Link down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the interface status is down.<br>2. `{$SDWAN.HEALTH.IF.CONTROL:"{#NAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down/error.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the interface status was up to (1) sometime before.<br><br>WARNING: If closed manually, it will not fire again on the next poll because of .diff. | {$SDWAN.HEALTH.IF.CONTROL:"{#NAME}"}=1 and last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"])=1 and (last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"],#1)<>last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"],#2)) | [{"tag": "scope", "value": "availability"}] | no url |
| SD-WAN [{#NAME}]:[{#IFNAME}]: Link state is error | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the interface status is error.<br>2. `{$SDWAN.HEALTH.IF.CONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down/error.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the interface status was up to (1) sometime before.<br><br>WARNING: If closed manually, it will not fire again on the next poll because of .diff. | {$SDWAN.HEALTH.IF.CONTROL:"{#IFNAME}"}=1 and last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"])=2 and (last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"],#1)<>last(/FortiGate by HTTP/fgate.sdwan_health.status["{#HID}.{#MID}"],#2)) | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discovery_sd-wan_members_discovery" />

## Discovery SD-WAN members discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| SD-WAN [{#ZONE}]:[{#NAME}]: Get data | Item for gathering data about the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.get_data[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Link status | Current link status of the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.link_status[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Input bandwidth | Receiving bandwidth of the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.rx_bandwidth[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Bytes received per second | Bytes received from the {#NAME} interface in the {#ZONE} zone per second. | fgate.sdwan_member.rx_bytes[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Sessions | Number of active sessions opened through the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.sessions[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Member status | Current status of the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.status[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Output bandwidth | Transmitting bandwidth of the {#NAME} interface in the {#ZONE} zone. | fgate.sdwan_member.tx_bandwidth[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: Bytes sent per second | Bytes sent through the {#NAME} interface in the {#ZONE} zone per second. | fgate.sdwan_member.tx_bytes[{#ID}] | DEPENDENT |
| SD-WAN [{#ZONE}]:[{#NAME}]: State changing time | Last state changing time of the {#NAME} interface in the {#ZONE} zone. | fgate.service.state_changed[{#ID}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| SD-WAN [{#ZONE}]:[{#NAME}]: Link down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the interface status is down.<br>2. `{$SDWAN.MEMBER.IF.CONTROL:"{#NAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the interface status was up to (1) sometime before.<br><br>WARNING: If closed manually, it will not fire again on the next poll because of .diff. | {$SDWAN.MEMBER.IF.CONTROL:"{#NAME}"}=1 and last(/FortiGate by HTTP/fgate.sdwan_member.link_status[{#ID}])=1 and (last(/FortiGate by HTTP/fgate.sdwan_member.link_status[{#ID}],#1)<>last(/FortiGate by HTTP/fgate.sdwan_member.link_status[{#ID}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discovery_service_discovery" />

## Discovery Service discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Service [{#NAME}]: Expiration date | Expiration date for the license of the current service. | fgate.service.expire["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Get data | Item for gathering data about license for the {#NAME} service. | fgate.service.get_data["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: License status | Current license status of the {#NAME} service. | fgate.service.license["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Service type | Current type of the {#NAME} service. | fgate.service.type["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Last attempt to update | Last update attempt time of the current service. | fgate.service.update_attempt["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Update method | Current update method of the {#NAME} service. | fgate.service.update_method["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Update result | Last update result of the {#NAME} service. | fgate.service.update_result["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Last update time | Last update time of the current service. | fgate.service.update_time["{#KEY}"] | DEPENDENT |
| Service [{#NAME}]: Service version | Current version of the {#NAME} service. | fgate.service.version["{#KEY}"] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Service [{#NAME}]: License expires soon | WARNING | This trigger expression works as follows:<br>1. It can be triggered if the license expires soon.<br>2. `{$SERVICE.LICENSE.CONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks the license of this service as not important. No new trigger will be fired if this license expires. | {$SERVICE.LICENSE.CONTROL:"{#KEY}"}=1 and (last(/FortiGate by HTTP/fgate.service.expire["{#KEY}"]) - now()) / 86400 < {$SERVICE.EXPIRY.WARN:"{#KEY}"} and last(/FortiGate by HTTP/fgate.service.expire["{#KEY}"]) > now() | [{"tag": "scope", "value": "notice"}] | no url |
| Service [{#NAME}]: License status is unsuccessful | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the license status is unsuccessful.<br>2. `{$SERVICE.LICENSE.CONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks the license of this service as not important. No new trigger will be fired if this license is unsuccessful. | {$SERVICE.LICENSE.CONTROL:"{#KEY}"}=1 and last(/FortiGate by HTTP/fgate.service.license["{#KEY}"])>5 | [{"tag": "scope", "value": "notice"}] | no url |

