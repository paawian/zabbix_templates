# FortiGate by SNMP template description

The template for monitoring FortiGate firewall by SNMP.

MIBs used:
HOST-RESOURCES-MIB
FORTINET-FORTIGATE-MIB
FORTINET-CORE-MIB
SNMPv2-MIB
IF-MIB

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery CPU discovery ](#discovery_cpu_discovery)
  * [Discovery HA member discovery ](#discovery_ha_member_discovery)
  * [Discovery Hardware sensors discovery ](#discovery_hardware_sensors_discovery)
  * [Discovery Network interface discovery ](#discovery_network_interface_discovery)
  * [Discovery SD-WAN health-check discovery ](#discovery_sd-wan_health-check_discovery)
  * [Discovery SoC3 discovery ](#discovery_soc3_discovery)
  * [Discovery Virtual domain discovery ](#discovery_virtual_domain_discovery)
  * [Discovery VPN tunnel discovery ](#discovery_vpn_tunnel_discovery)
  * [Discovery Wireless discovery ](#discovery_wireless_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| HA config sync | MIB: FORTINET-FORTIGATE-MIB<br>Configuration of an automatic configuration synchronization (enabled or disabled). | ha.auto.sync[fgHaAutoSync.0] | SNMP_AGENT | 1h |
| HA cluster group ID | MIB: FORTINET-FORTIGATE-MIB<br>HA cluster group ID device is configured for. | ha.cluster.group_id[fgHaGroupId.0] | SNMP_AGENT | 1h |
| HA cluster group name | MIB: FORTINET-FORTIGATE-MIB<br>HA cluster group name. | ha.cluster.group_name[fgHaGroupName.0] | SNMP_AGENT | 1h |
| HA cluster primary override | MIB: FORTINET-FORTIGATE-MIB<br>Status of the primary override flag. | ha.cluster.override[fgHaOverride.0] | SNMP_AGENT | 1h |
| HA cluster priority | MIB: FORTINET-FORTIGATE-MIB<br>HA clustering priority of the device (default = 128). | ha.cluster.priority[fgHaPriority.0] | SNMP_AGENT | 1h |
| SNMP walk HA members | Used for discovering HA members from FORTINET-FORTIGATE-MIB. | ha.members.walk | SNMP_AGENT | no delay |
| HA mode | MIB: FORTINET-FORTIGATE-MIB<br>High-availability mode (Standalone, A-A or A-P). | ha.mode[fgHaSystemMode.0] | SNMP_AGENT | 1h |
| HA load-balancing schedule | MIB: FORTINET-FORTIGATE-MIB<br>Load-balancing schedule of cluster (in A-A mode). | ha.schedule[fgHaSchedule.0] | SNMP_AGENT | 1h |
| SNMP walk hardware sensors | Used for discovering hardware sensors from FORTINET-FORTIGATE-MIB. | hw.sensor.walk | SNMP_AGENT | no delay |
| ICMP ping | Host accessibility by ICMP.<br>0 - ICMP ping failed.<br>1 - ICMP ping successful. | icmpping | SIMPLE | no delay |
| ICMP loss | Percentage of lost packets. | icmppingloss | SIMPLE | no delay |
| ICMP response time | ICMP ping response time (in seconds). | icmppingsec | SIMPLE | no delay |
| Blocked intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of intrusions blocked per second. | ips.blocked[fgIpsIntrusionsBlocked.0] | SNMP_AGENT | no delay |
| IPS database version | MIB: FORTINET-FORTIGATE-MIB<br>IPS signature database version installed on the device. | ips.database.version[fgSysVersionIps.0] | SNMP_AGENT | 1h |
| Detected anomaly based intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of intrusions detected as anomalies per second. | ips.detected.anomaly[fgIpsAnomalyDetections.0] | SNMP_AGENT | no delay |
| Detected critical intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of critical severity intrusions detected per second. | ips.detected.crit[fgIpsCritSevDetections.0] | SNMP_AGENT | no delay |
| Detected high intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of high severity intrusions detected per second. | ips.detected.high[fgIpsHighSevDetections.0] | SNMP_AGENT | no delay |
| Detected info intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of info severity intrusions detected per second. | ips.detected.info[fgIpsInfoSevDetections.0] | SNMP_AGENT | no delay |
| Detected low intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of low severity intrusions detected per second. | ips.detected.low[fgIpsLowSevDetections.0] | SNMP_AGENT | no delay |
| Detected medium intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of medium severity intrusions detected per second. | ips.detected.med[fgIpsMedSevDetections.0] | SNMP_AGENT | no delay |
| Detected signature based intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Number of intrusions detected by signature per second. | ips.detected.sign[fgIpsSignatureDetections.0] | SNMP_AGENT | no delay |
| Total detected intrusions | MIB: FORTINET-FORTIGATE-MIB<br>Total number of intrusions detected per second. | ips.detected.total[fgIpsIntrusionsDetected.0] | SNMP_AGENT | no delay |
| SNMP walk network interfaces | Used for discovering interfaces from IF-MIB. | net.if.walk | SNMP_AGENT | no delay |
| IPv4 Active sessions | MIB: FORTINET-FORTIGATE-MIB<br>Number of active sessions on the device. | net.ipv4.sessions[fgSysSesCount.0] | SNMP_AGENT | 5m |
| SNMP walk SD-WAN health-checks | Used for discovering SD-WAN health-checks from FORTINET-FORTIGATE-MIB. | sdwan_health.walk | SNMP_AGENT | no delay |
| SNMP traps (fallback) | Used for collecting all SNMP traps unmatched by other `snmptrap` items. | snmptrap.fallback | SNMP_TRAP | 0 |
| System contact details | MIB: SNMPv2-MIB<br>Name and contact information of the contact person for the node. If not provided, the value is a zero-length string. | system.contact[sysContact.0] | SNMP_AGENT | 15m |
| Number of CPUs | MIB: FORTINET-FORTIGATE-MIB<br>Number of processors. | system.cpu.num | SNMP_AGENT | no delay |
| CPU utilization | MIB: FORTINET-FORTIGATE-MIB<br>CPU utilization in %. | system.cpu.util[fgSysCpuUsage.0] | SNMP_AGENT | no delay |
| SNMP walk CPU | Used for discovering CPU from FORTINET-FORTIGATE-MIB. | system.cpu.walk | SNMP_AGENT | no delay |
| System description | MIB: SNMPv2-MIB<br>A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating system, and networking software. | system.descr[sysDescr.0] | SNMP_AGENT | 15m |
| Firmware version | MIB: FORTINET-FORTIGATE-MIB<br>Firmware version of the device. | system.hw.firmware | SNMP_AGENT | 1h |
| Hardware model name | MIB: ENTITY-MIB<br>Model of the device. | system.hw.model | SNMP_AGENT | 1h |
| Hardware serial number | MIB: ENTITY-MIB<br>Serial number of the device. | system.hw.serialnumber | SNMP_AGENT | 1h |
| System location | MIB: SNMPv2-MIB<br>Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string. | system.location[sysLocation.0] | SNMP_AGENT | 15m |
| System name | MIB: SNMPv2-MIB<br>An administratively-assigned name for the node (the node's fully-qualified domain name). If not provided, the value is a zero-length string. | system.name | SNMP_AGENT | 15m |
| System object ID | MIB: SNMPv2-MIB<br>The vendor's authoritative identification of the entity as part of the vendor's SMI enterprises subtree with the prefix 1.3.6.1.4.1 (e.g., a vendor with the identifier 1.3.6.1.4.1.4242 might assign a system object with the OID 1.3.6.1.4.1.4242.1.1). | system.objectid[sysObjectID.0] | SNMP_AGENT | 15m |
| System uptime | MIB: FORTINET-FORTIGATE-MIB<br>Time since the network management portion of the system was last re-initialized. | system.uptime[fgSysUpTime.0] | SNMP_AGENT | no delay |
| SNMP walk virtual domain | Used for discovering virtual domains from FORTINET-FORTIGATE-MIB. | vdom.walk | SNMP_AGENT | no delay |
| Free disk space | Free hard disk capacity. | vfs.fs.free | CALCULATED | no delay |
| Free disk percentage | Free disk space, expressed in %. | vfs.fs.pfree | CALCULATED | no delay |
| Total disk space | Total hard disk capacity. | vfs.fs.total[fgSysDiskCapacity.0] | SNMP_AGENT | no delay |
| Used disk space | Current hard disk usage. | vfs.fs.used[fgSysDiskUsage.0] | SNMP_AGENT | no delay |
| Available memory | Total memory available for utilization. | vm.memory.available[fgSysMemFree.0] | CALCULATED | no delay |
| Total memory | MIB: FORTINET-FORTIGATE-MIB<br>Total physical memory (RAM) installed. | vm.memory.total[fgSysMemCapacity.0] | SNMP_AGENT | no delay |
| Used memory | MIB: FORTINET-FORTIGATE-MIB<br>Physical memory (RAM) used calculated based on memory utilization percentage. | vm.memory.used[fgSysMemUsage.0] | CALCULATED | no delay |
| Memory utilization | Current memory utilization (percentage). | vm.memory.util[memoryUsedPercentage.0] | SNMP_AGENT | no delay |
| SSL VPN state | MIB: FORTINET-FORTIGATE-MIB<br>Used to determine whether SSL-VPN is enabled on this virtual domain. | vpn.ssl.state[fgVpnSslState.0] | SNMP_AGENT | no delay |
| Active IPsec VPN tunnels | MIB: FORTINET-FORTIGATE-MIB<br>Number of IPsec VPN tunnels with at least one SA. | vpn.tunnel.active[fgVpnTunnelUpCount.0] | SNMP_AGENT | no delay |
| SNMP walk VPN tunnels | Used for discovering VPN tunnels from FORTINET-FORTIGATE-MIB. | vpn.tunnel.walk | SNMP_AGENT | no delay |
| Active SSL VPN users | MIB: FORTINET-FORTIGATE-MIB<br>Current number of users logged in through SSL-VPN tunnels in the virtual domain. | vpn.users.count[fgVpnSslStatsLoginUsers.0] | SNMP_AGENT | no delay |
| SNMP walk wireless AP | Used for discovering wireless access points from FORTINET-FORTIGATE-MIB. | wireless.ap.walk | SNMP_AGENT | no delay |
| SNMP agent availability | Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.<br>Possible values:<br>0 - not available<br>1 - available<br>2 - unknown | zabbix[host,snmp,available] | INTERNAL | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$CPU.UTIL.CRIT} | 90 |
| {$DISK.FREE.CRIT} | 10 |
| {$DISK.FREE.WARN} | 20 |
| {$HA.MEMBER.SN.MATCHES} | .* |
| {$HA.MEMBER.SN.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$ICMP_LOSS_WARN} | 20 |
| {$ICMP_RESPONSE_TIME_WARN} | 0.15 |
| {$IF.ERRORS.WARN} | 2 |
| {$IF.UTIL.MAX} | 95 |
| {$IFCONTROL} | 1 |
| {$MEMORY.UTIL.MAX} | 90 |
| {$NET.IF.IFADMINSTATUS.MATCHES} | .* |
| {$NET.IF.IFADMINSTATUS.NOT_MATCHES} | ^2$ |
| {$NET.IF.IFALIAS.MATCHES} | .* |
| {$NET.IF.IFALIAS.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFDESCR.MATCHES} | .* |
| {$NET.IF.IFDESCR.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$NET.IF.IFNAME.MATCHES} | .* |
| {$NET.IF.IFNAME.NOT_MATCHES} | (^[Ll]o[0-9.]*$) |
| {$NET.IF.IFOPERSTATUS.MATCHES} | .* |
| {$NET.IF.IFOPERSTATUS.NOT_MATCHES} | ^6$ |
| {$NET.IF.IFTYPE.MATCHES} | .* |
| {$NET.IF.IFTYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SDWAN.HEALTH.IF.CONTROL} | 1 |
| {$SDWAN.HEALTH.IF.LOSS.WARN} | 20 |
| {$SDWAN.HEALTH.NAME.MATCHES} | .* |
| {$SDWAN.HEALTH.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$SNMP.TIMEOUT} | 5m |
| {$VDOM.NAME.MATCHES} | .* |
| {$VDOM.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$VPN.NAME.MATCHES} | .* |
| {$VPN.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$VPN.STATE.CONTROL} | 1 |
| {$WC.CPU.UTIL.CRIT} | 90 |
| {$WC.MEMORY.UTIL.MAX} | 90 |
| {$WC.NAME.MATCHES} | .* |
| {$WC.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$WC.STATE.CONTROL} | 1 |
| {$WC.UPDATE.CONTROL} | 1 |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Unavailable by ICMP ping | HIGH | Last three attempts returned timeout. Please check device connectivity. | max(/FortiGate by SNMP/icmpping,#3)=0 | [{"tag": "scope", "value": "availability"}] | no url |
| High ICMP ping loss | WARNING | ICMP ping loss detected. | min(/FortiGate by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/FortiGate by SNMP/icmppingloss,5m)<100 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "performance"}] | no url |
| High ICMP ping response time | WARNING | Average ICMP response time is too high. | avg(/FortiGate by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN} | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "performance"}] | no url |
| High CPU utilization | WARNING | The CPU utilization is too high. The system might be slow to respond. | min(/FortiGate by SNMP/system.cpu.util[fgSysCpuUsage.0],5m)>{$CPU.UTIL.CRIT} | [{"tag": "scope", "value": "performance"}] | no url |
| Device has been replaced | INFO | Device serial number has changed. Acknowledge to close the problem manually. | last(/FortiGate by SNMP/system.hw.serialnumber,#1)<>last(/FortiGate by SNMP/system.hw.serialnumber,#2) and<br>length(last(/FortiGate by SNMP/system.hw.serialnumber))>0 | [{"tag": "scope", "value": "notice"}] | no url |
| System name has changed | INFO | The name of the system has changed. Acknowledge to close the problem manually. | last(/FortiGate by SNMP/system.name,#1)<>last(/FortiGate by SNMP/system.name,#2) and length(last(/FortiGate by SNMP/system.name))>0 | [{"tag": "scope", "value": "notice"}, {"tag": "scope", "value": "security"}] | no url |
| Device has been restarted | INFO | Uptime is less than 10 minutes. | last(/FortiGate by SNMP/system.uptime[fgSysUpTime.0])<10m | [{"tag": "scope", "value": "notice"}] | no url |
| Free disk space is low | WARNING | Available disk space is not enough. | last(/FortiGate by SNMP/vfs.fs.pfree)<{$DISK.FREE.WARN} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| Free disk space is too low | HIGH | Available disk space is too low. | last(/FortiGate by SNMP/vfs.fs.pfree)<{$DISK.FREE.CRIT} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| High memory utilization | AVERAGE | The system is running out of free memory. | min(/FortiGate by SNMP/vm.memory.util[memoryUsedPercentage.0],5m)>{$MEMORY.UTIL.MAX} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| No SNMP data collection | WARNING | SNMP is not available for polling. Please check device connectivity and SNMP settings. | max(/FortiGate by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0 | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| CPU discovery | cpu.discovery | Used for discovering CPUs from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| HA member discovery | ha.discovery | Used for discovering HA members from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| Hardware sensors discovery | hw.sensor.discovery | Used for discovering hardware sensors from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| Network interface discovery | net.if.discovery | Used for discovering interfaces from IF-MIB. | DEPENDENT | no lifetime | 0 |
| SD-WAN health-check discovery | sdwan_health.discovery | Used for discovering SD-WAN health-check from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| SoC3 discovery | soc3.discovery | Used for discovering SoC3 NP6Lite processors from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| Virtual domain discovery | vdom.discovery | Used for discovering virtual domains from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| VPN tunnel discovery | vpn.tunnel.discovery | Used for discovering VPN tunnels from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |
| Wireless discovery | wireless.discovery | Used for discovering wireless access points from FORTINET-FORTIGATE-MIB. | DEPENDENT | no lifetime | 0 |


<a name="discovery_cpu_discovery" />

## Discovery CPU discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| CPU Core {#CPU.ID}: Average system usage over 1min | MIB: FORTINET-FORTIGATE-MIB<br>The processor's CPU system space usage, expressed as an average calculated over the last minute.<br>(Only valid for processor types that support this statistic.) | system.cpu.usage[fgProcessorSysUsage.{#SNMPINDEX}] | DEPENDENT |
| CPU Core {#CPU.ID}: Average usage over 1min | MIB: FORTINET-FORTIGATE-MIB<br>The processor's CPU usage in %, expressed as an average calculated over the last minute.<br>(Only valid for processor types that support this statistic.) | system.cpu.usage[fgProcessorUsage.{#SNMPINDEX}] | DEPENDENT |
| CPU Core {#CPU.ID}: Average user usage over 1min | MIB: FORTINET-FORTIGATE-MIB<br>The processor's CPU user space usage, expressed as an average calculated over the last minute.<br>(Only valid for processor types that support this statistic.) | system.cpu.usage[fgProcessorUserUsage.{#SNMPINDEX}] | DEPENDENT |


<a name="discovery_ha_member_discovery" />

## Discovery HA member discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| HA {#HA.ID}: Anti-virus events | MIB: FORTINET-FORTIGATE-MIB<br>Number of anti-virus events triggered on the specified cluster member per second. | ha.av.events[fgHaStatsAvCount.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Bytes processed | MIB: FORTINET-FORTIGATE-MIB<br>Number of bytes processed by the specified cluster member per second. | ha.bytes.rate[fgHaStatsByteCount.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Global checksum | MIB: FORTINET-FORTIGATE-MIB<br>Current HA global checksum value. | ha.checksum.global[fgHaStatsGlobalChecksum.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: CPU usage | MIB: FORTINET-FORTIGATE-MIB<br>CPU usage of the specified cluster member (percentage). | ha.cpu.usage[fgHaStatsCpuUsage.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Hostname | MIB: FORTINET-FORTIGATE-MIB<br>Host name of the specified cluster member. | ha.hostname[fgHaStatsHostname.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: IPS events | MIB: FORTINET-FORTIGATE-MIB<br>Number of IDS/IPS events triggered on the specified cluster member per second. | ha.ips.events[fgHaStatsIdsCount.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Memory usage | MIB: FORTINET-FORTIGATE-MIB<br>Memory usage of the specified cluster member (percentage). | ha.mem.usage[fgHaStatsMemUsage.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Network bandwidth usage | MIB: FORTINET-FORTIGATE-MIB<br>Network bandwidth usage of the specified cluster member (bps). | ha.net.usage[fgHaStatsNetUsage.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Packets processed | MIB: FORTINET-FORTIGATE-MIB<br>Number of packets processed by the specified cluster member per second. | ha.packets.rate[fgHaStatsPktCount.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Primary serial number | MIB: FORTINET-FORTIGATE-MIB<br>Serial number of the primary HA member during the last sync attempt (successful or not). | ha.primary.serialnumber[fgHaStatsMasterSerial.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Serial number | MIB: FORTINET-FORTIGATE-MIB<br>Serial number of the HA cluster member. | ha.serialnumber[fgHaStatsSerial.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Session count | MIB: FORTINET-FORTIGATE-MIB<br>Current session count of the specified cluster member. | ha.session.count[fgHaStatsSesCount.{#SNMPINDEX}] | DEPENDENT |
| HA {#HA.ID}: Sync status | MIB: FORTINET-FORTIGATE-MIB<br>Current HA sync status. | ha.sync.status[fgHaStatsSyncStatus.{#SNMPINDEX}] | DEPENDENT |


<a name="discovery_hardware_sensors_discovery" />

## Discovery Hardware sensors discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Sensor {#SENSOR.NAME}: Alarm status | MIB: FORTINET-FORTIGATE-MIB<br>If the sensor has an alarm threshold and has exceeded it, this will indicate its status. Not all sensors have alarms. | hw.sensor.status[fgHwSensorEntAlarmStatus.{#SENSOR.ID}] | DEPENDENT |
| Sensor {#SENSOR.NAME}: Value | MIB: FORTINET-FORTIGATE-MIB<br>A string representation of the value of the sensor. Because sensors can present data in different formats, string representation is the most general format. Interpretation of the value (units of measure, for example) is dependent on the individual sensor. | hw.sensor.value[fgHwSensorEntValue.{#SENSOR.ID}] | DEPENDENT |


<a name="discovery_network_interface_discovery" />

## Discovery Network interface discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded | MIB: IF-MIB<br>The number of inbound packets which were chosen to be discarded even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.<br>One possible reason for discarding such a packet could be to free up buffer space.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.in.discards[ifInDiscards.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors | MIB: IF-MIB<br>For packet-oriented interfaces - the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.<br>For character-oriented or fixed-length interfaces - the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.in.errors[ifInErrors.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Bits received | MIB: IF-MIB<br>The total number of octets received on the interface, including framing characters. This object is a 64-bit version of `ifInOctets`.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.in[ifHCInOctets.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded | MIB: IF-MIB<br>The number of outbound packets which were chosen to be discarded even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.<br>One possible reason for discarding such a packet could be to free up buffer space.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.out.discards[ifOutDiscards.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors | MIB: IF-MIB<br>For packet-oriented interfaces - the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.<br>For character-oriented or fixed-length interfaces - the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.out.errors[ifOutErrors.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Bits sent | MIB: IF-MIB<br>The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of `ifOutOctets`.<br>Discontinuities in the value of this counter can occur at re-initialization of the management system and at other times as indicated by the value of `ifCounterDiscontinuityTime`. | net.if.out[ifHCOutOctets.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Speed | MIB: IF-MIB<br>An estimate of the interface's current bandwidth in units of 1,000,000 bits per second.<br>If this object reports a value of `n`, then the speed of the interface is somewhere in the range of `n-500,000` to `n+499,999`.<br>For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth.<br>For a sub-layer which has no concept of bandwidth, this object should be zero. | net.if.speed[ifHighSpeed.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Operational status | MIB: IF-MIB<br>The current operational state of the interface.<br>- The `testing(3)` state indicates that no operational packets can be passed.<br>- If `ifAdminStatus` is `down(2)`, then `ifOperStatus` should be `down(2)`.<br>- If `ifAdminStatus` is changed to `up(1)`, then `ifOperStatus` should change to `up(1)` if the interface is ready to transmit and receive network traffic.<br>- It should change to `dormant(5)` if the interface is waiting for external actions (such as a serial line waiting for an incoming connection).<br>- It should remain in the `down(2)` state if and only if there is a fault that prevents it from going to the `up(1)` state.<br>- It should remain in the `notPresent(6)` state if the interface has missing (typically, hardware) components. | net.if.status[ifOperStatus.{#SNMPINDEX}] | DEPENDENT |
| Interface {#IFNAME}({#IFALIAS}): Interface type | MIB: IF-MIB<br>The type of interface.<br>Additional values for `ifType` are assigned by the Internet Assigned Numbers Authority (IANA) through updating the syntax of the IANAifType textual convention. | net.if.type[ifType.{#SNMPINDEX}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Interface {#IFNAME}({#IFALIAS}): Link down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the operations status is down.<br>2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to "1" sometime before.<br><br>WARNING: if closed manually - it will not fire again on the next poll, because of `.diff`. | {$IFCONTROL:"{#IFNAME}"}=1 and last(/FortiGate by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/FortiGate by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |
| Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before | INFO | This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually. | change(/FortiGate by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/FortiGate by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and (<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or<br>last(/FortiGate by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117<br>) and (last(/FortiGate by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2) | [{"tag": "scope", "value": "performance"}] | no url |
| Interface {#IFNAME}({#IFALIAS}): High bandwidth usage | WARNING | The utilization of the network interface is close to its estimated maximum bandwidth. | (avg(/FortiGate by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/FortiGate by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or <br>avg(/FortiGate by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/FortiGate by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and <br>last(/FortiGate by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 | [{"tag": "scope", "value": "performance"}] | no url |
| Interface {#IFNAME}({#IFALIAS}): High error rate | WARNING | The trigger recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold. | min(/FortiGate by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}<br>or min(/FortiGate by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"} | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_sd-wan_health-check_discovery" />

## Discovery SD-WAN health-check discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Jitter | MIB: FORTINET-FORTIGATE-MIB<br>The average jitter of a health check on a specific member link in a float number within the last 30 probes. | sdwan_health.jitter[fgVWLHealthCheckLinkJitter.{#SNMPINDEX}] | DEPENDENT |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Latency | MIB: FORTINET-FORTIGATE-MIB<br>The average latency of a health check on a specific member link in a float number within the last 30 probes. | sdwan_health.latency[fgVWLHealthCheckLinkLatency.{#SNMPINDEX}] | DEPENDENT |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets loss | MIB: FORTINET-FORTIGATE-MIB<br>The packet loss percentage of a health check on a specific member link in a float number within the last 30 probes. | sdwan_health.loss[fgVWLHealthCheckLinkPacketLoss.{#SNMPINDEX}] | DEPENDENT |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets received per second | MIB: FORTINET-FORTIGATE-MIB<br>Number of packets received by a health check on a specific member link per second. | sdwan_health.received[fgVWLHealthCheckLinkPacketRecv.{#SNMPINDEX}] | DEPENDENT |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets sent per second | MIB: FORTINET-FORTIGATE-MIB<br>Number of packets sent by a health check on a specific member link per second. | sdwan_health.sent[fgVWLHealthCheckLinkPacketSend.{#SNMPINDEX}] | DEPENDENT |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Health check state | MIB: FORTINET-FORTIGATE-MIB<br>Health check state on a specific member link. | sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: High packets loss | WARNING | High level of packet loss detected. | min(/FortiGate by SNMP/sdwan_health.loss[fgVWLHealthCheckLinkPacketLoss.{#SNMPINDEX}],5m)>{$SDWAN.HEALTH.IF.LOSS.WARN:"{#HNAME}"} | [{"tag": "scope", "value": "performance"}] | no url |
| SD-WAN [{#HNAME}]:[{#IFNAME}]: Health check state is dead | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the health check state is dead.<br>2. `{$SDWAN.HEALTH.IF.CONTROL:"{#HNAME}"}=1` - a user can redefine the context macro to "0", marking this health check as not important. No new trigger will be fired if this health check is dead.<br>3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the health check state was up to "1" sometime before.<br><br>WARNING: If closed manually, it will not fire again on the next poll because of `diff`. | {$SDWAN.HEALTH.IF.CONTROL:"{#HNAME}"}=1 and last(/FortiGate by SNMP/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}])=1 and (last(/FortiGate by SNMP/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discovery_soc3_discovery" />

## Discovery SoC3 discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| SoC3 {#CPU.ID}: Packets dropped | MIB: FORTINET-FORTIGATE-MIB<br>The total number of packets dropped by this processor (only valid for processor types that support this statistic). | soc3.np6lite.pkt.dropped[fgProcessorPktDroppedCount.{#CPU.ID}] | DEPENDENT |
| SoC3 {#CPU.ID}: Packets received | MIB: FORTINET-FORTIGATE-MIB<br>The total number of packets received by this processor (only valid for processor types that support this statistic). | soc3.np6lite.pkt.received[fgProcessorPktRxCount.{#CPU.ID}] | DEPENDENT |
| SoC3 {#CPU.ID}: Packets transmitted | MIB: FORTINET-FORTIGATE-MIB<br>The total number of packets transmitted by this processor (only valid for processor types that support this statistic). | soc3.np6lite.pkt.transmitted[fgProcessorPktRxCount.{#CPU.ID}] | DEPENDENT |


<a name="discovery_virtual_domain_discovery" />

## Discovery Virtual domain discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| VDOM {#VDOM.NAME}: CPU usage | MIB: FORTINET-FORTIGATE-MIB<br>CPU usage of the virtual domain (percentage). | vdom.cpu.usage[fgVdEntCpuUsage.{#SNMPINDEX}] | DEPENDENT |
| VDOM {#VDOM.NAME}: HA member state | MIB: FORTINET-FORTIGATE-MIB<br>HA cluster member state of the virtual domain on this device. | vdom.ha.state[fgVdEntHaState.{#SNMPINDEX}] | DEPENDENT |
| VDOM {#VDOM.NAME}: Memory usage | MIB: FORTINET-FORTIGATE-MIB<br>Memory usage of the virtual domain (percentage). | vdom.mem.usage[fgVdEntCpuUsage.{#SNMPINDEX}] | DEPENDENT |
| VDOM {#VDOM.NAME}: Operation mode | MIB: FORTINET-FORTIGATE-MIB<br>Operation mode of the virtual domain (NAT or Transparent). | vdom.op_mode[fgVdEntOpMode.{#SNMPINDEX}] | DEPENDENT |
| VDOM {#VDOM.NAME}: Sessions rate | MIB: FORTINET-FORTIGATE-MIB<br>The session setup rate on the virtual domain per second. | vdom.sessions.rate[fgVdEntSesRate.{#SNMPINDEX}] | DEPENDENT |
| VDOM {#VDOM.NAME}: Active sessions | MIB: FORTINET-FORTIGATE-MIB<br>Number of active sessions on the virtual domain. | vdom.sessions[fgVdEntSesCount.{#SNMPINDEX}] | DEPENDENT |


<a name="discovery_vpn_tunnel_discovery" />

## Discovery VPN tunnel discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| VPN {#VPN.NAME}: Tunnel Status | MIB: FORTINET-FORTIGATE-MIB<br>Current status of tunnel (up or down). | vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| VPN {#VPN.NAME}: Tunnel down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the current tunnel state is down.<br>2. `{$VPN.STATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if this tunnel is down. | {$VPN.STATE.CONTROL:"{#VPN.NAME}"}=1 and last(/FortiGate by SNMP/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}])=1 and (last(/FortiGate by SNMP/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discovery_wireless_discovery" />

## Discovery Wireless discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| WTP {#WC.NAME}: Administrative status | MIB: FORTINET-FORTIGATE-MIB<br>Represents the administrative status of this wireless termination point (WTP).<br><br>The following enumerated values are supported:<br>`discovered(1)` - This WTP was discovered though discovery or join request messages.<br>`disable(2)` - Controller is configured to not provide service to this WTP.<br>`enable(3)` - Controller is configured to provide service to this WTP.<br>`other(0)` - The administration state of the WTP is unknown. | wc.admin.status[fgWcWtpConfigWtpAdmin.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Background scan | MIB: FORTINET-FORTIGATE-MIB<br>Whether background scan is enabled on this WTP. | wc.background.scan[fgWcWtpConfigRadioApScan.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Base MAC Address | MIB: FORTINET-FORTIGATE-MIB<br>Represents the WTP's Base MAC Address, which MAY be assigned to the primary Ethernet interface.<br>The instance of the object corresponds to the Base MAC Address sub-element in the CAPWAP protocol [RFC5415]. | wc.base.mac[fgWcWtpSessionWtpBaseMacAddress.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Bootloader version | MIB: FORTINET-FORTIGATE-MIB<br>Represents the boot loader version of a WTP. | wc.boot.version[fgWcWtpSessionWtpBootVersion.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Connected clients | MIB: FORTINET-FORTIGATE-MIB<br>Represents the number of clients currently connected to this WTP. | wc.clients.num[fgWcWtpSessionWtpStationCount.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Connection status | MIB: FORTINET-FORTIGATE-MIB<br>Represents the connection status of a WTP to the AC.<br><br>The following enumerated values are supported:<br>`offLine(1)` - The WTP is not connected.<br>`onLine(2)` - The WTP is connected.<br>`downloadingImage(3)` - The WTP is downloading software image from the AC on joining.<br>`connectedImage(4)` - The AC is pushing a software image to the connected WTP.<br>`other(0)` - The WTP connection status is unknown. | wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: CPU usage | MIB: FORTINET-FORTIGATE-MIB<br>Represents the current CPU usage of a WTP (percentage). | wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Daemon uptime | MIB: FORTINET-FORTIGATE-MIB<br>Represents the time since the WTP daemon has been started. | wc.daemon.uptime[fgWcWtpSessionWtpDaemonUpTime.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Hardware version | MIB: FORTINET-FORTIGATE-MIB<br>Represents the hardware version of a WTP. | wc.hardware.version[fgWcWtpSessionWtpHwVersion.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: IP Address | MIB: FORTINET-FORTIGATE-MIB<br>Represents the IP address of a WTP that corresponds to the IP address in the IP packet header. | wc.ip.addr[fgWcWtpSessionWtpIpAddress.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: IP Address type | MIB: FORTINET-FORTIGATE-MIB<br>Represents the IP address type of a WTP. | wc.ip.type[fgWcWtpSessionWtpIpAddressType.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Local IP Address | MIB: FORTINET-FORTIGATE-MIB<br>Represents the local IP address of a WTP and models the CAPWAP Local IPv4 Address or CAPWAP Local IPv6 Address fields [RFC5415].<br>If a Network Address Translation (NAT) device is present between the WTP and access controller (AC), the value of `fgWcWtpWtpLocalIpAddress` will be different from the value of `fgWcWtpWtpIpAddress`. | wc.local_ip.addr[fgWcWtpSessionWtpLocalIpAddress.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Local IP Address type | MIB: FORTINET-FORTIGATE-MIB<br>Represents the local IP address type of a WTP. | wc.local_ip.type[fgWcWtpSessionWtpLocalIpAddressType.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Location | MIB: FORTINET-FORTIGATE-MIB<br>Represents the location of this WTP. | wc.location[fgWcWtpConfigWtpLocation.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Memory capacity | MIB: FORTINET-FORTIGATE-MIB<br>Represents the total physical memory (RAM) installed. | wc.mem.size[fgWcWtpSessionWtpMemoryCapacity.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Memory usage | MIB: FORTINET-FORTIGATE-MIB<br>Represents the current memory usage of a WTP (percentage). | wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Model number | MIB: FORTINET-FORTIGATE-MIB<br>Represents the model number of a WTP. | wc.model[fgWcWtpSessionWtpModelNumber.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Profile name | MIB: FORTINET-FORTIGATE-MIB<br>Represents the profile configured for this WTP. | wc.profile[fgWcWtpConfigWtpProfile.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio ATPC high limit | MIB: FORTINET-FORTIGATE-MIB<br>Represents the high limit of radio automatic TX power control configured for this WTP, in dBm. | wc.radio.atpc.high_limit[fgWcWtpConfigRadioAutoTxPowerHigh.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio ATPC low limit | MIB: FORTINET-FORTIGATE-MIB<br>Represents the low limit of radio automatic TX power control configured for this WTP, in dBm. | wc.radio.atpc.low_limit[fgWcWtpConfigRadioAutoTxPowerLow.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio ATPC status | MIB: FORTINET-FORTIGATE-MIB<br>Whether radio automatic TX power control is enabled on this WTP. | wc.radio.atpc.status[fgWcWtpConfigRadioAutoTxPowerControl.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio band | MIB: FORTINET-FORTIGATE-MIB<br>Represents the radio band configured for this WTP. | wc.radio.band[fgWcWtpConfigRadioBand.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio enabled | MIB: FORTINET-FORTIGATE-MIB<br>Whether radio is enabled for this WTP. | wc.radio.enabled[fgWcWtpConfigRadioEnable.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Radio TX power level | MIB: FORTINET-FORTIGATE-MIB<br>Represents the radio TX power setting configured for this WTP, expressed in %. | wc.radio.power_level[fgWcWtpConfigRadioTxPowerLevel.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Bits received | MIB: FORTINET-FORTIGATE-MIB<br>Represents the number of bits received by this WTP per second. | wc.rate.in[fgWcWtpSessionWtpByteRxCount.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Bits sent | MIB: FORTINET-FORTIGATE-MIB<br>Represents the number of bits transmitted by this WTP per second. | wc.rate.out[fgWcWtpSessionWtpByteTxCount.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Region code | MIB: FORTINET-FORTIGATE-MIB<br>Represents the region code programmed for this WTP. | wc.region_code[fgWcWtpSessionWtpRegionCode.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Session uptime | MIB: FORTINET-FORTIGATE-MIB<br>Represents the time since the WTP has been connected to the AC. | wc.session.uptime[fgWcWtpSessionWtpSessionUpTime.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Software version | MIB: FORTINET-FORTIGATE-MIB<br>Represents the software version of a WTP. | wc.software.version[fgWcWtpSessionWtpSwVersion.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: Uptime | MIB: FORTINET-FORTIGATE-MIB<br>Represents the time since the WTP has booted. | wc.uptime[fgWcWtpSessionWtpUpTime.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: All VAPs selected | MIB: FORTINET-FORTIGATE-MIB<br>Whether all wireless virtual access points (VAP) are selected for this WTP. | wc.vaps.all[fgWcWtpConfigVapAll.{#SNMPINDEX}] | DEPENDENT |
| WTP {#WC.NAME}: VAPs list | MIB: FORTINET-FORTIGATE-MIB<br>Represents a list of wireless virtual access points (VAP) configured for this WTP. | wc.vaps.list[fgWcWtpConfigVaps.{#SNMPINDEX}] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| WTP {#WC.NAME}: Connection is down | HIGH | This trigger expression works as follows:<br>1. It can be triggered if the current connection status is `offLine`.<br>2. `{$WC.STATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if this connection is down. | {$WC.STATE.CONTROL:"{#WC.NAME}"}=1 and last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=1 and (last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "availability"}] | no url |
| WTP {#WC.NAME}: Receiving firmware update | INFO | This trigger expression works as follows:<br>1. It can be triggered if the current connection status is `downloadingImage`.<br>2. `{$WC.UPDATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if the status is `downloadingImage`. | {$WC.UPDATE.CONTROL:"{#WC.NAME}"}=1 and last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=3 and (last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "notice"}] | no url |
| WTP {#WC.NAME}: Sending firmware update | INFO | This trigger expression works as follows:<br>1. It can be triggered if the current connection status is `connectedImage`.<br>2. `{$WC.UPDATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if the status is `connectedImage`. | {$WC.UPDATE.CONTROL:"{#WC.NAME}"}=1 and last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=4 and (last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/FortiGate by SNMP/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2)) | [{"tag": "scope", "value": "notice"}] | no url |
| WTP {#WC.NAME}: High CPU utilization | WARNING | The CPU utilization is too high. | min(/FortiGate by SNMP/wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}],5m)>{$WC.CPU.UTIL.CRIT:"{#WC.NAME}"} | [{"tag": "scope", "value": "performance"}] | no url |
| WTP {#WC.NAME}: High memory utilization | WARNING | The WTP is running out of free memory. | min(/FortiGate by SNMP/wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}],5m)>{$WC.MEMORY.UTIL.MAX:"{#WC.NAME}"} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |
| WTP {#WC.NAME}: Session has been restarted | INFO | Uptime is less than 10 minutes. | last(/FortiGate by SNMP/wc.session.uptime[fgWcWtpSessionWtpSessionUpTime.{#SNMPINDEX}])<10m | [{"tag": "scope", "value": "notice"}] | no url |

