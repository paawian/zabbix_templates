# Morningstar TriStar MPPT by SNMP template description

MIBs used:
TRISTAR-MPPT

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery Battery voltage discovery ](#discovery_battery_voltage_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Array: Array Current | MIB: TRISTAR-MPPT<br>Description:Array Current<br>Scaling Factor:0.00244140625<br>Units:A<br>Range:[-10, 80]<br>Modbus address:0x001d | array.current[arrayCurrent.0] | SNMP_AGENT | no delay |
| Array: Sweep Pmax | MIB: TRISTAR-MPPT<br>Description:Pmax (last sweep)<br>Scaling Factor:0.10986328125<br>Units:W<br>Range:[-10, 5000]<br>Modbus address:0x003c | array.sweep_pmax[arrayPmaxLastSweep.0] | SNMP_AGENT | no delay |
| Array: Sweep Vmp | MIB: TRISTAR-MPPT<br>Description:Vmp (last sweep)<br>Scaling Factor:0.0054931640625<br>Units:V<br>Range:[-10, 180.0]<br>Modbus address:0x003d | array.sweep_vmp[arrayVmpLastSweep.0] | SNMP_AGENT | no delay |
| Array: Sweep Voc | MIB: TRISTAR-MPPT<br>Description:Voc (last sweep)<br>Scaling Factor:0.0054931640625<br>Units:V<br>Range:[-10, 180.0]<br>Modbus address:0x003e | array.sweep_voc[arrayVocLastSweep.0] | SNMP_AGENT | no delay |
| Array: Voltage | MIB: TRISTAR-MPPT<br>Description:Array Voltage<br>Scaling Factor:0.0054931640625<br>Units:V<br>Range:[-10, 180]<br>Modbus address:0x001b | array.voltage[arrayVoltage.0] | SNMP_AGENT | no delay |
| Battery: Battery Voltage discovery | MIB: TRISTAR-MPPT | battery.voltage.discovery[batteryVoltage.0] | SNMP_AGENT | 15m |
| Battery: Charge Current | MIB: TRISTAR-MPPT<br>Description:Battery Current<br>Scaling Factor:0.00244140625<br>Units:A<br>Range:[-10, 80]<br>Modbus address:0x001c | charge.current[batteryCurrent.0] | SNMP_AGENT | no delay |
| Battery: Output Power | MIB: TRISTAR-MPPT<br>Description:Output Power<br>Scaling Factor:0.10986328125<br>Units:W<br>Range:[-10, 5000]<br>Modbus address:0x003a | charge.output_power[ outputPower.0] | SNMP_AGENT | no delay |
| Battery: Charge State | MIB: TRISTAR-MPPT<br>Description:Charge State<br>Modbus address:0x0032<br><br>0: Start<br>1: NightCheck<br>2: Disconnect<br>3: Night<br>4: Fault<br>5: Mppt<br>6: Absorption<br>7: Float<br>8: Equalize<br>9: Slave | charge.state[chargeState.0] | SNMP_AGENT | no delay |
| Counter: Charge Amp-hours | MIB: TRISTAR-MPPT<br>Description:Ah Charge Resettable<br>Scaling Factor:0.1<br>Units:Ah<br>Range:[0.0, 5000]<br>Modbus addresses:H=0x0034 L=0x0035 | counter.charge_amp_hours[ahChargeResetable.0] | SNMP_AGENT | no delay |
| Counter: Charge KW-hours | MIB: TRISTAR-MPPT<br>Description:kWh Charge Resettable<br>Scaling Factor:0.1<br>Units:kWh<br>Range:[0.0, 65535.0]<br>Modbus address:0x0038 | counter.charge_kw_hours[kwhChargeResetable.0] | SNMP_AGENT | no delay |
| Status: Alarms | MIB: TRISTAR-MPPT<br>Description:Faults<br>Modbus address:0x002c | status.alarms[alarms.0] | SNMP_AGENT | no delay |
| Status: Faults | MIB: TRISTAR-MPPT<br>Description:Faults<br>Modbus address:0x002c | status.faults[faults.0] | SNMP_AGENT | no delay |
| Status: Uptime (hardware) | The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system. | status.hw.uptime | SNMP_AGENT | no delay |
| Status: Uptime (network) | The time (in hundredths of a second) since the network management portion of the system was last re-initialized. | status.net.uptime | SNMP_AGENT | no delay |
| Battery: Target Voltage | MIB: TRISTAR-MPPT<br>Description:Target Voltage<br>Scaling Factor:0.0054931640625<br>Units:V<br>Range:[-10, 180.0]<br>Modbus address:0x0033 | target.voltage[targetRegulationVoltage.0] | SNMP_AGENT | no delay |
| Temperature: Battery | MIB: TRISTAR-MPPT<br>Description:Batt. Temp<br>Scaling Factor:1.0<br>Units:C<br>Range:[-40, 80]<br>Modbus address:0x0025 | temp.battery[batteryTemperature.0] | SNMP_AGENT | no delay |
| Temperature: Heatsink | MIB: TRISTAR-MPPT<br>Description:HS Temp<br>Scaling Factor:1.0<br>Units:C<br>Range:[-40, 80]<br>Modbus address:0x0023 | temp.heatsink[heatsinkTemperature.0] | SNMP_AGENT | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$BATTERY.TEMP.MAX.CRIT} | 60 |
| {$BATTERY.TEMP.MAX.WARN} | 45 |
| {$BATTERY.TEMP.MIN.CRIT} | -20 |
| {$BATTERY.TEMP.MIN.WARN} | 0 |
| {$CHARGE.STATE.CRIT} | 4 |
| {$CHARGE.STATE.WARN} | 2 |
| {$LOAD.STATE.CRIT:"fault"} | 4 |
| {$LOAD.STATE.CRIT:"lvd"} | 3 |
| {$LOAD.STATE.WARN:"disconnect"} | 5 |
| {$LOAD.STATE.WARN:"lvdWarning"} | 2 |
| {$LOAD.STATE.WARN:"override"} | 7 |
| {$VOLTAGE.MAX.CRIT} | no value |
| {$VOLTAGE.MAX.WARN} | no value |
| {$VOLTAGE.MIN.CRIT} | no value |
| {$VOLTAGE.MIN.WARN} | no value |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Battery: Device charge in critical state | HIGH | no description | last(/Morningstar TriStar MPPT by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT} | [{"tag": "scope", "value": "notice"}] | no url |
| Battery: Device charge in warning state | WARNING | no description | last(/Morningstar TriStar MPPT by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.WARN} | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "batterySense" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","batterySense")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "batterySenseDisconnected" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","batterySenseDisconnected")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "controllerWasReset" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","controllerWasReset")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "currentLimit" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","currentLimit")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "currentOffset" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","currentOffset")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "heatsinkTempSensorOpen" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","heatsinkTempSensorOpen")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "heatsinkTempSensorShorted" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","heatsinkTempSensorShorted")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "highArrayVCurrentLimit" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","highArrayVCurrentLimit")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "highTemperatureCurrentLimit" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","highTemperatureCurrentLimit")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "highVoltageDisconnect" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","highVoltageDisconnect")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "maxAdcValueReached" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","maxAdcValueReached")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "mosfetSOpen" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","mosfetSOpen")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "p12VoltageReferenceOff" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","p12VoltageReferenceOff")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "rtsDisconnected" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","rtsDisconnected")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "rtsMiswire" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","rtsMiswire")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "rtsShorted" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","rtsShorted")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "systemMiswire" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","systemMiswire")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "uncalibrated" alarm flag | WARNING | no description | count(/Morningstar TriStar MPPT by SNMP/status.alarms[alarms.0],#3,"like","uncalibrated")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "arrayHvd" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","arrayHvd")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "batteryHvd" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","batteryHvd")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "customSettingsEdit" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","customSettingsEdit")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "dipSwitchChange" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","dipSwitchChange")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "eepromRetryLimit" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","eepromRetryLimit")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "fetShort" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","fetShort")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "overcurrent" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","overcurrent")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "rtsDisconnected" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","rtsDisconnected")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "rtsShorted" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","rtsShorted")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "slaveControlTimeout" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","slaveControlTimeout")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has "softwareFault" faults flag | HIGH | no description | count(/Morningstar TriStar MPPT by SNMP/status.faults[faults.0],#3,"like","softwareFault")=2 | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Failed to fetch data | WARNING | Zabbix has not received data for items for the last 5 minutes. | nodata(/Morningstar TriStar MPPT by SNMP/status.net.uptime,5m)=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Temperature: Critically high battery temperature | HIGH | no description | min(/Morningstar TriStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)>{$BATTERY.TEMP.MAX.CRIT} | [{"tag": "scope", "value": "notice"}] | no url |
| Temperature: Critically low battery temperature | HIGH | no description | max(/Morningstar TriStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)<{$BATTERY.TEMP.MIN.CRIT} | [{"tag": "scope", "value": "notice"}] | no url |
| Temperature: High battery temperature | WARNING | no description | min(/Morningstar TriStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)>{$BATTERY.TEMP.MAX.WARN} | [{"tag": "scope", "value": "notice"}] | no url |
| Temperature: Low battery temperature | WARNING | no description | max(/Morningstar TriStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)<{$BATTERY.TEMP.MIN.WARN} | [{"tag": "scope", "value": "notice"}] | no url |
| Status: Device has been restarted | INFO | Uptime is less than 10 minutes. | (last(/Morningstar TriStar MPPT by SNMP/status.hw.uptime)>0 and last(/Morningstar TriStar MPPT by SNMP/status.hw.uptime)<10m) or (last(/Morningstar TriStar MPPT by SNMP/status.hw.uptime)=0 and last(/Morningstar TriStar MPPT by SNMP/status.net.uptime)<10m) | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Battery voltage discovery | battery.voltage.discovery | Discovery for battery voltage triggers | DEPENDENT | no lifetime | 0 |


<a name="discovery_battery_voltage_discovery"></a>

## Discovery Battery voltage discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Battery: Voltage{#SINGLETON} | MIB: TRISTAR-MPPT<br>Description:Battery voltage<br>Scaling Factor:0.0054931640625<br>Units:V<br>Range:[-10, 180.0]<br>Modbus address:0x0018 | battery.voltage[batteryVoltage.0{#SINGLETON}] | SNMP_AGENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Battery: Critically high battery voltage | HIGH | no description | min(/Morningstar TriStar MPPT by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)>{#VOLTAGE.MAX.CRIT} | [{"tag": "scope", "value": "capacity"}] | no url |
| Battery: Critically low battery voltage | HIGH | no description | max(/Morningstar TriStar MPPT by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)<{#VOLTAGE.MIN.CRIT} | [{"tag": "scope", "value": "capacity"}] | no url |
| Battery: High battery voltage | WARNING | no description | min(/Morningstar TriStar MPPT by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)>{#VOLTAGE.MAX.WARN} | [{"tag": "scope", "value": "capacity"}] | no url |
| Battery: Low battery voltage | WARNING | no description | max(/Morningstar TriStar MPPT by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)<{#VOLTAGE.MIN.WARN} | [{"tag": "scope", "value": "capacity"}] | no url |

