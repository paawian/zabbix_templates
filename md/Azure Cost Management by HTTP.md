# Azure Cost Management by HTTP template description

This template is designed to monitor Microsoft Cost Management by HTTP.
It works without any external scripts and uses the script item.

Setup:
  1. Create an Azure service principal via the Azure command-line interface (Azure CLI) for your subscription.
    `az ad sp create-for-rbac --name zabbix --role reader --scope /subscriptions/<subscription_id>`
    See https://docs.microsoft.com/en-us/cli/azure/create-an-azure-service-principal-azure-cli for more details.
  2. Link the template to a host.
  3. Configure the macros: {$AZURE.APP.ID}, {$AZURE.PASSWORD}, {$AZURE.TENANT.ID}, {$AZURE.SUBSCRIPTION.ID}.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [discoveries](#discoveries)
  * [Discovery Azure daily costs by services discovery ](#discovery_azure_daily_costs_by_services_discovery)
  * [Discovery Azure monthly costs discovery ](#discovery_azure_monthly_costs_discovery)
  * [Discovery Azure monthly costs by location discovery ](#discovery_azure_monthly_costs_by_location_discovery)
  * [Discovery Azure monthly costs by resource group discovery ](#discovery_azure_monthly_costs_by_resource_group_discovery)
  * [Discovery Azure monthly costs by services discovery ](#discovery_azure_monthly_costs_by_services_discovery)

<a name="items" />

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Get daily costs | The result of API requests is expressed in the JSON. | azure.get.daily.costs | SCRIPT | 0s;h/5m/30 |
| Get monthly costs | The result of API requests is expressed in the JSON. | azure.get.monthly.costs | SCRIPT | 0s;h/12 |


<a name="macros" />

## Macros
| macro | value |
| ------------- |------------- |
| {$AZURE.APP.ID} | no value |
| {$AZURE.BILLING.MONTH} | 11 |
| {$AZURE.DATA.TIMEOUT} | 60s |
| {$AZURE.LLD.FILTER.RESOURCE.GROUP.MATCHES} | .* |
| {$AZURE.LLD.FILTER.RESOURCE.GROUP.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$AZURE.LLD.FILTER.RESOURCE.LOCATION.MATCHES} | .* |
| {$AZURE.LLD.FILTER.RESOURCE.LOCATION.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$AZURE.LLD.FILTER.SERVICE.MATCHES} | .* |
| {$AZURE.LLD.FILTER.SERVICE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$AZURE.PASSWORD} | no value |
| {$AZURE.PROXY} | no value |
| {$AZURE.TENANT.ID} | no value |


<a name="discoveries" />

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Azure daily costs by services discovery | azure.daily.services.costs.discovery | Discovery of daily costs by services. | DEPENDENT | no lifetime | 0 |
| Azure monthly costs discovery | azure.monthly.costs.discovery | Discovery of monthly costs. | DEPENDENT | no lifetime | 0 |
| Azure monthly costs by location discovery | azure.monthly.location.costs.discovery | Discovery of monthly costs by location. | DEPENDENT | no lifetime | 0 |
| Azure monthly costs by resource group discovery | azure.monthly.resource.group.costs.discovery | Discovery of monthly costs by resource group. | DEPENDENT | no lifetime | 0 |
| Azure monthly costs by services discovery | azure.monthly.services.costs.discovery | Discovery of monthly costs by services. | DEPENDENT | no lifetime | 0 |


<a name="discovery_azure_daily_costs_by_services_discovery" />

## Discovery Azure daily costs by services discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Service ["{#AZURE.SERVICE.NAME}"]: Meter ["{#AZURE.BILLING.METER}"]: Subcategory ["{#AZURE.BILLING.METER.SUBCATEGORY}"] daily cost | The daily cost by service {#AZURE.SERVICE.NAME}, meter {#AZURE.BILLING.METER}, subcategory {#AZURE.BILLING.METER.SUBCATEGORY}. | azure.daily.cost["{#AZURE.SERVICE.NAME}", "{#AZURE.BILLING.METER}", "{#AZURE.BILLING.METER.SUBCATEGORY}","{#AZURE.RESOURCE.GROUP}"] | DEPENDENT |


<a name="discovery_azure_monthly_costs_discovery" />

## Discovery Azure monthly costs discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Month ["{#AZURE.BILLING.MONTH}"] cost | The monthly cost. | azure.monthly.cost["{#AZURE.BILLING.MONTH}"] | DEPENDENT |


<a name="discovery_azure_monthly_costs_by_location_discovery" />

## Discovery Azure monthly costs by location discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Location: ["{#AZURE.RESOURCE.LOCATION}"]: Month ["{#AZURE.BILLING.MONTH}"] cost | The monthly cost by location {#AZURE.RESOURCE.LOCATION}. | azure.monthly.location.cost["{#AZURE.RESOURCE.LOCATION}", "{#AZURE.BILLING.MONTH}"] | DEPENDENT |


<a name="discovery_azure_monthly_costs_by_resource_group_discovery" />

## Discovery Azure monthly costs by resource group discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Resource group: ["{#AZURE.RESOURCE.GROUP}"]: Month ["{#AZURE.BILLING.MONTH}"] cost | The monthly cost by resource group {#AZURE.RESOURCE.GROUP}. | azure.monthly.resource.group.cost["{#AZURE.RESOURCE.GROUP}", "{#AZURE.BILLING.MONTH}"] | DEPENDENT |


<a name="discovery_azure_monthly_costs_by_services_discovery" />

## Discovery Azure monthly costs by services discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Service ["{#AZURE.SERVICE.NAME}"]: Month ["{#AZURE.BILLING.MONTH}"] cost | The monthly cost by service {#AZURE.SERVICE.NAME}. | azure.monthly.service.cost["{#AZURE.SERVICE.NAME}", "{#AZURE.BILLING.MONTH}"] | DEPENDENT |

