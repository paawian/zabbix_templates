# HPE Primera by HTTP template description

The template to monitor HPE Primera by HTTP.
It works without any external scripts and uses the script item.

Setup:
  1. Create a user on the storage with a browse role and enable it for all domains, for example "zabbix".
  2. The WSAPI server does not start automatically.
     - Log in to the CLI as Super, Service, or any role granted the wsapi_set right.
     - Start the WSAPI server by command: `startwsapi`.
     - To check WSAPI state use command: `showwsapi`.
  3. Link template to the host.
  4. Set the hostname or IP address of the host in the {$HPE.PRIMERA.API.HOST} macro and configure the username and password in the {$HPE.PRIMERA.API.USERNAME} and {$HPE.PRIMERA.API.PASSWORD} macros.
  5. Change the {$HPE.PRIMERA.API.SCHEME} and {$HPE.PRIMERA.API.PORT} macros if needed.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery Common provisioning groups discovery ](#discovery_common_provisioning_groups_discovery)
  * [Discovery Disks discovery ](#discovery_disks_discovery)
  * [Discovery Hosts discovery ](#discovery_hosts_discovery)
  * [Discovery Ports discovery ](#discovery_ports_discovery)
  * [Discovery Tasks discovery ](#discovery_tasks_discovery)
  * [Discovery Volumes discovery ](#discovery_volumes_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Disks total | Number of physical disks. | hpe.primera.disks.total | DEPENDENT | 0 |
| Get CPGs data | Common provisioning groups data. | hpe.primera.get.cpgs | DEPENDENT | 0 |
| Get data | The JSON with result of WSAPI requests. | hpe.primera.get.data | SCRIPT | no delay |
| Get disks data | Disks data. | hpe.primera.get.disks | DEPENDENT | 0 |
| Get errors | A list of errors from WSAPI requests. | hpe.primera.get.errors | DEPENDENT | 0 |
| Get hosts data | Hosts data. | hpe.primera.get.hosts | DEPENDENT | 0 |
| Get ports data | Ports data. | hpe.primera.get.ports | DEPENDENT | 0 |
| Get system data | System data. | hpe.primera.get.system | DEPENDENT | 0 |
| Get tasks data | Tasks data. | hpe.primera.get.tasks | DEPENDENT | 0 |
| Get volumes data | Volumes data. | hpe.primera.get.volumes | DEPENDENT | 0 |
| Capacity allocated | Allocated capacity in the system. | hpe.primera.system.capacity.allocated | DEPENDENT | 0 |
| Capacity failed | Failed capacity in the system. | hpe.primera.system.capacity.failed | DEPENDENT | 0 |
| Capacity free | Free capacity in the system. | hpe.primera.system.capacity.free | DEPENDENT | 0 |
| Capacity total | Total capacity in the system. | hpe.primera.system.capacity.total | DEPENDENT | 0 |
| Chunklet size | Chunklet size. | hpe.primera.system.chunklet.size | DEPENDENT | 0 |
| System contact | Contact of the system. | hpe.primera.system.contact | DEPENDENT | 0 |
| System location | Location of the system. | hpe.primera.system.location | DEPENDENT | 0 |
| Model | System model. | hpe.primera.system.model | DEPENDENT | 0 |
| System name | System name. | hpe.primera.system.name | DEPENDENT | 0 |
| Nodes online | Number of online nodes in the system. | hpe.primera.system.nodes.online | DEPENDENT | 0 |
| Nodes total | Total number of nodes in the system. | hpe.primera.system.nodes.total | DEPENDENT | 0 |
| Serial number | System serial number. | hpe.primera.system.serial_number | DEPENDENT | 0 |
| Software version number | Storage system software version number. | hpe.primera.system.sw_version | DEPENDENT | 0 |
| Service ping | Checks if the service is running and accepting TCP connections. | net.tcp.service["{$HPE.PRIMERA.API.SCHEME}","{$HPE.PRIMERA.API.HOST}","{$HPE.PRIMERA.API.PORT}"] | SIMPLE | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$HPE.PRIMERA.API.HOST} | <SET API HOST> |
| {$HPE.PRIMERA.API.PASSWORD} | no value |
| {$HPE.PRIMERA.API.PORT} | 443 |
| {$HPE.PRIMERA.API.SCHEME} | https |
| {$HPE.PRIMERA.API.USERNAME} | zabbix |
| {$HPE.PRIMERA.CPG.NAME.MATCHES} | .* |
| {$HPE.PRIMERA.CPG.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$HPE.PRIMERA.DATA.TIMEOUT} | 15s |
| {$HPE.PRIMERA.LLD.FILTER.TASK.NAME.MATCHES} | CHANGE_IF_NEEDED |
| {$HPE.PRIMERA.LLD.FILTER.TASK.NAME.NOT_MATCHES} | .* |
| {$HPE.PRIMERA.LLD.FILTER.TASK.TYPE.MATCHES} | .* |
| {$HPE.PRIMERA.LLD.FILTER.TASK.TYPE.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$HPE.PRIMERA.VOLUME.NAME.MATCHES} | .* |
| {$HPE.PRIMERA.VOLUME.NAME.NOT_MATCHES} | ^(admin\|.srdata\|.mgmtdata)$ |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| There are errors in requests to WSAPI | AVERAGE | Zabbix has received errors in requests to WSAPI. | length(last(/HPE Primera by HTTP/hpe.primera.get.errors))>0 | [{"tag": "scope", "value": "availability"}] | no url |
| Service is unavailable | HIGH | no description | max(/HPE Primera by HTTP/net.tcp.service["{$HPE.PRIMERA.API.SCHEME}","{$HPE.PRIMERA.API.HOST}","{$HPE.PRIMERA.API.PORT}"],5m)=0 | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Common provisioning groups discovery | hpe.primera.cpg.discovery | List of CPGs resources. | DEPENDENT | no lifetime | 0 |
| Disks discovery | hpe.primera.disks.discovery | List of physical disk resources. | DEPENDENT | no lifetime | 0 |
| Hosts discovery | hpe.primera.hosts.discovery | List of host properties. | DEPENDENT | no lifetime | 0 |
| Ports discovery | hpe.primera.ports.discovery | List of ports. | DEPENDENT | no lifetime | 0 |
| Tasks discovery | hpe.primera.tasks.discovery | List of tasks started within last 24 hours. | DEPENDENT | 1d | 0 |
| Volumes discovery | hpe.primera.volumes.discovery | List of storage volume resources. | DEPENDENT | no lifetime | 0 |


<a name="discovery_common_provisioning_groups_discovery" />

## Discovery Common provisioning groups discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| CPG [{#NAME}]: Number of FPVVs | Number of FPVVs (Fully Provisioned Virtual Volumes) allocated in the CPG. | hpe.primera.cpg.fpvv["{#ID}",count] | DEPENDENT |
| CPG [{#NAME}]: Raw space: Free | Raw free space. | hpe.primera.cpg.space.raw["{#ID}",free] | DEPENDENT |
| CPG [{#NAME}]: Raw space: Shared | Raw shared space. | hpe.primera.cpg.space.raw["{#ID}",shared] | DEPENDENT |
| CPG [{#NAME}]: Raw space: Total | Raw total space. | hpe.primera.cpg.space.raw["{#ID}",total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot administration: Total (raw) | Total physical (raw) logical disk space in snapshot administration. | hpe.primera.cpg.space.sa["{#ID}",raw_total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot administration: Used (raw) | Amount of physical (raw) logical disk used in snapshot administration. | hpe.primera.cpg.space.sa["{#ID}",raw_used] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot administration: Total | Total logical disk space in snapshot administration. | hpe.primera.cpg.space.sa["{#ID}",total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot administration: Used | Amount of logical disk used in snapshot administration. | hpe.primera.cpg.space.sa["{#ID}",used] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot data: Total (raw) | Total physical (raw) logical disk space in snapshot data space. | hpe.primera.cpg.space.sd["{#ID}",raw_total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot data: Used (raw) | Amount of physical (raw) logical disk used in snapshot data space. | hpe.primera.cpg.space.sd["{#ID}",raw_used] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot data: Total | Total logical disk space in snapshot data space. | hpe.primera.cpg.space.sd["{#ID}",total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: Snapshot data: Used | Amount of logical disk used in snapshot data space. | hpe.primera.cpg.space.sd["{#ID}",used] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: User space: Total (raw) | Total physical (raw) logical disk space in user data space. | hpe.primera.cpg.space.usr["{#ID}",raw_total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: User space: Used (raw) | Amount of physical (raw) logical disk used in user data space. | hpe.primera.cpg.space.usr["{#ID}",raw_used] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: User space: Total | Total logical disk space in user data space. | hpe.primera.cpg.space.usr["{#ID}",total] | DEPENDENT |
| CPG [{#NAME}]: Logical disk space: User space: Used | Amount of logical disk used in user data space. | hpe.primera.cpg.space.usr["{#ID}",used] | DEPENDENT |
| CPG [{#NAME}]: CPG space: Free | Free CPG space. | hpe.primera.cpg.space["{#ID}",free] | DEPENDENT |
| CPG [{#NAME}]: CPG space: Shared | Shared CPG space. | hpe.primera.cpg.space["{#ID}",shared] | DEPENDENT |
| CPG [{#NAME}]: CPG space: Total | Total CPG space. | hpe.primera.cpg.space["{#ID}",total] | DEPENDENT |
| CPG [{#NAME}]: Degraded state | Detailed state of the CPG:<br><br>LDS_NOT_STARTED (1) - LDs not started.<br>NOT_STARTED (2) - VV not started.<br>NEEDS_CHECK (3) - check for consistency.<br>NEEDS_MAINT_CHECK (4) - maintenance check is required.<br>INTERNAL_CONSISTENCY_ERROR (5) - internal consistency error.<br>SNAPDATA_INVALID (6) - invalid snapshot data.<br>PRESERVED (7) - unavailable LD sets due to missing chunklets. Preserved remaining VV data.<br>STALE (8) - parts of the VV contain old data because of a copy-on-write operation.<br>COPY_FAILED (9) - a promote or copy operation to this volume failed.<br>DEGRADED_AVAIL (10) - degraded due to availability.<br>DEGRADED_PERF (11) - degraded due to performance.<br>PROMOTING (12) - volume is the current target of a promote operation.<br>COPY_TARGET (13) - volume is the current target of a physical copy operation.<br>RESYNC_TARGET (14) - volume is the current target of a resynchronized copy operation.<br>TUNING (15) - volume tuning is in progress.<br>CLOSING (16) - volume is closing.<br>REMOVING (17) - removing the volume.<br>REMOVING_RETRY (18) - retrying a volume removal operation.<br>CREATING (19) - creating a volume.<br>COPY_SOURCE (20) - copy source.<br>IMPORTING (21) - importing a volume.<br>CONVERTING (22) - converting a volume.<br>INVALID (23) - invalid.<br>EXCLUSIVE (24) - local storage system has exclusive access to the volume.<br>CONSISTENT (25) - volume is being imported consistently along with other volumes in the VV set.<br>STANDBY (26) - volume in standby mode.<br>SD_META_INCONSISTENT (27) - SD Meta Inconsistent.<br>SD_NEEDS_FIX (28) - SD needs fix.<br>SD_META_FIXING (29) - SD meta fix.<br>UNKNOWN (999) - unknown state.<br>NOT_SUPPORTED_BY_WSAPI (1000) - state not supported by WSAPI. | hpe.primera.cpg.state["{#ID}",degraded] | DEPENDENT |
| CPG [{#NAME}]: Failed state | Detailed state of the CPG:<br><br>LDS_NOT_STARTED (1) - LDs not started.<br>NOT_STARTED (2) - VV not started.<br>NEEDS_CHECK (3) - check for consistency.<br>NEEDS_MAINT_CHECK (4) - maintenance check is required.<br>INTERNAL_CONSISTENCY_ERROR (5) - internal consistency error.<br>SNAPDATA_INVALID (6) - invalid snapshot data.<br>PRESERVED (7) - unavailable LD sets due to missing chunklets. Preserved remaining VV data.<br>STALE (8) - parts of the VV contain old data because of a copy-on-write operation.<br>COPY_FAILED (9) - a promote or copy operation to this volume failed.<br>DEGRADED_AVAIL (10) - degraded due to availability.<br>DEGRADED_PERF (11) - degraded due to performance.<br>PROMOTING (12) - volume is the current target of a promote operation.<br>COPY_TARGET (13) - volume is the current target of a physical copy operation.<br>RESYNC_TARGET (14) - volume is the current target of a resynchronized copy operation.<br>TUNING (15) - volume tuning is in progress.<br>CLOSING (16) - volume is closing.<br>REMOVING (17) - removing the volume.<br>REMOVING_RETRY (18) - retrying a volume removal operation.<br>CREATING (19) - creating a volume.<br>COPY_SOURCE (20) - copy source.<br>IMPORTING (21) - importing a volume.<br>CONVERTING (22) - converting a volume.<br>INVALID (23) - invalid.<br>EXCLUSIVE (24) - local storage system has exclusive access to the volume.<br>CONSISTENT (25) - volume is being imported consistently along with other volumes in the VV set.<br>STANDBY (26) - volume in standby mode.<br>SD_META_INCONSISTENT (27) - SD Meta Inconsistent.<br>SD_NEEDS_FIX (28) - SD needs fix.<br>SD_META_FIXING (29) - SD meta fix.<br>UNKNOWN (999) - unknown state.<br>NOT_SUPPORTED_BY_WSAPI (1000) - state not supported by WSAPI. | hpe.primera.cpg.state["{#ID}",failed] | DEPENDENT |
| CPG [{#NAME}]: State | Overall state of the CPG:<br><br>NORMAL (1) - normal operation;<br>DEGRADED (2) - degraded state;<br>FAILED (3) - abnormal operation;<br>UNKNOWN (99) - unknown state. | hpe.primera.cpg.state["{#ID}"] | DEPENDENT |
| CPG [{#NAME}]: Number of TDVVs | Number of TDVVs (Thinly Deduplicated Virtual Volume) created in the CPG. | hpe.primera.cpg.tdvv["{#ID}",count] | DEPENDENT |
| CPG [{#NAME}]: Number of TPVVs | Number of TPVVs (Thinly Provisioned Virtual Volumes) allocated in the CPG. | hpe.primera.cpg.tpvv["{#ID}",count] | DEPENDENT |
| CPG [{#NAME}]: Get CPG data | CPG {#NAME} data | hpe.primera.cpg["{#ID}",data] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| CPG [{#NAME}]: Degraded | AVERAGE | CPG [{#NAME}] is in degraded state. | last(/HPE Primera by HTTP/hpe.primera.cpg.state["{#ID}"])=2 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| CPG [{#NAME}]: Failed | HIGH | CPG [{#NAME}] is in failed state. | last(/HPE Primera by HTTP/hpe.primera.cpg.state["{#ID}"])=3 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |


<a name="discovery_disks_discovery" />

## Discovery Disks discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Disk [{#POSITION}]: Get disk data | Disk [{#POSITION}] data | hpe.primera.disk["{#ID}",data] | DEPENDENT |
| Disk [{#POSITION}]: Free size | Physical disk free size. | hpe.primera.disk["{#ID}",free_size] | DEPENDENT |
| Disk [{#POSITION}]: Firmware version | Physical disk firmware version. | hpe.primera.disk["{#ID}",fw_version] | DEPENDENT |
| Disk [{#POSITION}]: Path A0 degraded | Indicates if this is a degraded path for the disk. | hpe.primera.disk["{#ID}",loop_a0_degraded] | DEPENDENT |
| Disk [{#POSITION}]: Path A1 degraded | Indicates if this is a degraded path for the disk. | hpe.primera.disk["{#ID}",loop_a1_degraded] | DEPENDENT |
| Disk [{#POSITION}]: Path B0 degraded | Indicates if this is a degraded path for the disk. | hpe.primera.disk["{#ID}",loop_b0_degraded] | DEPENDENT |
| Disk [{#POSITION}]: Path B1 degraded | Indicates if this is a degraded path for the disk. | hpe.primera.disk["{#ID}",loop_b1_degraded] | DEPENDENT |
| Disk [{#POSITION}]: Manufacturer | Physical disk manufacturer. | hpe.primera.disk["{#ID}",manufacturer] | DEPENDENT |
| Disk [{#POSITION}]: Model | Manufacturer's device ID for disk. | hpe.primera.disk["{#ID}",model] | DEPENDENT |
| Disk [{#POSITION}]: RPM | RPM of the physical disk. | hpe.primera.disk["{#ID}",rpm] | DEPENDENT |
| Disk [{#POSITION}]: Serial number | Disk drive serial number. | hpe.primera.disk["{#ID}",serial_number] | DEPENDENT |
| Disk [{#POSITION}]: State | State of the physical disk:<br><br>Normal (1) - physical disk is in Normal state;<br>Degraded (2) - physical disk is not operating normally;<br>New (3) - physical disk is new, needs to be admitted;<br>Failed (4) - physical disk has failed;<br>Unknown (99) - physical disk state is unknown. | hpe.primera.disk["{#ID}",state] | DEPENDENT |
| Disk [{#POSITION}]: Total size | Physical disk total size. | hpe.primera.disk["{#ID}",total_size] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Disk [{#POSITION}]: Path A0 degraded | AVERAGE | Disk [{#POSITION}] path A0 in degraded state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",loop_a0_degraded])=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Disk [{#POSITION}]: Path A1 degraded | AVERAGE | Disk [{#POSITION}] path A1 in degraded state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",loop_a1_degraded])=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Disk [{#POSITION}]: Path B0 degraded | AVERAGE | Disk [{#POSITION}] path B0 in degraded state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",loop_b0_degraded])=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Disk [{#POSITION}]: Path B1 degraded | AVERAGE | Disk [{#POSITION}] path B1 in degraded state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",loop_b1_degraded])=1 | [{"tag": "scope", "value": "availability"}] | no url |
| Disk [{#POSITION}]: Degraded | AVERAGE | Disk [{#POSITION}] in degraded state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",state])=2 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| Disk [{#POSITION}]: Failed | HIGH | Disk [{#POSITION}] in failed state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",state])=3 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| Disk [{#POSITION}]: Unknown issue | INFO | Disk [{#POSITION}] in unknown state. | last(/HPE Primera by HTTP/hpe.primera.disk["{#ID}",state])=99 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |


<a name="discovery_hosts_discovery" />

## Discovery Hosts discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Host [{#NAME}]: Comment | Additional information for the host. | hpe.primera.host["{#ID}",comment] | DEPENDENT |
| Host [{#NAME}]: Contact | The host's owner and contact. | hpe.primera.host["{#ID}",contact] | DEPENDENT |
| Host [{#NAME}]: Get host data | Host [{#NAME}] data | hpe.primera.host["{#ID}",data] | DEPENDENT |
| Host [{#NAME}]: IP address | The host's IP address. | hpe.primera.host["{#ID}",ipaddress] | DEPENDENT |
| Host [{#NAME}]: Location | The host's location. | hpe.primera.host["{#ID}",location] | DEPENDENT |
| Host [{#NAME}]: Model | The host's model. | hpe.primera.host["{#ID}",model] | DEPENDENT |
| Host [{#NAME}]: OS | The operating system running on the host. | hpe.primera.host["{#ID}",os] | DEPENDENT |


<a name="discovery_ports_discovery" />

## Discovery Ports discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Get port data | Port [{#NODE}:{#SLOT}:{#CARD.PORT}] data | hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",data] | DEPENDENT |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Failover state | The state of the failover operation, shown for the two ports indicated in the N:S:P and Partner columns. The value can be one of the following:<br><br>none (1) - no failover in operation;<br>failover_pending (2) - in the process of failing over to partner;<br>failed_over (3) - failed over to partner;<br>active (4) - the partner port is failed over to this port;<br>active_down (5) - the partner port is failed over to this port, but this port is down;<br>active_failed (6) - the partner port is failed over to this port, but this port is down;<br>failback_pending (7) - in the process of failing back from partner. | hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",failover_state] | DEPENDENT |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Hardware type | Hardware type:<br><br>FC (1) - Fibre channel HBA;<br>ETH (2) - Ethernet NIC;<br>iSCSI (3) - iSCSI HBA;<br>CNA (4) - Converged network adapter;<br>SAS (5) - SAS HBA;<br>COMBO (6) - Combo card;<br>NVME (7) - NVMe drive;<br>UNKNOWN (99) - unknown hardware type. | hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",hw_type] | DEPENDENT |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Link state | Port link state:<br><br>CONFIG_WAIT (1) - configuration wait;<br>ALPA_WAIT (2) - ALPA wait;<br>LOGIN_WAIT (3) - login wait;<br>READY (4) - link is ready;<br>LOSS_SYNC (5) - link is loss sync;<br>ERROR_STATE (6) - in error state;<br>XXX (7) - xxx;<br>NONPARTICIPATE (8) - link did not participate;<br>COREDUMP (9) - taking coredump;<br>OFFLINE (10) - link is offline;<br>FWDEAD (11) - firmware is dead;<br>IDLE_FOR_RESET (12) - link is idle for reset;<br>DHCP_IN_PROGRESS (13) - DHCP is in progress;<br>PENDING_RESET (14) - link reset is pending;<br>NEW (15) - link in new. This value is applicable for only virtual ports;<br>DISABLED (16) - link in disabled. This value is applicable for only virtual ports;<br>DOWN (17) - link in down. This value is applicable for only virtual ports;<br>FAILED (18) - link in failed. This value is applicable for only virtual ports;<br>PURGING (19) - link in purging. This value is applicable for only virtual ports. | hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state] | DEPENDENT |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Type | Port connection type:<br><br>HOST (1) - FC port connected to hosts or fabric;<br>DISK (2) - FC port connected to disks;<br>FREE (3) - port is not connected to hosts or disks;<br>IPORT (4) - port is in iport mode;<br>RCFC (5) - FC port used for remote copy;<br>PEER (6) - FC port used for data migration;<br>RCIP (7) - IP (Ethernet) port used for remote copy;<br>ISCSI (8) - iSCSI (Ethernet) port connected to hosts;<br>CNA (9) - CNA port, which can be FCoE or iSCSI;<br>FS (10) - Ethernet File Persona ports. | hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",type] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Failover state is {ITEM.VALUE1} | AVERAGE | Port [{#NODE}:{#SLOT}:{#CARD.PORT}] has failover error. | last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",failover_state])<>1 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",failover_state])<>4 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Link state is {ITEM.VALUE1} | HIGH | Port [{#NODE}:{#SLOT}:{#CARD.PORT}] not in ready state. | last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>4 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>1 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>3 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>13 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>15 and last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])<>16 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| Port [{#NODE}:{#SLOT}:{#CARD.PORT}]: Link state is {ITEM.VALUE1} | AVERAGE | Port [{#NODE}:{#SLOT}:{#CARD.PORT}] not in ready state. | last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])=1 or last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])=3 or last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])=13 or last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])=15 or last(/HPE Primera by HTTP/hpe.primera.port["{#NODE}:{#SLOT}:{#CARD.PORT}",link_state])=16 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |


<a name="discovery_tasks_discovery" />

## Discovery Tasks discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Task [{#NAME}]: Get task data | Task [{#NAME}] data | hpe.primera.task["{#ID}",data] | DEPENDENT |
| Task [{#NAME}]: Finish time | Task finish time. | hpe.primera.task["{#ID}",finish_time] | DEPENDENT |
| Task [{#NAME}]: Start time | Task start time. | hpe.primera.task["{#ID}",start_time] | DEPENDENT |
| Task [{#NAME}]: Status | Task status:<br><br>DONE (1) - task is finished;<br>ACTIVE (2) - task is in progress;<br>CANCELLED (3) - task is canceled;<br>FAILED (4) - task failed. | hpe.primera.task["{#ID}",status] | DEPENDENT |
| Task [{#NAME}]: Type | Task type:<br><br>VV_COPY (1) - track the physical copy operations;<br>PHYS_COPY_RESYNC (2) - track physical copy resynchronization operations;<br>MOVE_REGIONS (3) - track region move operations;<br>PROMOTE_SV (4) - track virtual-copy promotions;<br>REMOTE_COPY_SYNC (5) - track remote copy group synchronizations;<br>REMOTE_COPY_REVERSE (6) - track the reversal of a remote copy group;<br>REMOTE_COPY_FAILOVER (7) - track the change-over of a secondary volume group to a primaryvolume group;REMOTE_COPY_RECOVER (8) - track synchronization start after a failover operation from originalsecondary cluster to original primary cluster;<br>REMOTE_COPY_RESTORE (9) - tracks the restoration process for groups that have already been recovered;<br>COMPACT_CPG (10) - track space consolidation in CPGs;<br>COMPACT_IDS (11) - track space consolidation in logical disks;<br>SNAPSHOT_ACCOUNTING (12) - track progress of snapshot space usage accounting;<br>CHECK_VV (13) - track the progress of the check-volume operation;<br>SCHEDULED_TASK (14) - track tasks that have been executed by the system scheduler;<br>SYSTEM_TASK (15) - track tasks that are periodically run by the storage system;<br>BACKGROUND_TASK (16) - track commands started using the starttask command;<br>IMPORT_VV (17) - track tasks that migrate data to the local storage system;<br>ONLINE_COPY (18) - track physical copy of the volume while online (createvvcopy-online command);<br>CONVERT_VV (19) - track tasks that convert a volume from an FPVV to a TPVV, and the reverse;<br>BACKGROUND_COMMAND (20) - track background command tasks;<br>CLX_SYNC (21) - track CLX synchronization tasks;<br>CLX_RECOVERY (22) - track CLX recovery tasks;<br>TUNE_SD (23) - tune copy space;<br>TUNE_VV (24) - tune virtual volume;<br>TUNE_VV_ROLLBACK (25) - tune virtual volume rollback;<br>TUNE_VV_RESTART (26) - tune virtual volume restart;<br>SYSTEM_TUNING (27) - system tuning;<br>NODE_RESCUE (28) - node rescue;<br>REPAIR_SYNC (29) - remote copy repair sync;<br>REMOTE_COPY_SWOVER (30) - remote copy switchover;<br>DEFRAGMENTATION (31) - defragmentation;<br>ENCRYPTION_CHANGE (32) - encryption change;<br>REMOTE_COPY_FAILSAFE (33) - remote copy failsafe;<br>TUNE_TPVV (34) - tune thin virtual volume;<br>REMOTE_COPY_CHG_MODE (35) - remote copy change mode;<br>ONLINE_PROMOTE (37) - online promote snap;<br>RELOCATE_PD (38) - relocate PD;<br>PERIODIC_CSS (39) - remote copy periodic CSS;<br>TUNEVV_LARGE (40) - tune large virtual volume;<br>SD_META_FIXER (41) - compression SD meta fixer;<br>DEDUP_DRYRUN (42) - preview dedup ratio;<br>COMPR_DRYRUN (43) - compression estimation;<br>DEDUP_COMPR_DRYRUN (44) - compression and dedup estimation;<br>UNKNOWN (99) - unknown task type. | hpe.primera.task["{#ID}",type] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Task [{#NAME}]: Cancelled | INFO | Task [{#NAME}] is cancelled. | last(/HPE Primera by HTTP/hpe.primera.task["{#ID}",status])=3 | [{"tag": "scope", "value": "notice"}] | no url |
| Task [{#NAME}]: Failed | AVERAGE | Task [{#NAME}] is failed. | last(/HPE Primera by HTTP/hpe.primera.task["{#ID}",status])=4 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discovery_volumes_discovery" />

## Discovery Volumes discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Volume [{#NAME}]: Compaction ratio | The compaction ratio indicates the overall amount of storage space saved with thin technology. | hpe.primera.volume.capacity.efficiency["{#ID}",compaction] | DEPENDENT |
| Volume [{#NAME}]: Storage space saved using compression | Indicates the amount of storage space saved using compression. | hpe.primera.volume.capacity.efficiency["{#ID}",compression] | DEPENDENT |
| Volume [{#NAME}]: Storage space saved using deduplication | Indicates the amount of storage space saved using deduplication. | hpe.primera.volume.capacity.efficiency["{#ID}",deduplication] | DEPENDENT |
| Volume [{#NAME}]: Overprovisioning ratio | Overprovisioning capacity efficiency ratio. | hpe.primera.volume.capacity.efficiency["{#ID}",overprovisioning] | DEPENDENT |
| Volume [{#NAME}]: Storage space saved using deduplication and compression | Indicates the amount of storage space saved using deduplication and compression together. | hpe.primera.volume.capacity.efficiency["{#ID}",reduction] | DEPENDENT |
| Volume [{#NAME}]: Administrative space: Free | Free administrative space. | hpe.primera.volume.space.admin["{#ID}",free] | DEPENDENT |
| Volume [{#NAME}]: Administrative space: Raw reserved | Raw reserved administrative space. | hpe.primera.volume.space.admin["{#ID}",raw_reserved] | DEPENDENT |
| Volume [{#NAME}]: Administrative space: Reserved | Reserved administrative space. | hpe.primera.volume.space.admin["{#ID}",reserved] | DEPENDENT |
| Volume [{#NAME}]: Administrative space: Used | Used administrative space. | hpe.primera.volume.space.admin["{#ID}",used] | DEPENDENT |
| Volume [{#NAME}]: Snapshot space: Free | Free snapshot space. | hpe.primera.volume.space.snapshot["{#ID}",free] | DEPENDENT |
| Volume [{#NAME}]: Snapshot space: Raw reserved | Raw reserved snapshot space. | hpe.primera.volume.space.snapshot["{#ID}",raw_reserved] | DEPENDENT |
| Volume [{#NAME}]: Snapshot space: Reserved | Reserved snapshot space. | hpe.primera.volume.space.snapshot["{#ID}",reserved] | DEPENDENT |
| Volume [{#NAME}]: Snapshot space: Used | Used snapshot space. | hpe.primera.volume.space.snapshot["{#ID}",used] | DEPENDENT |
| Volume [{#NAME}]: Total reserved space | Total reserved space. | hpe.primera.volume.space.total["{#ID}",reserved] | DEPENDENT |
| Volume [{#NAME}]: Total space | Virtual size of volume. | hpe.primera.volume.space.total["{#ID}",size] | DEPENDENT |
| Volume [{#NAME}]: Total used space | Total used space. Sum of used user space and used snapshot space. | hpe.primera.volume.space.total["{#ID}",used] | DEPENDENT |
| Volume [{#NAME}]: User space: Free | Free user space. | hpe.primera.volume.space.user["{#ID}",free] | DEPENDENT |
| Volume [{#NAME}]: User space: Raw reserved | Raw reserved user space. | hpe.primera.volume.space.user["{#ID}",raw_reserved] | DEPENDENT |
| Volume [{#NAME}]: User space: Reserved | Reserved user space. | hpe.primera.volume.space.user["{#ID}",reserved] | DEPENDENT |
| Volume [{#NAME}]: User space: Used | Used user space. | hpe.primera.volume.space.user["{#ID}",used] | DEPENDENT |
| Volume [{#NAME}]: Compression state | Volume compression state:<br><br>YES (1) - compression is enabled on the volume;<br>NO (2) - compression is disabled on the volume;<br>OFF (3) - compression is turned off;<br>NA (4) - compression is not available on the volume. | hpe.primera.volume.state["{#ID}",compression] | DEPENDENT |
| Volume [{#NAME}]: Deduplication state | Volume deduplication state:<br><br>YES (1) - enables deduplication on the volume;<br>NO (2) - disables deduplication on the volume;<br>NA (3) - deduplication is not available;<br>OFF (4) - deduplication is turned off. | hpe.primera.volume.state["{#ID}",deduplication] | DEPENDENT |
| Volume [{#NAME}]: Degraded state | Volume detailed state:<br><br>LDS_NOT_STARTED (1) - LDs not started.<br>NOT_STARTED (2) - VV not started.<br>NEEDS_CHECK (3) - check for consistency.<br>NEEDS_MAINT_CHECK (4) - maintenance check is required.<br>INTERNAL_CONSISTENCY_ERROR (5) - internal consistency error.<br>SNAPDATA_INVALID (6) - invalid snapshot data.<br>PRESERVED (7) - unavailable LD sets due to missing chunklets. Preserved remaining VV data.<br>STALE (8) - parts of the VV contain old data because of a copy-on-write operation.<br>COPY_FAILED (9) - a promote or copy operation to this volume failed.<br>DEGRADED_AVAIL (10) - degraded due to availability.<br>DEGRADED_PERF (11) - degraded due to performance.<br>PROMOTING (12) - volume is the current target of a promote operation.<br>COPY_TARGET (13) - volume is the current target of a physical copy operation.<br>RESYNC_TARGET (14) - volume is the current target of a resynchronized copy operation.<br>TUNING (15) - volume tuning is in progress.<br>CLOSING (16) - volume is closing.<br>REMOVING (17) - removing the volume.<br>REMOVING_RETRY (18) - retrying a volume removal operation.<br>CREATING (19) - creating a volume.<br>COPY_SOURCE (20) - copy source.<br>IMPORTING (21) - importing a volume.<br>CONVERTING (22) - converting a volume.<br>INVALID (23) - invalid.<br>EXCLUSIVE (24) - local storage system has exclusive access to the volume.<br>CONSISTENT (25) - volume is being imported consistently along with other volumes in the VV set.<br>STANDBY (26) - volume in standby mode.<br>SD_META_INCONSISTENT (27) - SD Meta Inconsistent.<br>SD_NEEDS_FIX (28) - SD needs fix.<br>SD_META_FIXING (29) - SD meta fix.<br>UNKNOWN (999) - unknown state.<br>NOT_SUPPORTED_BY_WSAPI (1000) - state not supported by WSAPI. | hpe.primera.volume.state["{#ID}",degraded] | DEPENDENT |
| Volume [{#NAME}]: Failed state | Volume detailed state:<br><br>LDS_NOT_STARTED (1) - LDs not started.<br>NOT_STARTED (2) - VV not started.<br>NEEDS_CHECK (3) - check for consistency.<br>NEEDS_MAINT_CHECK (4) - maintenance check is required.<br>INTERNAL_CONSISTENCY_ERROR (5) - internal consistency error.<br>SNAPDATA_INVALID (6) - invalid snapshot data.<br>PRESERVED (7) - unavailable LD sets due to missing chunklets. Preserved remaining VV data.<br>STALE (8) - parts of the VV contain old data because of a copy-on-write operation.<br>COPY_FAILED (9) - a promote or copy operation to this volume failed.<br>DEGRADED_AVAIL (10) - degraded due to availability.<br>DEGRADED_PERF (11) - degraded due to performance.<br>PROMOTING (12) - volume is the current target of a promote operation.<br>COPY_TARGET (13) - volume is the current target of a physical copy operation.<br>RESYNC_TARGET (14) - volume is the current target of a resynchronized copy operation.<br>TUNING (15) - volume tuning is in progress.<br>CLOSING (16) - volume is closing.<br>REMOVING (17) - removing the volume.<br>REMOVING_RETRY (18) - retrying a volume removal operation.<br>CREATING (19) - creating a volume.<br>COPY_SOURCE (20) - copy source.<br>IMPORTING (21) - importing a volume.<br>CONVERTING (22) - converting a volume.<br>INVALID (23) - invalid.<br>EXCLUSIVE (24) - local storage system has exclusive access to the volume.<br>CONSISTENT (25) - volume is being imported consistently along with other volumes in the VV set.<br>STANDBY (26) - volume in standby mode.<br>SD_META_INCONSISTENT (27) - SD Meta Inconsistent.<br>SD_NEEDS_FIX (28) - SD needs fix.<br>SD_META_FIXING (29) - SD meta fix.<br>UNKNOWN (999) - unknown state.<br>NOT_SUPPORTED_BY_WSAPI (1000) - state not supported by WSAPI. | hpe.primera.volume.state["{#ID}",failed] | DEPENDENT |
| Volume [{#NAME}]: State | State of the volume:<br><br>NORMAL (1) - normal operation;<br>DEGRADED (2) - degraded state;<br>FAILED (3) - abnormal operation;<br>UNKNOWN (99) - unknown state. | hpe.primera.volume.state["{#ID}"] | DEPENDENT |
| Volume [{#NAME}]: Remote copy status | Remote copy status of the volume:<br><br>NONE (1) - volume is not associated with remote copy;<br>PRIMARY (2) - volume is the primary copy;<br>SECONDARY (3) - volume is the secondary copy;<br>SNAP (4) - volume is the remote copy snapshot;<br>SYNC (5) - volume is a remote copy snapshot being used for synchronization;<br>DELETE (6) - volume is a remote copy snapshot that is marked for deletion;<br>UNKNOWN (99) - remote copy status is unknown for this volume. | hpe.primera.volume.status["{#ID}",rcopy] | DEPENDENT |
| Volume [{#NAME}]: Get volume data | Volume [{#NAME}] data | hpe.primera.volume["{#ID}",data] | DEPENDENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Volume [{#NAME}]: Degraded | AVERAGE | Volume [{#NAME}] is in degraded state. | last(/HPE Primera by HTTP/hpe.primera.volume.state["{#ID}"])=2 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |
| Volume [{#NAME}]: Failed | HIGH | Volume [{#NAME}] is in failed state. | last(/HPE Primera by HTTP/hpe.primera.volume.state["{#ID}"])=3 | [{"tag": "scope", "value": "availability"}, {"tag": "scope", "value": "capacity"}] | no url |

