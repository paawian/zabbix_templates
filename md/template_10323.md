# Template: ClickHouse by HTTP

## Template ID
10323

## Description
This template is designed for the effortless deployment of ClickHouse monitoring by Zabbix via HTTP and doesn't require any external scripts.

Setup:

1. Create a user to monitor the service. For example, you could create a file '/etc/clickhouse-server/users.d/zabbix.xml' with the following content:

<yandex>
  <users>
    <zabbix>
      <password>zabbix_pass</password>
      <networks incl="networks" />
      <profile>web</profile>
      <quota>default</quota>
      <allow_databases>
        <database>test</database>
      </allow_databases>
    </zabbix>
  </users>
</yandex>

2. Set the hostname or IP address of the ClickHouse HTTP endpoint in the '{$CLICKHOUSE.HOST}' macro. You can also change the port in the '{$CLICKHOUSE.PORT}' macro and scheme in the '{$CLICKHOUSE.SCHEME}' macro if necessary.

3. Set the login and password in the macros '{$CLICKHOUSE.USER}' and '{$CLICKHOUSE.PASSWORD}'. If you don't need an authentication - remove headers from HTTP-Agent type items.

Generated by official Zabbix template tool "Templator"

## Linked Hosts
None

## Items

### Item: Current distribute connections
- **Description**: Number of connections to remote servers sending data that was INSERTed into Distributed tables.
- **Interval**: 0
- **Data Type**: 3

### Item: Current HTTP connections
- **Description**: Number of connections to HTTP server.
- **Interval**: 0
- **Data Type**: 3

### Item: Current Interserver connections
- **Description**: Number of connections from other replicas to fetch parts.
- **Interval**: 0
- **Data Type**: 3

### Item: Current MySQL connections
- **Description**: Number of connections to MySQL server.
- **Interval**: 0
- **Data Type**: 3

### Item: Current TCP connections
- **Description**: Number of connections to TCP server (clients with native interface).
- **Interval**: 0
- **Data Type**: 3

### Item: Get databases info
- **Description**: Get information about databases.
- **Interval**: 1m
- **Data Type**: 4

### Item: Get dictionaries info
- **Description**: Get information about dictionaries.
- **Interval**: 1m
- **Data Type**: 4

### Item: Current distributed files to insert
- **Description**: Number of pending files to process for asynchronous insertion into Distributed tables. Number of files for every shard is summed.
- **Interval**: 0
- **Data Type**: 3

### Item: Distributed connection fail with retry per second
- **Description**: Connection failures after all retries in replicated DB connection pool
- **Interval**: 0
- **Data Type**: 0

### Item: Distributed connection fail with retry per second
- **Description**: Connection retries in replicated DB connection pool
- **Interval**: 0
- **Data Type**: 0

### Item: Delayed insert queries
- **Description**: Number of INSERT queries that are throttled due to high number of active data parts for partition in a MergeTree table.
- **Interval**: 0
- **Data Type**: 0

### Item: Inserted bytes per second
- **Description**: The number of uncompressed bytes inserted in all tables.
- **Interval**: 0
- **Data Type**: 0

### Item: Inserted rows per second
- **Description**: The number of rows inserted in all tables.
- **Interval**: 0
- **Data Type**: 0

### Item: New INSERT queries per second
- **Description**: Number of INSERT queries to be interpreted and potentially executed. Does not include queries that failed to parse or were rejected due to AST size limits, quota limits or limits on the number of simultaneously running queries. May include internal queries initiated by ClickHouse itself. Does not count subqueries.
- **Interval**: 0
- **Data Type**: 0

### Item: Allocated bytes
- **Description**: Total number of bytes allocated by the application.
- **Interval**: 0
- **Data Type**: 3

### Item: Mapped memory
- **Description**: Total number of bytes in active extents mapped by the allocator.
- **Interval**: 0
- **Data Type**: 3

### Item: Resident memory
- **Description**: Maximum number of bytes in physically resident data pages mapped by the allocator,
comprising all pages dedicated to allocator metadata, pages backing active allocations,
and unused dirty pages.
- **Interval**: 0
- **Data Type**: 3

### Item: Max count of parts per partition across all tables
- **Description**: Clickhouse MergeTree table engine split each INSERT query to partitions (PARTITION BY expression) and add one or more PARTS per INSERT inside each partition, after that background merge process run.
- **Interval**: 0
- **Data Type**: 3

### Item: Memory used for queries
- **Description**: Total amount of memory (bytes) allocated in currently executing queries.
- **Interval**: 0
- **Data Type**: 0

### Item: Memory used for background merges
- **Description**: Total amount of memory (bytes) allocated in background processing pool (that is dedicated for background merges, mutations and fetches).
 Note that this value may include a drift when the memory was allocated in a context of background processing pool and freed in other context or vice-versa. This happens naturally due to caches for tables indexes and doesn't indicate memory leaks.
- **Interval**: 0
- **Data Type**: 0

### Item: Memory used for background moves
- **Description**: Total amount of memory (bytes) allocated in background processing pool (that is dedicated for background moves). Note that this value may include a drift when the memory was allocated in a context of background processing pool and freed in other context or vice-versa.
 This happens naturally due to caches for tables indexes and doesn't indicate memory leaks.
- **Interval**: 0
- **Data Type**: 0

### Item: Memory used for merges
- **Description**: Total amount of memory (bytes) allocated for background merges. Included in MemoryTrackingInBackgroundProcessingPool. Note that this value may include a drift when the memory was allocated in a context of background processing pool and freed in other context or vice-versa.
This happens naturally due to caches for tables indexes and doesn't indicate memory leaks.
- **Interval**: 0
- **Data Type**: 0

### Item: Memory used for background schedule pool
- **Description**: Total amount of memory (bytes) allocated in background schedule pool (that is dedicated for bookkeeping tasks of Replicated tables).
- **Interval**: 0
- **Data Type**: 0

### Item: Uncompressed bytes merged per second
- **Description**: Uncompressed bytes that were read for background merges
- **Interval**: 0
- **Data Type**: 0

### Item: Current running merges
- **Description**: Number of executing background merges
- **Interval**: 0
- **Data Type**: 3

### Item: Merged rows per second
- **Description**: Rows read for background merges.
- **Interval**: 0
- **Data Type**: 0

### Item: Network errors per second
- **Description**: Network errors (timeouts and connection failures) during query execution, background pool tasks and DNS cache update.
- **Interval**: 0
- **Data Type**: 0

### Item: Ping
- **Description**: 
- **Interval**: 1m
- **Data Type**: 3

### Item: Longest currently running query time
- **Description**: Get longest running query.
- **Interval**: 1m
- **Data Type**: 0

### Item: Current running queries
- **Description**: Number of executing queries
- **Interval**: 0
- **Data Type**: 3

### Item: New queries per second
- **Description**: Number of queries to be interpreted and potentially executed. Does not include queries that failed to parse or were rejected due to AST size limits, quota limits or limits on the number of simultaneously running queries. May include internal queries initiated by ClickHouse itself. Does not count subqueries.
- **Interval**: 0
- **Data Type**: 0

### Item: Read syscalls in fly
- **Description**: Number of read (read, pread, io_getevents, etc.) syscalls in fly
- **Interval**: 0
- **Data Type**: 3

### Item: Read bytes per second
- **Description**: Number of bytes (the number of bytes before decompression) read from compressed sources (files, network).
- **Interval**: 0
- **Data Type**: 0

### Item: Get replicas info
- **Description**: Get information about replicas.
- **Interval**: 1m
- **Data Type**: 4

### Item: Replication lag across all tables
- **Description**: Maximum replica queue delay relative to current time
- **Interval**: 0
- **Data Type**: 3

### Item: Total number read-only Replicas
- **Description**: Number of Replicated tables that are currently in readonly state due to re-initialization after ZooKeeper session loss or due to startup without ZooKeeper configured.
- **Interval**: 0
- **Data Type**: 3

### Item: Total replication tasks in queue
- **Description**: Number of replication tasks in queue
- **Interval**: 0
- **Data Type**: 3

### Item: Revision
- **Description**: Revision of the server.
- **Interval**: 0
- **Data Type**: 3

### Item: New SELECT queries per second
- **Description**: Number of SELECT queries to be interpreted and potentially executed. Does not include queries that failed to parse or were rejected due to AST size limits, quota limits or limits on the number of simultaneously running queries. May include internal queries initiated by ClickHouse itself. Does not count subqueries.
- **Interval**: 0
- **Data Type**: 0

### Item: Get system.asynchronous_metrics
- **Description**: Get metrics that are calculated periodically in the background
- **Interval**: 1m
- **Data Type**: 4

### Item: Get system.events
- **Description**: Get information about the number of events that have occurred in the system.
- **Interval**: 1m
- **Data Type**: 4

### Item: Get system.metrics
- **Description**: Get metrics which can be calculated instantly, or have a current value format JSONEachRow
- **Interval**: 1m
- **Data Type**: 4

### Item: Get system.settings
- **Description**: Get information about settings that are currently in use.
- **Interval**: 1m
- **Data Type**: 4

### Item: Get tables info
- **Description**: Get information about tables.
- **Interval**: 1m
- **Data Type**: 4

### Item: Uptime
- **Description**: Number of seconds since ClickHouse server start
- **Interval**: 0
- **Data Type**: 0

### Item: Version
- **Description**: Version of the server
- **Interval**: 1m
- **Data Type**: 1

### Item: Write syscalls in fly
- **Description**: Number of write (write, pwrite, io_getevents, etc.) syscalls in fly
- **Interval**: 0
- **Data Type**: 3

### Item: ZooKeeper exceptions per second
- **Description**: Count of ZooKeeper exceptions that does not belong to user/hardware exceptions.
- **Interval**: 0
- **Data Type**: 0

### Item: ZooKeeper hardware exceptions per second
- **Description**: Count of ZooKeeper exceptions caused by session moved/expired, connection loss, marshalling error, operation timed out and invalid zhandle state.
- **Interval**: 0
- **Data Type**: 0

### Item: ZooKeeper requests
- **Description**: Number of requests to ZooKeeper in progress.
- **Interval**: 0
- **Data Type**: 3

### Item: ZooKeeper sessions
- **Description**: Number of sessions (connections) to ZooKeeper. Should be no more than one.
- **Interval**: 0
- **Data Type**: 3

### Item: ZooKeeper user exceptions per second
- **Description**: Count of ZooKeeper exceptions caused by no znodes, bad version, node exists, node empty and no children for ephemeral.
- **Interval**: 0
- **Data Type**: 0

### Item: ZooKeeper wait time
- **Description**: Time spent in waiting for ZooKeeper operations.
- **Interval**: 0
- **Data Type**: 0

### Item: ZooKeeper watches
- **Description**: Number of watches (e.g., event subscriptions) in ZooKeeper.
- **Interval**: 0
- **Data Type**: 3

### Item: Check port availability
- **Description**: 
- **Interval**: 1m
- **Data Type**: 3

