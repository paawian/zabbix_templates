# Kubernetes Scheduler by HTTP template description

Get Kubernetes Scheduler metrics by HTTP agent from Prometheus metrics endpoint.

Don't forget change macros {$KUBE.API.SERVER.URL}.
Some metrics may not be collected depending on your Kubernetes Scheduler instance version and configuration.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery e2e scheduling histogram ](#discovery_e2e_scheduling_histogram)
  * [Discovery Binding histogram ](#discovery_binding_histogram)
  * [Discovery Scheduling algorithm histogram ](#discovery_scheduling_algorithm_histogram)

<a name="items" />

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| REST Client requests: 2xx, rate | Number of HTTP requests with 2xx status code per second. | kubernetes.scheduler.client_http_requests_200.rate | DEPENDENT | 0 |
| REST Client requests: 3xx, rate | Number of HTTP requests with 3xx status code per second. | kubernetes.scheduler.client_http_requests_300.rate | DEPENDENT | 0 |
| REST Client requests: 4xx, rate | Number of HTTP requests with 4xx status code per second. | kubernetes.scheduler.client_http_requests_400.rate | DEPENDENT | 0 |
| REST Client requests: 5xx, rate | Number of HTTP requests with 5xx status code per second. | kubernetes.scheduler.client_http_requests_500.rate | DEPENDENT | 0 |
| CPU | Total user and system CPU usage ratio. | kubernetes.scheduler.cpu.util | DEPENDENT | 0 |
| Get Scheduler metrics | Get raw metrics from Scheduler instance /metrics endpoint. | kubernetes.scheduler.get_metrics | HTTP_AGENT | no delay |
| Goroutines | Number of goroutines that currently exist. | kubernetes.scheduler.go_goroutines | DEPENDENT | 0 |
| Go threads | Number of OS threads created. | kubernetes.scheduler.go_threads | DEPENDENT | 0 |
| Fds max | Maximum allowed open file descriptors. | kubernetes.scheduler.max_fds | DEPENDENT | 0 |
| Fds open | Number of open file descriptors. | kubernetes.scheduler.open_fds | DEPENDENT | 0 |
| Resident memory, bytes | Resident memory size in bytes. | kubernetes.scheduler.process_resident_memory_bytes | DEPENDENT | 0 |
| Virtual memory, bytes | Virtual memory size in bytes. | kubernetes.scheduler.process_virtual_memory_bytes | DEPENDENT | 0 |
| Schedule attempts: error | Number of attempts to schedule pods with result "error" per second. | kubernetes.scheduler.scheduler_schedule_attempts.error.rate | DEPENDENT | 0 |
| Schedule attempts: scheduled | Number of attempts to schedule pods with result "scheduled" per second. | kubernetes.scheduler.scheduler_schedule_attempts.scheduled.rate | DEPENDENT | 0 |
| Schedule attempts: unschedulable | Number of attempts to schedule pods with result "unschedulable" per second. | kubernetes.scheduler.scheduler_schedule_attempts.unschedulable.rate | DEPENDENT | 0 |


<a name="macros" />

## Macros
| macro | value |
| ------------- |------------- |
| {$KUBE.API.TOKEN} | no value |
| {$KUBE.SCHEDULER.ERROR} | 2 |
| {$KUBE.SCHEDULER.HTTP.CLIENT.ERROR} | 2 |
| {$KUBE.SCHEDULER.SERVER.URL} | https://localhost:10259/metrics |
| {$KUBE.SCHEDULER.UNSCHEDULABLE} | 2 |


<a name="triggers" />

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Too many REST Client errors | WARNING | "Kubernetes Scheduler REST Client requests is experiencing high error rate (with 5xx HTTP code). | min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.client_http_requests_500.rate,5m)>{$KUBE.SCHEDULER.HTTP.CLIENT.ERROR} | [{"tag": "scope", "value": "availability"}] | no url |
| Too many schedule attempts with errors | WARNING | Number of attempts to schedule pods with 'error' result is too high. 'error' means an internal scheduler problem. | min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.scheduler_schedule_attempts.error.rate,5m)>{$KUBE.SCHEDULER.ERROR} | [{"tag": "scope", "value": "performance"}] | no url |
| Too many unschedulable pods | WARNING | Number of attempts to schedule pods with 'unschedulable' result is too high. 'unschedulable' means a pod could not be scheduled. | min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.scheduler_schedule_attempts.unschedulable.rate,5m)>{$KUBE.SCHEDULER.UNSCHEDULABLE} | [{"tag": "scope", "value": "performance"}] | no url |


<a name="discoveries" />

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| e2e scheduling histogram | kubernetes.controller.e2e_scheduling.discovery | Discovery raw data and percentile items of e2e scheduling latency. | DEPENDENT | no lifetime | 0 |
| Binding histogram | kubernetes.scheduler.binding.discovery | Discovery raw data of binding latency. | DEPENDENT | no lifetime | 0 |
| Scheduling algorithm histogram | kubernetes.scheduler.scheduling_algorithm.discovery | Discovery raw data of scheduling algorithm latency. | DEPENDENT | no lifetime | 0 |


<a name="discovery_e2e_scheduling_histogram" />

## Discovery e2e scheduling histogram

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| ["{#RESULT}"]: e2e scheduling seconds bucket, {#LE} | E2e scheduling latency in seconds (scheduling algorithm + binding) | kubernetes.scheduler.e2e_scheduling_bucket[{#LE},"{#RESULT}"] | DEPENDENT |
| ["{#RESULT}"]: e2e scheduling, p50 | 50 percentile of e2e scheduling latency. | kubernetes.scheduler.e2e_scheduling_p50["{#RESULT}"] | CALCULATED |
| ["{#RESULT}"]: e2e scheduling, p90 | 90 percentile of e2e scheduling latency. | kubernetes.scheduler.e2e_scheduling_p90["{#RESULT}"] | CALCULATED |
| ["{#RESULT}"]: e2e scheduling, p95 | 95 percentile of e2e scheduling latency. | kubernetes.scheduler.e2e_scheduling_p95["{#RESULT}"] | CALCULATED |
| ["{#RESULT}"]: e2e scheduling, p99 | 95 percentile of e2e scheduling latency. | kubernetes.scheduler.e2e_scheduling_p99["{#RESULT}"] | CALCULATED |


<a name="discovery_binding_histogram" />

## Discovery Binding histogram

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Binding duration bucket, {#LE} | Binding latency in seconds. | kubernetes.scheduler.binding_duration[{#LE}] | DEPENDENT |
| Binding duration, p50 | 50 percentile of binding latency in seconds. | kubernetes.scheduler.binding_duration_p50[{#SINGLETON}] | CALCULATED |
| Binding duration, p90 | 90 percentile of binding latency in seconds. | kubernetes.scheduler.binding_duration_p90[{#SINGLETON}] | CALCULATED |
| Binding duration, p95 | 99 percentile of binding latency in seconds. | kubernetes.scheduler.binding_duration_p95[{#SINGLETON}] | CALCULATED |
| Binding duration, p99 | 95 percentile of binding latency in seconds. | kubernetes.scheduler.binding_duration_p99[{#SINGLETON}] | CALCULATED |


<a name="discovery_scheduling_algorithm_histogram" />

## Discovery Scheduling algorithm histogram

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Scheduling algorithm duration bucket, {#LE} | Scheduling algorithm latency in seconds. | kubernetes.scheduler.scheduling_algorithm_duration[{#LE}] | DEPENDENT |
| Scheduling algorithm duration, p50 | 50 percentile of scheduling algorithm latency in seconds. | kubernetes.scheduler.scheduling_algorithm_duration_p50[{#SINGLETON}] | CALCULATED |
| Scheduling algorithm duration, p90 | 90 percentile of scheduling algorithm latency in seconds. | kubernetes.scheduler.scheduling_algorithm_duration_p90[{#SINGLETON}] | CALCULATED |
| Scheduling algorithm duration, p95 | 95 percentile of scheduling algorithm latency in seconds. | kubernetes.scheduler.scheduling_algorithm_duration_p95[{#SINGLETON}] | CALCULATED |
| Scheduling algorithm duration, p99 | 99 percentile of scheduling algorithm latency in seconds. | kubernetes.scheduler.scheduling_algorithm_duration_p99[{#SINGLETON}] | CALCULATED |

