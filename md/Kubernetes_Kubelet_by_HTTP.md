# Kubernetes Kubelet by HTTP template description

Get Kubernetes kubelet metrics by HTTP agent from Prometheus metrics endpoint.

Don't forget change macros {$KUBE.KUBELET.URL}, {$KUBE.API.TOKEN}.
Some metrics may not be collected depending on your Kubernetes API server instance version and configuration.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [discoveries](#discoveries)
  * [Discovery Container memory discovery ](#discovery_container_memory_discovery)
  * [Discovery Pods discovery ](#discovery_pods_discovery)
  * [Discovery REST client requests discovery ](#discovery_rest_client_requests_discovery)
  * [Discovery Runtime operations discovery ](#discovery_runtime_operations_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Get cadvisor metrics | Collecting raw Kubelet metrics from /metrics/cadvisor endpoint. | kube.cadvisor.metrics | HTTP_AGENT | no delay |
| Containers restarts | The number of times the container has been restarted. | kube.kubelet.containers.restarts | DEPENDENT | 0 |
| Containers running | The number of running containers. | kube.kubelet.containers.running | DEPENDENT | 0 |
| CPU cores, total | The number of cores in this machine (available until kubernetes v1.18). | kube.kubelet.cpu.cores | DEPENDENT | 0 |
| Machine memory, bytes | Resident memory size in bytes. | kube.kubelet.machine.memory | DEPENDENT | 0 |
| Get kubelet metrics | Collecting raw Kubelet metrics from /metrics endpoint. | kube.kubelet.metrics | HTTP_AGENT | no delay |
| Pods running | The number of running pods. | kube.kubelet.pods.running | DEPENDENT | 0 |
| File descriptors, max | Maximum number of open file descriptors. | kube.kubelet.process_max_fds | DEPENDENT | 0 |
| File descriptors, open | Number of open file descriptors. | kube.kubelet.process_open_fds | DEPENDENT | 0 |
| Virtual memory, bytes | Virtual memory size in bytes. | kube.kubelet.virtual.memory | DEPENDENT | 0 |
| Containers last state terminated | The number of containers that were previously terminated. | kube.kublet.containers.terminated | DEPENDENT | 0 |
| Get pods | Collecting raw Kubelet metrics from /pods endpoint. | kube.pods | HTTP_AGENT | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$KUBE.API.TOKEN} | no value |
| {$KUBE.KUBELET.CADVISOR.ENDPOINT} | /metrics/cadvisor |
| {$KUBE.KUBELET.METRIC.ENDPOINT} | /metrics |
| {$KUBE.KUBELET.PODS.ENDPOINT} | /pods |
| {$KUBE.KUBELET.URL} | https://localhost:10250 |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Container memory discovery | kube.kubelet.container.memory.cache.discovery | no description | DEPENDENT | 0 | 0 |
| Pods discovery | kube.kubelet.pods.discovery | no description | DEPENDENT | 0 | 0 |
| REST client requests discovery | kube.kubelet.rest.requests.discovery | no description | DEPENDENT | no lifetime | 0 |
| Runtime operations discovery | kube.kubelet.runtime_operations_bucket.discovery | no description | DEPENDENT | no lifetime | 0 |


<a name="discovery_container_memory_discovery" />

## Discovery Container memory discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: Memory page cache | Number of bytes of page cache memory. | kube.kubelet.container.memory.cache["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: Memory max usage | Maximum memory usage recorded in bytes. | kube.kubelet.container.memory.max_usage["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: RSS | Size of RSS in bytes. | kube.kubelet.container.memory.rss["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: Swap | Container swap usage in bytes. | kube.kubelet.container.memory.swap["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: Usage | Current memory usage in bytes, including all memory regardless of when it was accessed. | kube.kubelet.container.memory.usage["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#POD}] Container [{#CONTAINER}]: Working set | Current working set in bytes. | kube.kubelet.container.memory.working_set["{#CONTAINER}", "{#NAMESPACE}", "{#POD}"] | DEPENDENT |


<a name="discovery_pods_discovery" />

## Discovery Pods discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Namespace [{#NAMESPACE}] Pod [{#NAME}] CPU: Load average, 10s | Pods cpu load average over the last 10 seconds. | kube.pod.container_cpu_load_average_10s[{#NAMESPACE}/{#NAME}] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#NAME}] CPU: System seconds, total | System cpu time consumed. It is calculated from the cumulative value using the `Change per second` preprocessing step. | kube.pod.container_cpu_system_seconds_total[{#NAMESPACE}/{#NAME}] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#NAME}] CPU: Usage seconds, total | Consumed cpu time. It is calculated from the cumulative value using the `Change per second` preprocessing step. | kube.pod.container_cpu_usage_seconds_total[{#NAMESPACE}/{#NAME}] | DEPENDENT |
| Namespace [{#NAMESPACE}] Pod [{#NAME}] CPU: User seconds, total | User cpu time consumed. It is calculated from the cumulative value using the `Change per second` preprocessing step. | kube.pod.container_cpu_user_seconds_total[{#NAMESPACE}/{#NAME}] | DEPENDENT |


<a name="discovery_rest_client_requests_discovery" />

## Discovery REST client requests discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| Host [{#HOST}] Request method [{#METHOD}] Code:[{#CODE}] | Number of HTTP requests, partitioned by status code, method, and host. | kube.kubelet.rest.requests["{#CODE}", "{#HOST}", "{#METHOD}"] | DEPENDENT |


<a name="discovery_runtime_operations_discovery" />

## Discovery Runtime operations discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| [{#OP_TYPE}] Runtime operations bucket: {#LE} | Duration in seconds of runtime operations. Broken down by operation type. | kube.kublet.runtime_ops_duration_seconds_bucket[{#LE},"{#OP_TYPE}"] | DEPENDENT |
| [{#OP_TYPE}] Operations, p50 | 50 percentile of operation latency distribution in seconds for each verb. | kube.kublet.runtime_ops_duration_seconds_p50["{#OP_TYPE}"] | CALCULATED |
| [{#OP_TYPE}] Operations, p90 | 90 percentile of operation latency distribution in seconds for each verb. | kube.kublet.runtime_ops_duration_seconds_p90["{#OP_TYPE}"] | CALCULATED |
| [{#OP_TYPE}] Operations, p95 | 95 percentile of operation latency distribution in seconds for each verb. | kube.kublet.runtime_ops_duration_seconds_p95["{#OP_TYPE}"] | CALCULATED |
| [{#OP_TYPE}] Operations, p99 | 99 percentile of operation latency distribution in seconds for each verb. | kube.kublet.runtime_ops_duration_seconds_p99["{#OP_TYPE}"] | CALCULATED |
| [{#OP_TYPE}] Runtime operations total, rate | Cumulative number of runtime operations by operation type. | kube.kublet.runtime_ops_total.rate["{#OP_TYPE}"] | DEPENDENT |

