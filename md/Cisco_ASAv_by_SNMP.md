# Cisco ASAv by SNMP template description

Template Net Cisco ASAv

MIBs used:
CISCO-PORT-MIB
CISCO-MEMORY-POOL-MIB
CISCO-REMOTE-ACCESS-MONITOR-MIB
IF-MIB
RFC1213-MIB
CISCO-PROCESS-MIB
ENTITY-MIB

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/418396-discussion-thread-for-official-zabbix-templates-for-cisco

Generated by official Zabbix template tool "Templator"

## Summary
* [items](#items)
* [macros](#macros)
* [triggers](#triggers)
* [discoveries](#discoveries)
  * [Discovery CPU discovery ](#discovery_cpu_discovery)
  * [Discovery Memory discovery ](#discovery_memory_discovery)
  * [Discovery Interface discovery ](#discovery_interface_discovery)
  * [Discovery Physical entry discovery ](#discovery_physical_entry_discovery)
  * [Discovery Session discovery ](#discovery_session_discovery)

<a name="items"></a>

## Items
| name | description | key | type | delay |
| ------------- |------------- |------------- |------------- |------------- |
| Contact | MIB: RFC1213-MIB<br>The textual identification of the contact person<br>for this managed node, together with information<br>on how to contact this person. | cisco.asav.contact | SNMP_AGENT | 1h |
| Location | MIB: RFC1213-MIB<br>The physical location of this node (e.g.,<br>`telephone closet, 3rd floor'). | cisco.asav.location | SNMP_AGENT | 1h |
| System description | MIB: RFC1213-MIB<br>A textual description of the entity.  This value<br>should include the full name and version<br>identification of the system's hardware type,<br>software operating-system, and networking<br>software.  It is mandatory that this only contain<br>printable ASCII characters. | cisco.asav.model | SNMP_AGENT | 1h |
| Host name | MIB: RFC1213-MIB<br>An administratively-assigned name for this<br>managed node.  By convention, this is the node's<br>fully-qualified domain name. | cisco.asav.name | SNMP_AGENT | 1h |
| Uptime | MIB: RFC1213-MIB<br>The time (in hundredths of a second) since the<br>network management portion of the system was last<br>re-initialized. | cisco.asav.uptime | SNMP_AGENT | 30s |
| SNMP agent availability | no description | zabbix[host,snmp,available] | INTERNAL | no delay |


<a name="macros"></a>

## Macros
| macro | value |
| ------------- |------------- |
| {$CISCO.LLD.FILTER.IF.ADMIN.MATCHES} | 1 |
| {$CISCO.LLD.FILTER.IF.ADMIN.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$CISCO.LLD.FILTER.IF.CONTROL.MATCHES} | .* |
| {$CISCO.LLD.FILTER.IF.DESC.MATCHES} | .* |
| {$CISCO.LLD.FILTER.IF.DESC.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$CISCO.LLD.FILTER.IF.NAME.MATCHES} | .* |
| {$CISCO.LLD.FILTER.IF.NAME.NOT_MATCHES} | CHANGE_IF_NEEDED |
| {$CPU.UTIL.CRIT} | 90 |
| {$MEMORY.UTIL.MAX} | 90 |
| {$SNMP.TIMEOUT} | 5m |


<a name="triggers"></a>

## Triggers
| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| Host has been restarted | INFO | Uptime is less than 10 minutes. | last(/Cisco ASAv by SNMP/cisco.asav.uptime)<10m | [{"tag": "scope", "value": "notice"}] | no url |
| No SNMP data collection | WARNING | SNMP is not available for polling. Please check device connectivity and SNMP settings. | max(/Cisco ASAv by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0 | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discoveries"></a>

## Discoveries
| name | key | description | type | lifetime | delay |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| CPU discovery | cisco.asav.cpu.discovery | Discovery of cpmCPUTotalTable, a table of CPU monitoring entries. | SNMP_AGENT | no lifetime | 1h |
| Memory discovery | cisco.asav.memory.discovery | Discovery of ciscoMemoryPoolTable, a table of memory pool monitoring entries. | SNMP_AGENT | no lifetime | 1h |
| Interface discovery | cisco.asav.net.if.discovery | Network interfaces discovery | SNMP_AGENT | no lifetime | 1h |
| Physical entry discovery | cisco.asav.physical.entry.discovery | Information about a particular physical entity. | SNMP_AGENT | no lifetime | 1h |
| Session discovery | cisco.asav.session.discovery | Remote access session discovery | SNMP_AGENT | no lifetime | 1h |


<a name="discovery_cpu_discovery" />

## Discovery CPU discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| CPU [{#SNMPINDEX}] Utilization | MIB: CISCO-PROCESS-MIB<br>The overall CPU busy percentage in the last 5 minute<br>period. This object deprecates the object cpmCPUTotal5min<br>and increases the value range to (0..100). | cisco.asav.cpu.util[{#SNMPINDEX}] | SNMP_AGENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| High CPU utilization | WARNING | The CPU utilization is too high. The system might be slow to respond. | min(/Cisco ASAv by SNMP/cisco.asav.cpu.util[{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT} | [{"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_memory_discovery" />

## Discovery Memory discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#SNMPVALUE} Free memory | MIB: CISCO-MEMORY-POOL-MIB<br>Indicates the number of bytes from the memory pool that are currently unused on the managed device. Note that the sum of ciscoMemoryPoolUsed and ciscoMemoryPoolFree is the total amount of memory in the pool<br>Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15216-contiguous-memory.html | cisco.asav.memory.free[{#SNMPINDEX}] | SNMP_AGENT |
| {#SNMPVALUE} Used memory | MIB: CISCO-MEMORY-POOL-MIB<br>Indicates the number of bytes from the memory pool that are currently in use by applications on the managed device.<br>Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15216-contiguous-memory.html | cisco.asav.memory.used[{#SNMPINDEX}] | SNMP_AGENT |
| {#SNMPVALUE} Memory utilization | Memory utilization in %. | cisco.asav.memory.util[{#SNMPINDEX}] | CALCULATED |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| High memory utilization | AVERAGE | The system is running out of free memory. | min(/Cisco ASAv by SNMP/cisco.asav.memory.util[{#SNMPINDEX}],5m)>{$MEMORY.UTIL.MAX} | [{"tag": "scope", "value": "capacity"}, {"tag": "scope", "value": "performance"}] | no url |


<a name="discovery_interface_discovery" />

## Discovery Interface discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#CISCO.IF.NAME} Administrative status | MIB: IF-MIB<br>The desired state of the interface.  The<br>testing(3) state indicates that no operational<br>packets can be passed. | cisco.asav.net.if.adminstatus[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Interface description | MIB: IF-MIB<br>A textual string containing information about the interface | cisco.asav.net.if.descr[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Link speed | MIB: IF-MIB<br>An estimate of the interface's current bandwidth in bits per second | cisco.asav.net.if.highspeed[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Incoming broadcast packets | MIB: IF-MIB<br>The number of packets, delivered by this sub-layer to a<br>higher (sub-)layer, which were addressed to a broadcast<br>address at this sub-layer. | cisco.asav.net.if.in.broadcastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Incoming multicast packets | MIB: IF-MIB<br>The number of packets, delivered by this sub-layer to a<br>higher (sub-)layer, which were addressed to a multicast<br>address at this sub-layer.  For a MAC layer protocol, this<br>includes both Group and Functional addresses. | cisco.asav.net.if.in.multicastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Incoming traffic | MIB: IF-MIB<br>The total number of octets received on the interface,<br>including framing characters. | cisco.asav.net.if.in.traffic[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Incoming unicast packets | MIB: IF-MIB<br>The number of packets, delivered by this sub-layer to a<br>higher (sub-)layer, which were not addressed to a multicast<br>or broadcast address at this sub-layer | cisco.asav.net.if.in.ucastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Incoming utilization | Interface utilization percentage | cisco.asav.net.if.in.util[{#SNMPINDEX}] | CALCULATED |
| {#CISCO.IF.NAME} Interface name | MIB: CISCO-PORT-MIB<br>Descriptive name that identifies this port. | cisco.asav.net.if.name[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Operational status | MIB: IF-MIB<br>The current operational state of the interface.<br>The testing(3) state indicates that no operational<br>packets can be passed. | cisco.asav.net.if.operstatus[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Outgoing broadcast packets | MIB: IF-MIB<br>The total number of packets that higher-level protocols<br>requested be transmitted, and which were addressed to a<br>broadcast address at this sub-layer, including those that<br>were discarded or not sent. | cisco.asav.net.if.out.broadcastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Outgoing multicast packets | MIB: IF-MIB<br>The total number of packets that higher-level protocols<br>requested be transmitted, and which were addressed to a<br>multicast address at this sub-layer, including those that<br>were discarded or not sent.  For a MAC layer protocol, this<br>includes both Group and Functional addresses. | cisco.asav.net.if.out.multicastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Outgoing traffic | MIB: IF-MIB<br>The total number of octets transmitted out of the<br>interface, including framing characters.  This object is a<br>64-bit version of ifOutOctets. | cisco.asav.net.if.out.traffic[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Outgoing unicast packets | MIB: IF-MIB<br>The total number of packets that higher-level protocols<br>requested be transmitted, and which were not addressed to a<br>multicast or broadcast address at this sub-layer, including<br>those that were discarded or not sent. | cisco.asav.net.if.out.ucastpkts[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.IF.NAME} Outgoing utilization | Interface utilization percentage | cisco.asav.net.if.out.util[{#SNMPINDEX}] | CALCULATED |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| {#CISCO.IF.NAME} Link down | AVERAGE | This trigger expression works as follows:<br>1. It can be triggered if the operations status is down.<br>2. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'eternal off' interfaces.)<br><br>WARNING: if closed manually - won't fire again on next poll, because of .diff. | last(/Cisco ASAv by SNMP/cisco.asav.net.if.operstatus[{#SNMPINDEX}])=2 and last(/Cisco ASAv by SNMP/cisco.asav.net.if.operstatus[{#SNMPINDEX}],#1)<>last(/Cisco ASAv by SNMP/cisco.asav.net.if.operstatus[{#SNMPINDEX}],#2) | [{"tag": "scope", "value": "availability"}] | no url |


<a name="discovery_physical_entry_discovery" />

## Discovery Physical entry discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#CISCO.ASAV.PHYS.NAME} Physical class | MIB: ENTITY-MIB<br>An indication of the general hardware type of the physical<br>entity.<br>An agent should set this object to the standard enumeration<br>value that most accurately indicates the general class of<br>the physical entity, or the primary class if there is more<br>than one entity.<br>If no appropriate standard registration identifier exists<br>for this physical entity, then the value 'other(1)' is<br>returned.  If the value is unknown by this agent, then the<br>value 'unknown(2)' is returned. | cisco.asav.phys.class[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Physical description | MIB: ENTITY-MIB<br>A textual description of physical entity.  This object<br>should contain a string that identifies the manufacturer's<br>name for the physical entity, and should be set to a<br>distinct value for each version or model of the physical<br>entity. | cisco.asav.phys.description[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Hardware revision | MIB: ENTITY-MIB<br>The vendor-specific hardware revision string for the<br>physical entity.  The preferred value is the hardware<br>revision identifier actually printed on the component itself<br>(if present).<br>Note that if revision information is stored internally in a<br>non-printable (e.g., binary) format, then the agent must<br>convert such information to a printable format, in an<br>implementation-specific manner.<br>If no specific hardware revision string is associated with<br>the physical component, or if this information is unknown to<br>the agent, then this object will contain a zero-length<br>string. | cisco.asav.phys.hw[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Manufacturer name | MIB: ENTITY-MIB<br>The name of the manufacturer of this physical component.<br>The preferred value is the manufacturer name string actually<br>printed on the component itself (if present).<br>Note that comparisons between instances of the<br>entPhysicalModelName, entPhysicalFirmwareRev,<br>entPhysicalSoftwareRev, and the entPhysicalSerialNum<br>objects, are only meaningful amongst entPhysicalEntries with<br>the same value of entPhysicalMfgName.<br>If the manufacturer name string associated with the physical<br>component is unknown to the agent, then this object will<br>contain a zero-length string. | cisco.asav.phys.mfgname[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Model name | MIB: ENTITY-MIB<br>The vendor-specific model name identifier string associated<br>with this physical component.  The preferred value is the<br>customer-visible part number, which may be printed on the<br>component itself.<br>If the model name string associated with the physical<br>component is unknown to the agent, then this object will<br>contain a zero-length string. | cisco.asav.phys.model[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Physical name | MIB: ENTITY-MIB<br>The textual name of the physical entity.  The value of this<br>object should be the name of the component as assigned by<br>the local device and should be suitable for use in commands<br>entered at the device's `console'.  This might be a text<br>name (e.g., `console') or a simple component number (e.g.,<br>port or module number, such as `1'), depending on the<br>physical component naming syntax of the device.<br>If there is no local name, or if this object is otherwise<br>not applicable, then this object contains a zero-length<br>string.<br>Note that the value of entPhysicalName for two physical<br>entities will be the same in the event that the console<br>interface does not distinguish between them, e.g., slot-1<br>and the card in slot-1. | cisco.asav.phys.name[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Serial number | MIB: ENTITY-MIB<br>The vendor-specific serial number string for the physical<br>entity.  The preferred value is the serial number string<br>actually printed on the component itself (if present).<br>On the first instantiation of an physical entity, the value<br>of entPhysicalSerialNum associated with that entity is set<br>to the correct vendor-assigned serial number, if this<br>information is available to the agent.  If a serial number<br>is unknown or non-existent, the entPhysicalSerialNum will be<br>set to a zero-length string instead. | cisco.asav.phys.sn[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.ASAV.PHYS.NAME} Software revision | MIB: ENTITY-MIB<br>The vendor-specific software revision string for the<br>physical entity.<br>Note that if revision information is stored internally in a<br>non-printable (e.g., binary) format, then the agent must<br>convert such information to a printable format, in an<br>implementation-specific manner.<br>If no specific software programs are associated with the<br>physical component, or if this information is unknown to the<br>agent, then this object will contain a zero-length string. | cisco.asav.phys.sw[{#SNMPINDEX}] | SNMP_AGENT |


### Triggers

| name | priority | description | expression | tags | url |
| ------------- |------------- |------------- |------------- |------------- |------------- |
| {#CISCO.ASAV.PHYS.NAME} has been replaced | INFO | {#CISCO.ASAV.PHYS.NAME} serial number has changed. Acknowledge to close the problem manually. | last(/Cisco ASAv by SNMP/cisco.asav.phys.sn[{#SNMPINDEX}],#1)<>last(/Cisco ASAv by SNMP/cisco.asav.phys.sn[{#SNMPINDEX}],#2) and length(last(/Cisco ASAv by SNMP/cisco.asav.phys.sn[{#SNMPINDEX}]))>0 | [{"tag": "scope", "value": "notice"}] | no url |


<a name="discovery_session_discovery" />

## Discovery Session discovery

### Items

| name | description | key | type |
| ------------- |------------- |------------- |------------- |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] ISP address | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The IP address of the peer (client) assigned by the ISP.<br>This is the address of the client device in the public<br>network. | cisco.asav.session.addr.isp[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Local address | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The IP address assigned to the client of this session<br>in the private network assigned by the managed entity. | cisco.asav.session.addr.local[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Algorithm validate packets | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The algorithm used by this remote access session to<br>to validate packets. | cisco.asav.session.authen.algorithm[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Authenticate method | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The method used to authenticate the user prior to<br>establishing the session. | cisco.asav.session.authen.method[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Authorize method | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The method used to authorize the user prior to<br>establishing the session. | cisco.asav.session.author.method[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Session duration | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The number of seconds elapsed since this session<br>was established. | cisco.asav.session.duration[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Encryption algorithm | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The algorithm used by this remote access session to<br>encrypt its payload. | cisco.asav.session.encryption[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Incoming traffic | MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The rate of octets received by this Remote<br>Access Session.<br>This value is accumulated BEFORE determining whether<br>or not the packet should be decompressed. | cisco.asav.session.in.traffic[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Outgoing traffic | MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The rate of octets transmitted by this Remote<br>Access Session.<br>This value is accumulated AFTER determining whether<br>or not the packet should be compressed. | cisco.asav.session.out.traffic[{#SNMPINDEX}] | SNMP_AGENT |
| {#CISCO.CRAS.USER} [{#CISCO.CRAS.INDEX}] Session protocol | MIB:  CISCO-REMOTE-ACCESS-MONITOR-MIB<br>The protocol underlying this remote access session. | cisco.asav.session.protocol[{#SNMPINDEX}] | SNMP_AGENT |

